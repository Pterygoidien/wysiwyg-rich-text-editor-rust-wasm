(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const p of a.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&l(p)}).observe(document,{childList:!0,subtree:!0});function i(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function l(o){if(o.ep)return;o.ep=!0;const a=i(o);fetch(o.href,a)}})();const Cr=!1;var Fr=Array.isArray,Js=Array.prototype.indexOf,rr=Array.from,Fl=Object.defineProperty,wi=Object.getOwnPropertyDescriptor,Qs=Object.getOwnPropertyDescriptors,eo=Object.prototype,to=Array.prototype,Dl=Object.getPrototypeOf,yl=Object.isExtensible;const Ut=()=>{};function $l(t){for(var n=0;n<t.length;n++)t[n]()}function Bl(){var t,n,i=new Promise((l,o)=>{t=l,n=o});return{promise:i,resolve:t,reject:n}}const De=2,Dr=4,$r=8,no=1<<24,jt=16,Yt=32,Ln=64,lr=128,kt=512,Ve=1024,nt=2048,Ht=4096,ot=8192,cn=16384,Br=32768,Kn=65536,ml=1<<17,Nl=1<<18,ei=1<<19,io=1<<20,Vt=1<<25,zn=32768,Ir=1<<21,Nr=1<<22,un=1<<23,Gn=Symbol("$state"),ro=Symbol(""),Yn=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function lo(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function so(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function oo(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function ao(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function co(t){throw new Error("https://svelte.dev/e/effect_orphan")}function uo(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function fo(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function ho(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function vo(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function po(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const go=1,_o=2,Wl=4,bo=8,yo=16,mo=2,We=Symbol(),wo="http://www.w3.org/1999/xhtml";function xo(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function ko(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function Vl(t){return t===this.v}function Ul(t,n){return t!=t?n==n:t!==n||t!==null&&typeof t=="object"||typeof t=="function"}function Xl(t){return!Ul(t,this.v)}let Mi=!1,So=!1;function Co(){Mi=!0}let ze=null;function Zn(t){ze=t}function sr(t,n=!1,i){ze={p:ze,i:!1,c:null,e:null,s:t,x:null,l:Mi&&!n?{s:null,u:null,$:[]}:null}}function or(t){var n=ze,i=n.e;if(i!==null){n.e=null;for(var l of i)as(l)}return t!==void 0&&(n.x=t),n.i=!0,ze=n.p,t??{}}function zi(){return!Mi||ze!==null&&ze.l===null}let kn=[];function jl(){var t=kn;kn=[],$l(t)}function ti(t){if(kn.length===0&&!xi){var n=kn;queueMicrotask(()=>{n===kn&&jl()})}kn.push(t)}function Io(){for(;kn.length>0;)jl()}function Yl(t){var n=ae;if(n===null)return re.f|=un,t;if((n.f&Br)===0){if((n.f&lr)===0)throw t;n.b.error(t)}else Jn(t,n)}function Jn(t,n){for(;n!==null;){if((n.f&lr)!==0)try{n.b.error(t);return}catch(i){t=i}n=n.parent}throw t}const Gi=new Set;let oe=null,Zi=null,dt=null,ut=[],ar=null,Mr=!1,xi=!1;class Et{committed=!1;current=new Map;previous=new Map;#e=new Set;#t=new Set;#i=0;#n=0;#a=null;#l=new Set;#r=new Set;skipped_effects=new Set;is_fork=!1;is_deferred(){return this.is_fork||this.#n>0}process(n){ut=[],Zi=null,this.apply();var i={parent:null,effect:null,effects:[],render_effects:[]};for(const l of n)this.#s(l,i);this.is_fork||this.#u(),this.is_deferred()?(this.#o(i.effects),this.#o(i.render_effects)):(Zi=this,oe=null,wl(i.render_effects),wl(i.effects),Zi=null,this.#a?.resolve()),dt=null}#s(n,i){n.f^=Ve;for(var l=n.first;l!==null;){var o=l.f,a=(o&(Yt|Ln))!==0,p=a&&(o&Ve)!==0,h=p||(o&ot)!==0||this.skipped_effects.has(l);if((l.f&lr)!==0&&l.b?.is_pending()&&(i={parent:i,effect:l,effects:[],render_effects:[]}),!h&&l.fn!==null){a?l.f^=Ve:(o&Dr)!==0?i.effects.push(l):Ti(l)&&((l.f&jt)!==0&&this.#l.add(l),Ii(l));var u=l.first;if(u!==null){l=u;continue}}var b=l.parent;for(l=l.next;l===null&&b!==null;)b===i.effect&&(this.#o(i.effects),this.#o(i.render_effects),i=i.parent),l=b.next,b=b.parent}}#o(n){for(const i of n)(i.f&nt)!==0?this.#l.add(i):(i.f&Ht)!==0&&this.#r.add(i),this.#c(i.deps),Ue(i,Ve)}#c(n){if(n!==null)for(const i of n)(i.f&De)===0||(i.f&zn)===0||(i.f^=zn,this.#c(i.deps))}capture(n,i){this.previous.has(n)||this.previous.set(n,i),(n.f&un)===0&&(this.current.set(n,n.v),dt?.set(n,n.v))}activate(){oe=this,this.apply()}deactivate(){oe===this&&(oe=null,dt=null)}flush(){if(this.activate(),ut.length>0){if(Gl(),oe!==null&&oe!==this)return}else this.#i===0&&this.process([]);this.deactivate()}discard(){for(const n of this.#t)n(this);this.#t.clear()}#u(){if(this.#n===0){for(const n of this.#e)n();this.#e.clear()}this.#i===0&&this.#f()}#f(){if(Gi.size>1){this.previous.clear();var n=dt,i=!0,l={parent:null,effect:null,effects:[],render_effects:[]};for(const a of Gi){if(a===this){i=!1;continue}const p=[];for(const[u,b]of this.current){if(a.current.has(u))if(i&&b!==a.current.get(u))a.current.set(u,b);else continue;p.push(u)}if(p.length===0)continue;const h=[...a.current.keys()].filter(u=>!this.current.has(u));if(h.length>0){var o=ut;ut=[];const u=new Set,b=new Map;for(const C of p)Kl(C,h,u,b);if(ut.length>0){oe=a,a.apply();for(const C of ut)a.#s(C,l);a.deactivate()}ut=o}}oe=null,dt=n}this.committed=!0,Gi.delete(this)}increment(n){this.#i+=1,n&&(this.#n+=1)}decrement(n){this.#i-=1,n&&(this.#n-=1),this.revive()}revive(){for(const n of this.#l)this.#r.delete(n),Ue(n,nt),Tn(n);for(const n of this.#r)Ue(n,Ht),Tn(n);this.flush()}oncommit(n){this.#e.add(n)}ondiscard(n){this.#t.add(n)}settled(){return(this.#a??=Bl()).promise}static ensure(){if(oe===null){const n=oe=new Et;Gi.add(oe),xi||Et.enqueue(()=>{oe===n&&n.flush()})}return oe}static enqueue(n){ti(n)}apply(){}}function Mo(t){var n=xi;xi=!0;try{for(var i;;){if(Io(),ut.length===0&&(oe?.flush(),ut.length===0))return ar=null,i;Gl()}}finally{xi=n}}function Gl(){var t=In;Mr=!0;var n=null;try{var i=0;for(nr(!0);ut.length>0;){var l=Et.ensure();if(i++>1e3){var o,a;zo()}l.process(ut),fn.clear()}}finally{Mr=!1,nr(t),ar=null}}function zo(){try{uo()}catch(t){Jn(t,ar)}}let Nt=null;function wl(t){var n=t.length;if(n!==0){for(var i=0;i<n;){var l=t[i++];if((l.f&(cn|ot))===0&&Ti(l)&&(Nt=new Set,Ii(l),l.deps===null&&l.first===null&&l.nodes===null&&(l.teardown===null&&l.ac===null?fs(l):l.fn=null),Nt?.size>0)){fn.clear();for(const o of Nt){if((o.f&(cn|ot))!==0)continue;const a=[o];let p=o.parent;for(;p!==null;)Nt.has(p)&&(Nt.delete(p),a.push(p)),p=p.parent;for(let h=a.length-1;h>=0;h--){const u=a[h];(u.f&(cn|ot))===0&&Ii(u)}}Nt.clear()}}Nt=null}}function Kl(t,n,i,l){if(!i.has(t)&&(i.add(t),t.reactions!==null))for(const o of t.reactions){const a=o.f;(a&De)!==0?Kl(o,n,i,l):(a&(Nr|jt))!==0&&(a&nt)===0&&Zl(o,n,l)&&(Ue(o,nt),Tn(o))}}function Zl(t,n,i){const l=i.get(t);if(l!==void 0)return l;if(t.deps!==null)for(const o of t.deps){if(n.includes(o))return!0;if((o.f&De)!==0&&Zl(o,n,i))return i.set(o,!0),!0}return i.set(t,!1),!1}function Tn(t){for(var n=ar=t;n.parent!==null;){n=n.parent;var i=n.f;if(Mr&&n===ae&&(i&jt)!==0&&(i&Nl)===0)return;if((i&(Ln|Yt))!==0){if((i&Ve)===0)return;n.f^=Ve}}ut.push(n)}function To(t){let n=0,i=En(0),l;return()=>{Si()&&(e(i),Xr(()=>(n===0&&(l=Ei(()=>t(()=>ki(i)))),n+=1,()=>{ti(()=>{n-=1,n===0&&(l?.(),l=void 0,ki(i))})})))}}var Eo=Kn|ei|lr;function Lo(t,n,i){new Po(t,n,i)}class Po{parent;#e=!1;#t;#i=null;#n;#a;#l;#r=null;#s=null;#o=null;#c=null;#u=null;#f=0;#d=0;#v=!1;#h=null;#y=To(()=>(this.#h=En(this.#f),()=>{this.#h=null}));constructor(n,i,l){this.#t=n,this.#n=i,this.#a=l,this.parent=ae.b,this.#e=!!this.#n.pending,this.#l=jr(()=>{ae.b=this;{var o=this.#_();try{this.#r=ft(()=>l(o))}catch(a){this.error(a)}this.#d>0?this.#g():this.#e=!1}return()=>{this.#u?.remove()}},Eo)}#m(){try{this.#r=ft(()=>this.#a(this.#t))}catch(n){this.error(n)}this.#e=!1}#w(){const n=this.#n.pending;n&&(this.#s=ft(()=>n(this.#t)),Et.enqueue(()=>{var i=this.#_();this.#r=this.#p(()=>(Et.ensure(),ft(()=>this.#a(i)))),this.#d>0?this.#g():(Cn(this.#s,()=>{this.#s=null}),this.#e=!1)}))}#_(){var n=this.#t;return this.#e&&(this.#u=Sn(),this.#t.before(this.#u),n=this.#u),n}is_pending(){return this.#e||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#n.pending}#p(n){var i=ae,l=re,o=ze;At(this.#l),et(this.#l),Zn(this.#l.ctx);try{return n()}catch(a){return Yl(a),null}finally{At(i),et(l),Zn(o)}}#g(){const n=this.#n.pending;this.#r!==null&&(this.#c=document.createDocumentFragment(),this.#c.append(this.#u),vs(this.#r,this.#c)),this.#s===null&&(this.#s=ft(()=>n(this.#t)))}#b(n){if(!this.has_pending_snippet()){this.parent&&this.parent.#b(n);return}this.#d+=n,this.#d===0&&(this.#e=!1,this.#s&&Cn(this.#s,()=>{this.#s=null}),this.#c&&(this.#t.before(this.#c),this.#c=null))}update_pending_count(n){this.#b(n),this.#f+=n,this.#h&&Qn(this.#h,this.#f)}get_effect_pending(){return this.#y(),e(this.#h)}error(n){var i=this.#n.onerror;let l=this.#n.failed;if(this.#v||!i&&!l)throw n;this.#r&&(tt(this.#r),this.#r=null),this.#s&&(tt(this.#s),this.#s=null),this.#o&&(tt(this.#o),this.#o=null);var o=!1,a=!1;const p=()=>{if(o){ko();return}o=!0,a&&po(),Et.ensure(),this.#f=0,this.#o!==null&&Cn(this.#o,()=>{this.#o=null}),this.#e=this.has_pending_snippet(),this.#r=this.#p(()=>(this.#v=!1,ft(()=>this.#a(this.#t)))),this.#d>0?this.#g():this.#e=!1};var h=re;try{et(null),a=!0,i?.(n,p),a=!1}catch(u){Jn(u,this.#l&&this.#l.parent)}finally{et(h)}l&&ti(()=>{this.#o=this.#p(()=>{Et.ensure(),this.#v=!0;try{return ft(()=>{l(this.#t,()=>n,()=>p)})}catch(u){return Jn(u,this.#l.parent),null}finally{this.#v=!1}})})}}function Ho(t,n,i,l){const o=zi()?Wr:Jl;if(i.length===0&&t.length===0){l(n.map(o));return}var a=oe,p=ae,h=Ao();function u(){Promise.all(i.map(b=>Oo(b))).then(b=>{h();try{l([...n.map(o),...b])}catch(C){(p.f&cn)===0&&Jn(C,p)}a?.deactivate(),tr()}).catch(b=>{Jn(b,p)})}t.length>0?Promise.all(t).then(()=>{h();try{return u()}finally{a?.deactivate(),tr()}}):u()}function Ao(){var t=ae,n=re,i=ze,l=oe;return function(a=!0){At(t),et(n),Zn(i),a&&l?.activate()}}function tr(){At(null),et(null),Zn(null)}function Wr(t){var n=De|nt,i=re!==null&&(re.f&De)!==0?re:null;return ae!==null&&(ae.f|=ei),{ctx:ze,deps:null,effects:null,equals:Vl,f:n,fn:t,reactions:null,rv:0,v:We,wv:0,parent:i??ae,ac:null}}function Oo(t,n){let i=ae;i===null&&so();var l=i.b,o=void 0,a=En(We),p=!re,h=new Map;return jo(()=>{var u=Bl();o=u.promise;try{Promise.resolve(t()).then(u.resolve,u.reject).then(()=>{b===oe&&b.committed&&b.deactivate(),tr()})}catch(H){u.reject(H),tr()}var b=oe;if(p){var C=!l.is_pending();l.update_pending_count(1),b.increment(C),h.get(b)?.reject(Yn),h.delete(b),h.set(b,u)}const D=(H,I=void 0)=>{if(b.activate(),I)I!==Yn&&(a.f|=un,Qn(a,I));else{(a.f&un)!==0&&(a.f^=un),Qn(a,H);for(const[$,V]of h){if(h.delete($),$===b)break;V.reject(Yn)}}p&&(l.update_pending_count(-1),b.decrement(C))};u.promise.then(D,H=>D(null,H||"unknown"))}),fr(()=>{for(const u of h.values())u.reject(Yn)}),new Promise(u=>{function b(C){function D(){C===o?u(a):b(o)}C.then(D,D)}b(o)})}function ye(t){const n=Wr(t);return ps(n),n}function Jl(t){const n=Wr(t);return n.equals=Xl,n}function Ql(t){var n=t.effects;if(n!==null){t.effects=null;for(var i=0;i<n.length;i+=1)tt(n[i])}}function qo(t){for(var n=t.parent;n!==null;){if((n.f&De)===0)return(n.f&cn)===0?n:null;n=n.parent}return null}function Vr(t){var n,i=ae;At(qo(t));try{t.f&=~zn,Ql(t),n=ys(t)}finally{At(i)}return n}function es(t){var n=Vr(t);if(t.equals(n)||(oe?.is_fork||(t.v=n),t.wv=_s()),!ni)if(dt!==null)(Si()||oe?.is_fork)&&dt.set(t,n);else{var i=(t.f&kt)===0?Ht:Ve;Ue(t,i)}}let zr=new Set;const fn=new Map;let ts=!1;function En(t,n){var i={f:0,v:t,reactions:null,equals:Vl,rv:0,wv:0};return i}function W(t,n){const i=En(t);return ps(i),i}function Ur(t,n=!1,i=!0){const l=En(t);return n||(l.equals=Xl),Mi&&i&&ze!==null&&ze.l!==null&&(ze.l.s??=[]).push(l),l}function f(t,n,i=!1){re!==null&&(!Lt||(re.f&ml)!==0)&&zi()&&(re.f&(De|jt|Nr|ml))!==0&&!Xt?.includes(t)&&vo();let l=i?st(n):n;return Qn(t,l)}function Qn(t,n){if(!t.equals(n)){var i=t.v;ni?fn.set(t,n):fn.set(t,i),t.v=n;var l=Et.ensure();l.capture(t,i),(t.f&De)!==0&&((t.f&nt)!==0&&Vr(t),Ue(t,(t.f&kt)!==0?Ve:Ht)),t.wv=_s(),ns(t,nt),zi()&&ae!==null&&(ae.f&Ve)!==0&&(ae.f&(Yt|Ln))===0&&(ct===null?Ko([t]):ct.push(t)),!l.is_fork&&zr.size>0&&!ts&&Ro()}return n}function Ro(){ts=!1;var t=In;nr(!0);const n=Array.from(zr);try{for(const i of n)(i.f&Ve)!==0&&Ue(i,Ht),Ti(i)&&Ii(i)}finally{nr(t)}zr.clear()}function sn(t,n=1){var i=e(t),l=n===1?i++:i--;return f(t,i),l}function ki(t){f(t,t.v+1)}function ns(t,n){var i=t.reactions;if(i!==null)for(var l=zi(),o=i.length,a=0;a<o;a++){var p=i[a],h=p.f;if(!(!l&&p===ae)){var u=(h&nt)===0;if(u&&Ue(p,n),(h&De)!==0){var b=p;dt?.delete(b),(h&zn)===0&&(h&kt&&(p.f|=zn),ns(b,Ht))}else u&&((h&jt)!==0&&Nt!==null&&Nt.add(p),Tn(p))}}}function st(t){if(typeof t!="object"||t===null||Gn in t)return t;const n=Dl(t);if(n!==eo&&n!==to)return t;var i=new Map,l=Fr(t),o=W(0),a=Mn,p=h=>{if(Mn===a)return h();var u=re,b=Mn;et(null),Il(a);var C=h();return et(u),Il(b),C};return l&&i.set("length",W(t.length)),new Proxy(t,{defineProperty(h,u,b){(!("value"in b)||b.configurable===!1||b.enumerable===!1||b.writable===!1)&&fo();var C=i.get(u);return C===void 0?C=p(()=>{var D=W(b.value);return i.set(u,D),D}):f(C,b.value,!0),!0},deleteProperty(h,u){var b=i.get(u);if(b===void 0){if(u in h){const C=p(()=>W(We));i.set(u,C),ki(o)}}else f(b,We),ki(o);return!0},get(h,u,b){if(u===Gn)return t;var C=i.get(u),D=u in h;if(C===void 0&&(!D||wi(h,u)?.writable)&&(C=p(()=>{var I=st(D?h[u]:We),$=W(I);return $}),i.set(u,C)),C!==void 0){var H=e(C);return H===We?void 0:H}return Reflect.get(h,u,b)},getOwnPropertyDescriptor(h,u){var b=Reflect.getOwnPropertyDescriptor(h,u);if(b&&"value"in b){var C=i.get(u);C&&(b.value=e(C))}else if(b===void 0){var D=i.get(u),H=D?.v;if(D!==void 0&&H!==We)return{enumerable:!0,configurable:!0,value:H,writable:!0}}return b},has(h,u){if(u===Gn)return!0;var b=i.get(u),C=b!==void 0&&b.v!==We||Reflect.has(h,u);if(b!==void 0||ae!==null&&(!C||wi(h,u)?.writable)){b===void 0&&(b=p(()=>{var H=C?st(h[u]):We,I=W(H);return I}),i.set(u,b));var D=e(b);if(D===We)return!1}return C},set(h,u,b,C){var D=i.get(u),H=u in h;if(l&&u==="length")for(var I=b;I<D.v;I+=1){var $=i.get(I+"");$!==void 0?f($,We):I in h&&($=p(()=>W(We)),i.set(I+"",$))}if(D===void 0)(!H||wi(h,u)?.writable)&&(D=p(()=>W(void 0)),f(D,st(b)),i.set(u,D));else{H=D.v!==We;var V=p(()=>st(b));f(D,V)}var d=Reflect.getOwnPropertyDescriptor(h,u);if(d?.set&&d.set.call(C,b),!H){if(l&&typeof u=="string"){var m=i.get("length"),A=Number(u);Number.isInteger(A)&&A>=m.v&&f(m,A+1)}ki(o)}return!0},ownKeys(h){e(o);var u=Reflect.ownKeys(h).filter(D=>{var H=i.get(D);return H===void 0||H.v!==We});for(var[b,C]of i)C.v!==We&&!(b in h)&&u.push(b);return u},setPrototypeOf(){ho()}})}function xl(t){try{if(t!==null&&typeof t=="object"&&Gn in t)return t[Gn]}catch{}return t}function Fo(t,n){return Object.is(xl(t),xl(n))}var kl,is,rs,ls;function Do(){if(kl===void 0){kl=window,is=/Firefox/.test(navigator.userAgent);var t=Element.prototype,n=Node.prototype,i=Text.prototype;rs=wi(n,"firstChild").get,ls=wi(n,"nextSibling").get,yl(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),yl(i)&&(i.__t=void 0)}}function Sn(t=""){return document.createTextNode(t)}function ss(t){return rs.call(t)}function cr(t){return ls.call(t)}function F(t,n){return ss(t)}function k(t,n=1,i=!1){let l=t;for(;n--;)l=cr(l);return l}function $o(t){t.textContent=""}function os(){return!1}let Sl=!1;function Bo(){Sl||(Sl=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{if(!t.defaultPrevented)for(const n of t.target.elements)n.__on_r?.()})},{capture:!0}))}function ur(t){var n=re,i=ae;et(null),At(null);try{return t()}finally{et(n),At(i)}}function No(t,n,i,l=i){t.addEventListener(n,()=>ur(i));const o=t.__on_r;o?t.__on_r=()=>{o(),l(!0)}:t.__on_r=()=>l(!0),Bo()}function Wo(t){ae===null&&(re===null&&co(),ao()),ni&&oo()}function Vo(t,n){var i=n.last;i===null?n.last=n.first=t:(i.next=t,t.prev=i,n.last=t)}function Gt(t,n,i){var l=ae;l!==null&&(l.f&ot)!==0&&(t|=ot);var o={ctx:ze,deps:null,nodes:null,f:t|nt|kt,first:null,fn:n,last:null,next:null,parent:l,b:l&&l.b,prev:null,teardown:null,wv:0,ac:null};if(i)try{Ii(o),o.f|=Br}catch(h){throw tt(o),h}else n!==null&&Tn(o);var a=o;if(i&&a.deps===null&&a.teardown===null&&a.nodes===null&&a.first===a.last&&(a.f&ei)===0&&(a=a.first,(t&jt)!==0&&(t&Kn)!==0&&a!==null&&(a.f|=Kn)),a!==null&&(a.parent=l,l!==null&&Vo(a,l),re!==null&&(re.f&De)!==0&&(t&Ln)===0)){var p=re;(p.effects??=[]).push(a)}return o}function Si(){return re!==null&&!Lt}function fr(t){const n=Gt($r,null,!1);return Ue(n,Ve),n.teardown=t,n}function Ji(t){Wo();var n=ae.f,i=!re&&(n&Yt)!==0&&(n&Br)===0;if(i){var l=ze;(l.e??=[]).push(t)}else return as(t)}function as(t){return Gt(Dr|io,t,!1)}function Uo(t){Et.ensure();const n=Gt(Ln|ei,t,!0);return(i={})=>new Promise(l=>{i.outro?Cn(n,()=>{tt(n),l(void 0)}):(tt(n),l(void 0))})}function Xo(t){return Gt(Dr,t,!1)}function jo(t){return Gt(Nr|ei,t,!0)}function Xr(t,n=0){return Gt($r|n,t,!0)}function Ye(t,n=[],i=[],l=[]){Ho(l,n,i,o=>{Gt($r,()=>t(...o.map(e)),!0)})}function jr(t,n=0){var i=Gt(jt|n,t,!0);return i}function ft(t){return Gt(Yt|ei,t,!0)}function cs(t){var n=t.teardown;if(n!==null){const i=ni,l=re;Cl(!0),et(null);try{n.call(null)}finally{Cl(i),et(l)}}}function us(t,n=!1){var i=t.first;for(t.first=t.last=null;i!==null;){const o=i.ac;o!==null&&ur(()=>{o.abort(Yn)});var l=i.next;(i.f&Ln)!==0?i.parent=null:tt(i,n),i=l}}function Yo(t){for(var n=t.first;n!==null;){var i=n.next;(n.f&Yt)===0&&tt(n),n=i}}function tt(t,n=!0){var i=!1;(n||(t.f&Nl)!==0)&&t.nodes!==null&&t.nodes.end!==null&&(Go(t.nodes.start,t.nodes.end),i=!0),us(t,n&&!i),ir(t,0),Ue(t,cn);var l=t.nodes&&t.nodes.t;if(l!==null)for(const a of l)a.stop();cs(t);var o=t.parent;o!==null&&o.first!==null&&fs(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes=t.ac=null}function Go(t,n){for(;t!==null;){var i=t===n?null:cr(t);t.remove(),t=i}}function fs(t){var n=t.parent,i=t.prev,l=t.next;i!==null&&(i.next=l),l!==null&&(l.prev=i),n!==null&&(n.first===t&&(n.first=l),n.last===t&&(n.last=i))}function Cn(t,n,i=!0){var l=[];ds(t,l,!0);var o=()=>{i&&tt(t),n&&n()},a=l.length;if(a>0){var p=()=>--a||o();for(var h of l)h.out(p)}else o()}function ds(t,n,i){if((t.f&ot)===0){t.f^=ot;var l=t.nodes&&t.nodes.t;if(l!==null)for(const h of l)(h.is_global||i)&&n.push(h);for(var o=t.first;o!==null;){var a=o.next,p=(o.f&Kn)!==0||(o.f&Yt)!==0&&(t.f&jt)!==0;ds(o,n,p?i:!1),o=a}}}function Yr(t){hs(t,!0)}function hs(t,n){if((t.f&ot)!==0){t.f^=ot,(t.f&Ve)===0&&(Ue(t,nt),Tn(t));for(var i=t.first;i!==null;){var l=i.next,o=(i.f&Kn)!==0||(i.f&Yt)!==0;hs(i,o?n:!1),i=l}var a=t.nodes&&t.nodes.t;if(a!==null)for(const p of a)(p.is_global||n)&&p.in()}}function vs(t,n){if(t.nodes)for(var i=t.nodes.start,l=t.nodes.end;i!==null;){var o=i===l?null:cr(i);n.append(i),i=o}}let In=!1;function nr(t){In=t}let ni=!1;function Cl(t){ni=t}let re=null,Lt=!1;function et(t){re=t}let ae=null;function At(t){ae=t}let Xt=null;function ps(t){re!==null&&(Xt===null?Xt=[t]:Xt.push(t))}let Ge=null,lt=0,ct=null;function Ko(t){ct=t}let gs=1,Ci=0,Mn=Ci;function Il(t){Mn=t}function _s(){return++gs}function Ti(t){var n=t.f;if((n&nt)!==0)return!0;if(n&De&&(t.f&=~zn),(n&Ht)!==0){var i=t.deps;if(i!==null)for(var l=i.length,o=0;o<l;o++){var a=i[o];if(Ti(a)&&es(a),a.wv>t.wv)return!0}(n&kt)!==0&&dt===null&&Ue(t,Ve)}return!1}function bs(t,n,i=!0){var l=t.reactions;if(l!==null&&!Xt?.includes(t))for(var o=0;o<l.length;o++){var a=l[o];(a.f&De)!==0?bs(a,n,!1):n===a&&(i?Ue(a,nt):(a.f&Ve)!==0&&Ue(a,Ht),Tn(a))}}function ys(t){var n=Ge,i=lt,l=ct,o=re,a=Xt,p=ze,h=Lt,u=Mn,b=t.f;Ge=null,lt=0,ct=null,re=(b&(Yt|Ln))===0?t:null,Xt=null,Zn(t.ctx),Lt=!1,Mn=++Ci,t.ac!==null&&(ur(()=>{t.ac.abort(Yn)}),t.ac=null);try{t.f|=Ir;var C=t.fn,D=C(),H=t.deps;if(Ge!==null){var I;if(ir(t,lt),H!==null&&lt>0)for(H.length=lt+Ge.length,I=0;I<Ge.length;I++)H[lt+I]=Ge[I];else t.deps=H=Ge;if(Si()&&(t.f&kt)!==0)for(I=lt;I<H.length;I++)(H[I].reactions??=[]).push(t)}else H!==null&&lt<H.length&&(ir(t,lt),H.length=lt);if(zi()&&ct!==null&&!Lt&&H!==null&&(t.f&(De|Ht|nt))===0)for(I=0;I<ct.length;I++)bs(ct[I],t);return o!==null&&o!==t&&(Ci++,ct!==null&&(l===null?l=ct:l.push(...ct))),(t.f&un)!==0&&(t.f^=un),D}catch($){return Yl($)}finally{t.f^=Ir,Ge=n,lt=i,ct=l,re=o,Xt=a,Zn(p),Lt=h,Mn=u}}function Zo(t,n){let i=n.reactions;if(i!==null){var l=Js.call(i,t);if(l!==-1){var o=i.length-1;o===0?i=n.reactions=null:(i[l]=i[o],i.pop())}}i===null&&(n.f&De)!==0&&(Ge===null||!Ge.includes(n))&&(Ue(n,Ht),(n.f&kt)!==0&&(n.f^=kt,n.f&=~zn),Ql(n),ir(n,0))}function ir(t,n){var i=t.deps;if(i!==null)for(var l=n;l<i.length;l++)Zo(t,i[l])}function Ii(t){var n=t.f;if((n&cn)===0){Ue(t,Ve);var i=ae,l=In;ae=t,In=!0;try{(n&(jt|no))!==0?Yo(t):us(t),cs(t);var o=ys(t);t.teardown=typeof o=="function"?o:null,t.wv=gs;var a;Cr&&So&&(t.f&nt)!==0&&t.deps}finally{In=l,ae=i}}}async function Jo(){await Promise.resolve(),Mo()}function e(t){var n=t.f,i=(n&De)!==0;if(re!==null&&!Lt){var l=ae!==null&&(ae.f&cn)!==0;if(!l&&!Xt?.includes(t)){var o=re.deps;if((re.f&Ir)!==0)t.rv<Ci&&(t.rv=Ci,Ge===null&&o!==null&&o[lt]===t?lt++:Ge===null?Ge=[t]:Ge.includes(t)||Ge.push(t));else{(re.deps??=[]).push(t);var a=t.reactions;a===null?t.reactions=[re]:a.includes(re)||a.push(re)}}}if(ni){if(fn.has(t))return fn.get(t);if(i){var p=t,h=p.v;return((p.f&Ve)===0&&p.reactions!==null||ws(p))&&(h=Vr(p)),fn.set(p,h),h}}else i&&(!dt?.has(t)||oe?.is_fork&&!Si())&&(p=t,Ti(p)&&es(p),In&&Si()&&(p.f&kt)===0&&ms(p));if(dt?.has(t))return dt.get(t);if((t.f&un)!==0)throw t.v;return t.v}function ms(t){if(t.deps!==null){t.f^=kt;for(const n of t.deps)(n.reactions??=[]).push(t),(n.f&De)!==0&&(n.f&kt)===0&&ms(n)}}function ws(t){if(t.v===We)return!0;if(t.deps===null)return!1;for(const n of t.deps)if(fn.has(n)||(n.f&De)!==0&&ws(n))return!0;return!1}function Ei(t){var n=Lt;try{return Lt=!0,t()}finally{Lt=n}}const Qo=-7169;function Ue(t,n){t.f=t.f&Qo|n}const ea=["touchstart","touchmove"];function ta(t){return ea.includes(t)}const xs=new Set,Tr=new Set;function na(t,n,i,l={}){function o(a){if(l.capture||bi.call(n,a),!a.cancelBubble)return ur(()=>i?.call(this,a))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?ti(()=>{n.addEventListener(t,o,l)}):n.addEventListener(t,o,l),o}function Ki(t,n,i,l,o){var a={capture:l,passive:o},p=na(t,n,i,a);(n===document.body||n===window||n===document||n instanceof HTMLMediaElement)&&fr(()=>{n.removeEventListener(t,p,a)})}function Gr(t){for(var n=0;n<t.length;n++)xs.add(t[n]);for(var i of Tr)i(t)}let Ml=null;function bi(t){var n=this,i=n.ownerDocument,l=t.type,o=t.composedPath?.()||[],a=o[0]||t.target;Ml=t;var p=0,h=Ml===t&&t.__root;if(h){var u=o.indexOf(h);if(u!==-1&&(n===document||n===window)){t.__root=n;return}var b=o.indexOf(n);if(b===-1)return;u<=b&&(p=u)}if(a=o[p]||t.target,a!==n){Fl(t,"currentTarget",{configurable:!0,get(){return a||i}});var C=re,D=ae;et(null),At(null);try{for(var H,I=[];a!==null;){var $=a.assignedSlot||a.parentNode||a.host||null;try{var V=a["__"+l];V!=null&&(!a.disabled||t.target===a)&&V.call(a,t)}catch(d){H?I.push(d):H=d}if(t.cancelBubble||$===n||$===null)break;a=$}if(H){for(let d of I)queueMicrotask(()=>{throw d});throw H}}finally{t.__root=n,delete t.currentTarget,et(C),At(D)}}}function ia(t){var n=document.createElement("template");return n.innerHTML=t.replaceAll("<!>","<!---->"),n.content}function ra(t,n){var i=ae;i.nodes===null&&(i.nodes={start:t,end:n,a:null,t:null})}function Ce(t,n){var i=(n&mo)!==0,l,o=!t.startsWith("<!>");return()=>{l===void 0&&(l=ia(o?t:"<!>"+t),l=ss(l));var a=i||is?document.importNode(l,!0):l.cloneNode(!0);return ra(a,a),a}}function Se(t,n){t!==null&&t.before(n)}function Wt(t,n){var i=n==null?"":typeof n=="object"?n+"":n;i!==(t.__t??=t.nodeValue)&&(t.__t=i,t.nodeValue=i+"")}function la(t,n){return sa(t,n)}const Wn=new Map;function sa(t,{target:n,anchor:i,props:l={},events:o,context:a,intro:p=!0}){Do();var h=new Set,u=D=>{for(var H=0;H<D.length;H++){var I=D[H];if(!h.has(I)){h.add(I);var $=ta(I);n.addEventListener(I,bi,{passive:$});var V=Wn.get(I);V===void 0?(document.addEventListener(I,bi,{passive:$}),Wn.set(I,1)):Wn.set(I,V+1)}}};u(rr(xs)),Tr.add(u);var b=void 0,C=Uo(()=>{var D=i??n.appendChild(Sn());return Lo(D,{pending:()=>{}},H=>{if(a){sr({});var I=ze;I.c=a}o&&(l.$$events=o),b=t(H,l)||{},a&&or()}),()=>{for(var H of h){n.removeEventListener(H,bi);var I=Wn.get(H);--I===0?(document.removeEventListener(H,bi),Wn.delete(H)):Wn.set(H,I)}Tr.delete(u),D!==i&&D.parentNode?.removeChild(D)}});return oa.set(b,C),b}let oa=new WeakMap;class aa{anchor;#e=new Map;#t=new Map;#i=new Map;#n=new Set;#a=!0;constructor(n,i=!0){this.anchor=n,this.#a=i}#l=()=>{var n=oe;if(this.#e.has(n)){var i=this.#e.get(n),l=this.#t.get(i);if(l)Yr(l),this.#n.delete(i);else{var o=this.#i.get(i);o&&(this.#t.set(i,o.effect),this.#i.delete(i),o.fragment.lastChild.remove(),this.anchor.before(o.fragment),l=o.effect)}for(const[a,p]of this.#e){if(this.#e.delete(a),a===n)break;const h=this.#i.get(p);h&&(tt(h.effect),this.#i.delete(p))}for(const[a,p]of this.#t){if(a===i||this.#n.has(a))continue;const h=()=>{if(Array.from(this.#e.values()).includes(a)){var b=document.createDocumentFragment();vs(p,b),b.append(Sn()),this.#i.set(a,{effect:p,fragment:b})}else tt(p);this.#n.delete(a),this.#t.delete(a)};this.#a||!l?(this.#n.add(a),Cn(p,h,!1)):h()}}};#r=n=>{this.#e.delete(n);const i=Array.from(this.#e.values());for(const[l,o]of this.#i)i.includes(l)||(tt(o.effect),this.#i.delete(l))};ensure(n,i){var l=oe,o=os();if(i&&!this.#t.has(n)&&!this.#i.has(n))if(o){var a=document.createDocumentFragment(),p=Sn();a.append(p),this.#i.set(n,{effect:ft(()=>i(p)),fragment:a})}else this.#t.set(n,ft(()=>i(this.anchor)));if(this.#e.set(l,n),o){for(const[h,u]of this.#t)h===n?l.skipped_effects.delete(u):l.skipped_effects.add(u);for(const[h,u]of this.#i)h===n?l.skipped_effects.delete(u.effect):l.skipped_effects.add(u.effect);l.oncommit(this.#l),l.ondiscard(this.#r)}else this.#l()}}function Pt(t,n,i=!1){var l=new aa(t),o=i?Kn:0;function a(p,h){l.ensure(p,h)}jr(()=>{var p=!1;n((h,u=!0)=>{p=!0,a(u,h)}),p||a(!1,null)},o)}function xn(t,n){return n}function ca(t,n,i){for(var l=[],o=n.length,a,p=n.length,h=0;h<o;h++){let D=n[h];Cn(D,()=>{if(a){if(a.pending.delete(D),a.done.add(D),a.pending.size===0){var H=t.outrogroups;Er(rr(a.done)),H.delete(a),H.size===0&&(t.outrogroups=null)}}else p-=1},!1)}if(p===0){var u=l.length===0&&i!==null;if(u){var b=i,C=b.parentNode;$o(C),C.append(b),t.items.clear()}Er(n,!u)}else a={pending:new Set(n),done:new Set},(t.outrogroups??=new Set).add(a)}function Er(t,n=!0){for(var i=0;i<t.length;i++)tt(t[i],n)}var zl;function an(t,n,i,l,o,a=null){var p=t,h=new Map,u=(n&Wl)!==0;if(u){var b=t;p=b.appendChild(Sn())}var C=null,D=Jl(()=>{var m=i();return Fr(m)?m:m==null?[]:rr(m)}),H,I=!0;function $(){d.fallback=C,ua(d,H,p,n,l),C!==null&&(H.length===0?(C.f&Vt)===0?Yr(C):(C.f^=Vt,yi(C,null,p)):Cn(C,()=>{C=null}))}var V=jr(()=>{H=e(D);for(var m=H.length,A=new Set,ce=oe,we=os(),he=0;he<m;he+=1){var Ae=H[he],y=l(Ae,he),R=I?null:h.get(y);R?(R.v&&Qn(R.v,Ae),R.i&&Qn(R.i,he),we&&ce.skipped_effects.delete(R.e)):(R=fa(h,I?p:zl??=Sn(),Ae,y,he,o,n,i),I||(R.e.f|=Vt),h.set(y,R)),A.add(y)}if(m===0&&a&&!C&&(I?C=ft(()=>a(p)):(C=ft(()=>a(zl??=Sn())),C.f|=Vt)),!I)if(we){for(const[X,j]of h)A.has(X)||ce.skipped_effects.add(j.e);ce.oncommit($),ce.ondiscard(()=>{})}else $();e(D)}),d={effect:V,items:h,outrogroups:null,fallback:C};I=!1}function ua(t,n,i,l,o){var a=(l&bo)!==0,p=n.length,h=t.items,u=t.effect.first,b,C=null,D,H=[],I=[],$,V,d,m;if(a)for(m=0;m<p;m+=1)$=n[m],V=o($,m),d=h.get(V).e,(d.f&Vt)===0&&(d.nodes?.a?.measure(),(D??=new Set).add(d));for(m=0;m<p;m+=1){if($=n[m],V=o($,m),d=h.get(V).e,t.outrogroups!==null)for(const j of t.outrogroups)j.pending.delete(d),j.done.delete(d);if((d.f&Vt)!==0)if(d.f^=Vt,d===u)yi(d,null,i);else{var A=C?C.next:u;d===t.effect.last&&(t.effect.last=d.prev),d.prev&&(d.prev.next=d.next),d.next&&(d.next.prev=d.prev),on(t,C,d),on(t,d,A),yi(d,A,i),C=d,H=[],I=[],u=C.next;continue}if((d.f&ot)!==0&&(Yr(d),a&&(d.nodes?.a?.unfix(),(D??=new Set).delete(d))),d!==u){if(b!==void 0&&b.has(d)){if(H.length<I.length){var ce=I[0],we;C=ce.prev;var he=H[0],Ae=H[H.length-1];for(we=0;we<H.length;we+=1)yi(H[we],ce,i);for(we=0;we<I.length;we+=1)b.delete(I[we]);on(t,he.prev,Ae.next),on(t,C,he),on(t,Ae,ce),u=ce,C=Ae,m-=1,H=[],I=[]}else b.delete(d),yi(d,u,i),on(t,d.prev,d.next),on(t,d,C===null?t.effect.first:C.next),on(t,C,d),C=d;continue}for(H=[],I=[];u!==null&&u!==d;)(b??=new Set).add(u),I.push(u),u=u.next;if(u===null)continue}(d.f&Vt)===0&&H.push(d),C=d,u=d.next}if(t.outrogroups!==null){for(const j of t.outrogroups)j.pending.size===0&&(Er(rr(j.done)),t.outrogroups?.delete(j));t.outrogroups.size===0&&(t.outrogroups=null)}if(u!==null||b!==void 0){var y=[];if(b!==void 0)for(d of b)(d.f&ot)===0&&y.push(d);for(;u!==null;)(u.f&ot)===0&&u!==t.fallback&&y.push(u),u=u.next;var R=y.length;if(R>0){var X=(l&Wl)!==0&&p===0?i:null;if(a){for(m=0;m<R;m+=1)y[m].nodes?.a?.measure();for(m=0;m<R;m+=1)y[m].nodes?.a?.fix()}ca(t,y,X)}}a&&ti(()=>{if(D!==void 0)for(d of D)d.nodes?.a?.apply()})}function fa(t,n,i,l,o,a,p,h){var u=(p&go)!==0?(p&yo)===0?Ur(i,!1,!1):En(i):null,b=(p&_o)!==0?En(o):null;return{v:u,i:b,e:ft(()=>(a(n,u??i,b??o,h),()=>{t.delete(l)}))}}function yi(t,n,i){if(t.nodes)for(var l=t.nodes.start,o=t.nodes.end,a=n&&(n.f&Vt)===0?n.nodes.start:i;l!==null;){var p=cr(l);if(a.before(l),l===o)return;l=p}}function on(t,n,i){n===null?t.effect.first=i:n.next=i,i===null?t.effect.last=n:i.prev=n}const Tl=[...` 	
\r\fÂ \v\uFEFF`];function da(t,n,i){var l=t==null?"":""+t;if(n&&(l=l?l+" "+n:n),i){for(var o in i)if(i[o])l=l?l+" "+o:o;else if(l.length)for(var a=o.length,p=0;(p=l.indexOf(o,p))>=0;){var h=p+a;(p===0||Tl.includes(l[p-1]))&&(h===l.length||Tl.includes(l[h]))?l=(p===0?"":l.substring(0,p))+l.substring(h+1):p=h}}return l===""?null:l}function ha(t,n){return t==null?null:String(t)}function J(t,n,i,l,o,a){var p=t.__className;if(p!==i||p===void 0){var h=da(i,l,a);h==null?t.removeAttribute("class"):t.className=h,t.__className=i}else if(a&&o!==a)for(var u in a){var b=!!a[u];(o==null||b!==!!o[u])&&t.classList.toggle(u,b)}return a}function Lr(t,n,i,l){var o=t.__style;if(o!==n){var a=ha(n);a==null?t.removeAttribute("style"):t.style.cssText=a,t.__style=n}return l}function Qi(t,n,i=!1){if(t.multiple){if(n==null)return;if(!Fr(n))return xo();for(var l of t.options)l.selected=n.includes(El(l));return}for(l of t.options){var o=El(l);if(Fo(o,n)){l.selected=!0;return}}(!i||n!==void 0)&&(t.selectedIndex=-1)}function wr(t){var n=new MutationObserver(()=>{Qi(t,t.__value)});n.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),fr(()=>{n.disconnect()})}function El(t){return"__value"in t?t.__value:t.value}const va=Symbol("is custom element"),pa=Symbol("is html");function Ll(t,n){var i=Ss(t);i.checked!==(i.checked=n??void 0)&&(t.checked=n)}function ks(t,n,i,l){var o=Ss(t);o[n]!==(o[n]=i)&&(n==="loading"&&(t[ro]=i),i==null?t.removeAttribute(n):typeof i!="string"&&ga(t).includes(n)?t[n]=i:t.setAttribute(n,i))}function Ss(t){return t.__attributes??={[va]:t.nodeName.includes("-"),[pa]:t.namespaceURI===wo}}var Pl=new Map;function ga(t){var n=t.getAttribute("is")||t.nodeName,i=Pl.get(n);if(i)return i;Pl.set(n,i=[]);for(var l,o=t,a=Element.prototype;a!==o;){l=Qs(o);for(var p in l)l[p].set&&i.push(p);o=Dl(o)}return i}function _a(t,n,i=n){var l=new WeakSet;No(t,"input",async o=>{var a=o?t.defaultValue:t.value;if(a=xr(t)?kr(a):a,i(a),oe!==null&&l.add(oe),await Jo(),a!==(a=n())){var p=t.selectionStart,h=t.selectionEnd,u=t.value.length;if(t.value=a??"",h!==null){var b=t.value.length;p===h&&h===u&&b>u?(t.selectionStart=b,t.selectionEnd=b):(t.selectionStart=p,t.selectionEnd=Math.min(h,b))}}}),Ei(n)==null&&t.value&&(i(xr(t)?kr(t.value):t.value),oe!==null&&l.add(oe)),Xr(()=>{var o=n();if(t===document.activeElement){var a=Zi??oe;if(l.has(a))return}xr(t)&&o===kr(t.value)||t.type==="date"&&!o&&!t.value||o!==t.value&&(t.value=o??"")})}function xr(t){var n=t.type;return n==="number"||n==="range"}function kr(t){return t===""?null:+t}function Hl(t,n){return t===n||t?.[Gn]===n}function jn(t={},n,i,l){return Xo(()=>{var o,a;return Xr(()=>{o=a,a=l?.()||[],Ei(()=>{t!==i(...a)&&(n(t,...a),o&&Hl(i(...o),t)&&n(null,...o))})}),()=>{ti(()=>{a&&Hl(i(...a),t)&&n(null,...a)})}}),t}function Kr(t,n,i){if(t==null)return n(void 0),i&&i(void 0),Ut;const l=Ei(()=>t.subscribe(n,i));return l.unsubscribe?()=>l.unsubscribe():l}const Vn=[];function ba(t,n){return{subscribe:St(t,n).subscribe}}function St(t,n=Ut){let i=null;const l=new Set;function o(h){if(Ul(t,h)&&(t=h,i)){const u=!Vn.length;for(const b of l)b[1](),Vn.push(b,t);if(u){for(let b=0;b<Vn.length;b+=2)Vn[b][0](Vn[b+1]);Vn.length=0}}}function a(h){o(h(t))}function p(h,u=Ut){const b=[h,u];return l.add(b),l.size===1&&(i=n(o,a)||Ut),h(t),()=>{l.delete(b),l.size===0&&i&&(i(),i=null)}}return{set:o,update:a,subscribe:p}}function Zr(t,n,i){const l=!Array.isArray(t),o=l?[t]:t;if(!o.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const a=n.length<2;return ba(i,(p,h)=>{let u=!1;const b=[];let C=0,D=Ut;const H=()=>{if(C)return;D();const $=n(l?b[0]:b,p,h);a?p($):D=typeof $=="function"?$:Ut},I=o.map(($,V)=>Kr($,d=>{b[V]=d,C&=~(1<<V),u&&H()},()=>{C|=1<<V}));return u=!0,H(),function(){$l(I),D(),u=!1}})}function ya(t){let n;return Kr(t,i=>n=i)(),n}let Pr=Symbol();function Re(t,n,i){const l=i[n]??={store:null,source:Ur(void 0),unsubscribe:Ut};if(l.store!==t&&!(Pr in i))if(l.unsubscribe(),l.store=t??null,t==null)l.source.v=void 0,l.unsubscribe=Ut;else{var o=!0;l.unsubscribe=Kr(t,a=>{o?l.source.v=a:f(l.source,a)}),o=!1}return t&&Pr in i?ya(t):e(l.source)}function Jr(){const t={};function n(){fr(()=>{for(var i in t)t[i].unsubscribe();Fl(t,Pr,{enumerable:!1,value:!0})})}return[t,n]}function Al(t,n,i,l){var o=l,a=!0,p=()=>(a&&(a=!1,o=l),o),h;h=t[n],h===void 0&&l!==void 0&&(h=p());var u;return u=()=>{var b=t[n];return b===void 0?p():(a=!0,b)},u}function Cs(t){ze===null&&lo(),Mi&&ze.l!==null?ma(ze).m.push(t):Ji(()=>{const n=Ei(t);if(typeof n=="function")return n})}function ma(t){var n=t.l;return n.u??={a:[],b:[],m:[]}}const wa="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(wa);Co();const Is={A4:{name:"A4",width:210,height:297},A5:{name:"A5",width:148,height:210},LETTER:{name:"Letter",width:215.9,height:279.4},LEGAL:{name:"Legal",width:215.9,height:355.6},TEXTBOOK:{name:"US Textbook",width:236.2,height:279.4}},Hr={top:25.4,right:25.4,bottom:25.4,left:25.4},Ol={top:12.7,right:12.7,bottom:12.7,left:12.7},ql={top:25.4,right:50.8,bottom:25.4,left:50.8};function ht(t){return t/25.4*96}function Qr(t){const{format:n,orientation:i}=t;return i==="landscape"?{width:ht(n.height),height:ht(n.width)}:{width:ht(n.width),height:ht(n.height)}}function el(t){const n=Qr(t),{margins:i}=t;return{width:n.width-ht(i.left)-ht(i.right),height:n.height-ht(i.top)-ht(i.bottom)}}function Ms(t){const n=el(t),i=t.columns||1,l=ht(t.columnGap||0);return i===1?n.width:(n.width-l)/2}const zs=St([]),mi=St(1),Ts=St(1),Tt=St({format:Is.A4,margins:Hr,orientation:"portrait",columns:1,columnGap:10}),er=St(100);Zr(Tt,t=>Qr(t));Zr(Tt,t=>el(t));Zr(Tt,t=>Ms(t));const Es=St(16),Ar=St("Arial"),Or=St(1.5),qr=St(0),Rr=St(12),Un=[8,9,10,11,12,14,16,18,20,24,28,32,36,48,72],xa=["Arial","Times New Roman","Georgia","Verdana","Courier New","Trebuchet MS","Comic Sans MS","Impact","Palatino Linotype","Garamond"],ka=[{value:1,label:"Single"},{value:1.15,label:"1.15"},{value:1.5,label:"1.5"},{value:2,label:"Double"},{value:2.5,label:"2.5"},{value:3,label:"Triple"}],Sa=[{value:-1,label:"Tight"},{value:0,label:"Normal"},{value:.5,label:"Wide"},{value:1,label:"Wider"},{value:2,label:"Widest"}],Ca=[{value:0,label:"None"},{value:6,label:"Small"},{value:12,label:"Medium"},{value:18,label:"Large"},{value:24,label:"Extra Large"}];var Ia=Ce('<div class="dropdown-menu heading-dropdown-menu svelte-1dqac8y"><button>Normal text</button> <button>Heading 1</button> <button>Heading 2</button> <button>Heading 3</button> <button>Heading 4</button> <div class="heading-divider svelte-1dqac8y"></div> <button>Quote</button></div>'),Ma=Ce("<option> </option>"),za=Ce("<option> </option>"),Ta=Ce("<button> </button>"),Ea=Ce("<button> </button>"),La=Ce("<button> </button>"),Pa=Ce('<div class="dropdown-menu spacing-menu svelte-1dqac8y"><div class="dropdown-section svelte-1dqac8y"><label class="dropdown-label svelte-1dqac8y">Line Height</label> <div class="dropdown-options spacing-options svelte-1dqac8y"></div></div> <div class="dropdown-section svelte-1dqac8y"><label class="dropdown-label svelte-1dqac8y">Letter Spacing</label> <div class="dropdown-options spacing-options svelte-1dqac8y"></div></div> <div class="dropdown-section svelte-1dqac8y"><label class="dropdown-label svelte-1dqac8y">Paragraph Spacing</label> <div class="dropdown-options spacing-options svelte-1dqac8y"></div></div></div>'),Ha=Ce('<div class="dropdown-menu page-settings-menu svelte-1dqac8y"><div class="dropdown-section svelte-1dqac8y"><label class="dropdown-label svelte-1dqac8y">Page Size</label> <div class="dropdown-options svelte-1dqac8y"><button>A4</button> <button>A5</button> <button>Letter</button> <button>Legal</button> <button>US Textbook</button></div></div> <div class="dropdown-section svelte-1dqac8y"><label class="dropdown-label svelte-1dqac8y">Orientation</label> <div class="dropdown-options svelte-1dqac8y"><button><svg width="16" height="20" viewBox="0 0 16 20" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="1" y="1" width="14" height="18" rx="1"></rect></svg> Portrait</button> <button><svg width="20" height="16" viewBox="0 0 20 16" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="1" y="1" width="18" height="14" rx="1"></rect></svg> Landscape</button></div></div> <div class="dropdown-section svelte-1dqac8y"><label class="dropdown-label svelte-1dqac8y">Margins</label> <div class="dropdown-options margins-options svelte-1dqac8y"><button><svg width="24" height="30" viewBox="0 0 24 30" fill="none" stroke="currentColor" stroke-width="1"><rect x="1" y="1" width="22" height="28" rx="1"></rect><rect x="4" y="4" width="16" height="22" fill="#e0e0e0" stroke="none"></rect></svg> Normal</button> <button><svg width="24" height="30" viewBox="0 0 24 30" fill="none" stroke="currentColor" stroke-width="1"><rect x="1" y="1" width="22" height="28" rx="1"></rect><rect x="2" y="2" width="20" height="26" fill="#e0e0e0" stroke="none"></rect></svg> Narrow</button> <button><svg width="24" height="30" viewBox="0 0 24 30" fill="none" stroke="currentColor" stroke-width="1"><rect x="1" y="1" width="22" height="28" rx="1"></rect><rect x="6" y="6" width="12" height="18" fill="#e0e0e0" stroke="none"></rect></svg> Wide</button></div></div></div>'),Aa=Ce('<div class="dropdown-menu columns-menu svelte-1dqac8y"><div class="dropdown-section svelte-1dqac8y"><label class="dropdown-label svelte-1dqac8y">Columns</label> <div class="dropdown-options columns-options svelte-1dqac8y"><button><svg width="32" height="40" viewBox="0 0 32 40" fill="none" stroke="currentColor" stroke-width="1"><rect x="1" y="1" width="30" height="38" rx="1"></rect><rect x="4" y="4" width="24" height="32" fill="#e0e0e0" stroke="none"></rect></svg> One</button> <button><svg width="32" height="40" viewBox="0 0 32 40" fill="none" stroke="currentColor" stroke-width="1"><rect x="1" y="1" width="30" height="38" rx="1"></rect><rect x="4" y="4" width="11" height="32" fill="#e0e0e0" stroke="none"></rect><rect x="17" y="4" width="11" height="32" fill="#e0e0e0" stroke="none"></rect></svg> Two</button></div></div></div>'),Oa=Ce('<div class="toolbar svelte-1dqac8y"><div class="toolbar-group svelte-1dqac8y"><button class="toolbar-btn svelte-1dqac8y" title="Undo (Ctrl+Z)"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z"></path></svg></button> <button class="toolbar-btn svelte-1dqac8y" title="Redo (Ctrl+Y)"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M18.4 10.6C16.55 8.99 14.15 8 11.5 8c-4.65 0-8.58 3.03-9.96 7.22L3.9 16c1.05-3.19 4.05-5.5 7.6-5.5 1.95 0 3.73.72 5.12 1.88L13 16h9V7l-3.6 3.6z"></path></svg></button> <button class="toolbar-btn svelte-1dqac8y" title="Save (Ctrl+S)"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"></path></svg></button></div> <div class="toolbar-divider svelte-1dqac8y"></div> <div class="toolbar-group svelte-1dqac8y"><div class="dropdown-wrapper svelte-1dqac8y"><button title="Text style"><span class="heading-btn-label svelte-1dqac8y"> </span> <svg class="dropdown-arrow svelte-1dqac8y" width="12" height="12" viewBox="0 0 24 24" fill="currentColor"><path d="M7 10l5 5 5-5z"></path></svg></button> <!></div></div> <div class="toolbar-divider svelte-1dqac8y"></div> <div class="toolbar-group svelte-1dqac8y"><select class="toolbar-select font-family-select svelte-1dqac8y" title="Font family"></select> <button class="toolbar-btn font-size-btn svelte-1dqac8y" title="Decrease font size"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M5.12 14L7.5 7.67 9.87 14H5.12zM6.5 5L1 19h2.25l1.12-3h6.25l1.12 3H14L8.5 5h-2z"></path><path d="M18 7h-4v2h4v-2z"></path></svg></button> <select class="toolbar-select font-size-select svelte-1dqac8y" title="Font size"></select> <button class="toolbar-btn font-size-btn svelte-1dqac8y" title="Increase font size"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M5.12 14L7.5 7.67 9.87 14H5.12zM6.5 5L1 19h2.25l1.12-3h6.25l1.12 3H14L8.5 5h-2z"></path><path d="M20 9h-2v2h-2v2h2v2h2v-2h2v-2h-2V9z"></path></svg></button></div> <div class="toolbar-divider svelte-1dqac8y"></div> <div class="toolbar-group svelte-1dqac8y"><button class="toolbar-btn svelte-1dqac8y" title="Bold (Ctrl+B)"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M15.6 10.79c.97-.67 1.65-1.77 1.65-2.79 0-2.26-1.75-4-4-4H7v14h7.04c2.09 0 3.71-1.7 3.71-3.79 0-1.52-.86-2.82-2.15-3.42zM10 6.5h3c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5h-3v-3zm3.5 9H10v-3h3.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5z"></path></svg></button> <button class="toolbar-btn svelte-1dqac8y" title="Italic (Ctrl+I)"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M10 4v3h2.21l-3.42 8H6v3h8v-3h-2.21l3.42-8H18V4z"></path></svg></button> <button class="toolbar-btn svelte-1dqac8y" title="Underline (Ctrl+U)"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M12 17c3.31 0 6-2.69 6-6V3h-2.5v8c0 1.93-1.57 3.5-3.5 3.5S8.5 12.93 8.5 11V3H6v8c0 3.31 2.69 6 6 6zm-7 2v2h14v-2H5z"></path></svg></button> <button class="toolbar-btn svelte-1dqac8y" title="Strikethrough"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M10 19h4v-3h-4v3zM5 4v3h5v3h4V7h5V4H5zM3 14h18v-2H3v2z"></path></svg></button> <div class="color-picker-wrapper svelte-1dqac8y"><input type="color" class="color-input svelte-1dqac8y" value="#000000" title="Text color"/> <svg class="color-icon svelte-1dqac8y" width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M11 2L5.5 16h2.25l1.12-3h6.25l1.12 3h2.25L13 2h-2zm-1.38 9L12 4.67 14.38 11H9.62z"></path><rect x="5" y="18" width="14" height="3" fill="currentColor"></rect></svg></div> <div class="color-picker-wrapper svelte-1dqac8y"><input type="color" class="color-input svelte-1dqac8y" value="#FFFF00" title="Highlight color"/> <svg class="color-icon svelte-1dqac8y" width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M16.56 8.94L7.62 0 6.21 1.41l2.38 2.38-5.15 5.15c-.59.59-.59 1.54 0 2.12l5.5 5.5c.29.29.68.44 1.06.44s.77-.15 1.06-.44l5.5-5.5c.59-.58.59-1.53 0-2.12zM5.21 10L10 5.21 14.79 10H5.21zM19 11.5s-2 2.17-2 3.5c0 1.1.9 2 2 2s2-.9 2-2c0-1.33-2-3.5-2-3.5z"></path><rect x="4" y="18" width="14" height="3" fill="#FFFF00"></rect></svg></div></div> <div class="toolbar-divider svelte-1dqac8y"></div> <div class="toolbar-group svelte-1dqac8y"><button class="toolbar-btn svelte-1dqac8y" title="Align left"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M15 15H3v2h12v-2zm0-8H3v2h12V7zM3 13h18v-2H3v2zm0 8h18v-2H3v2zM3 3v2h18V3H3z"></path></svg></button> <button class="toolbar-btn svelte-1dqac8y" title="Align center"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M7 15v2h10v-2H7zm-4 6h18v-2H3v2zm0-8h18v-2H3v2zm4-6v2h10V7H7zM3 3v2h18V3H3z"></path></svg></button> <button class="toolbar-btn svelte-1dqac8y" title="Align right"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M3 21h18v-2H3v2zm6-4h12v-2H9v2zm-6-4h18v-2H3v2zm6-4h12V7H9v2zM3 3v2h18V3H3z"></path></svg></button> <button class="toolbar-btn svelte-1dqac8y" title="Justify"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M3 21h18v-2H3v2zm0-4h18v-2H3v2zm0-4h18v-2H3v2zm0-4h18V7H3v2zM3 3v2h18V3H3z"></path></svg></button> <div class="dropdown-wrapper svelte-1dqac8y"><button title="Line and paragraph spacing"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M6 7h2.5L5 3.5 1.5 7H4v10H1.5L5 20.5 8.5 17H6V7zm4-2v2h12V5H10zm0 14h12v-2H10v2zm0-6h12v-2H10v2z"></path></svg></button> <!></div></div> <div class="toolbar-divider svelte-1dqac8y"></div> <div class="toolbar-group svelte-1dqac8y"><button class="toolbar-btn svelte-1dqac8y" title="Bulleted list"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M4 10.5c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zm0-6c-.83 0-1.5.67-1.5 1.5S3.17 7.5 4 7.5 5.5 6.83 5.5 6 4.83 4.5 4 4.5zm0 12c-.83 0-1.5.68-1.5 1.5s.68 1.5 1.5 1.5 1.5-.68 1.5-1.5-.67-1.5-1.5-1.5zM7 19h14v-2H7v2zm0-6h14v-2H7v2zm0-8v2h14V5H7z"></path></svg></button> <button class="toolbar-btn svelte-1dqac8y" title="Numbered list"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M2 17h2v.5H3v1h1v.5H2v1h3v-4H2v1zm1-9h1V4H2v1h1v3zm-1 3h1.8L2 13.1v.9h3v-1H3.2L5 10.9V10H2v1zm5-6v2h14V5H7zm0 14h14v-2H7v2zm0-6h14v-2H7v2z"></path></svg></button></div> <div class="toolbar-divider svelte-1dqac8y"></div> <div class="toolbar-group svelte-1dqac8y"><button class="toolbar-btn svelte-1dqac8y" title="Insert image"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"></path></svg></button></div> <div class="toolbar-divider svelte-1dqac8y"></div> <div class="toolbar-group page-controls svelte-1dqac8y"><div class="dropdown-wrapper svelte-1dqac8y"><button title="Page settings"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6zM6 20V4h7v5h5v11H6z"></path></svg></button> <!></div> <div class="dropdown-wrapper svelte-1dqac8y"><button title="Columns"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><rect x="4" y="4" width="7" height="16" rx="1" stroke="currentColor" stroke-width="1.5" fill="none"></rect><rect x="13" y="4" width="7" height="16" rx="1" stroke="currentColor" stroke-width="1.5" fill="none"></rect></svg></button> <!></div></div> <div class="toolbar-divider svelte-1dqac8y"></div> <div class="toolbar-group zoom-controls svelte-1dqac8y"><button class="toolbar-btn svelte-1dqac8y" title="Zoom out"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14zM7 9h5v1H7z"></path></svg></button> <select class="toolbar-select zoom-select svelte-1dqac8y"><option>50%</option><option>75%</option><option>100%</option><option>125%</option><option>150%</option><option>200%</option></select> <button class="toolbar-btn svelte-1dqac8y" title="Zoom in"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14zm.5-7H9v2H7v1h2v2h1v-2h2V9h-2z"></path></svg></button></div> <div class="toolbar-spacer svelte-1dqac8y"></div> <div class="toolbar-group page-info svelte-1dqac8y"><span class="page-indicator svelte-1dqac8y"> </span></div></div>');function qa(t,n){sr(n,!0);const i=()=>Re(Es,"$fontSize",D),l=()=>Re(Ar,"$fontFamily",D),o=()=>Re(Or,"$lineHeight",D),a=()=>Re(qr,"$letterSpacing",D),p=()=>Re(Rr,"$paragraphSpacing",D),h=()=>Re(Tt,"$pageConfig",D),u=()=>Re(er,"$zoomLevel",D),b=()=>Re(mi,"$currentPage",D),C=()=>Re(Ts,"$totalPages",D),[D,H]=Jr();let I=Al(n,"canUndo",3,!1),$=Al(n,"canRedo",3,!1),V=W(!1),d=W(!1),m=W(!1),A=W(!1),ce=W("p");Cs(()=>{const B=K=>{K.target.closest(".dropdown-wrapper")||(f(V,!1),f(d,!1),f(m,!1),f(A,!1))};return document.addEventListener("click",B),()=>document.removeEventListener("click",B)});const we={p:"Normal text",h1:"Heading 1",h2:"Heading 2",h3:"Heading 3",h4:"Heading 4",blockquote:"Quote"};function he(B){f(ce,B,!0),ge("formatBlock",B),f(m,!1)}function Ae(B){er.update(K=>Math.min(200,Math.max(25,K+B)))}function y(B){er.set(B)}function R(B){Tt.update(K=>({...K,format:Is[B]}))}function X(B){const K={default:Hr,narrow:Ol,wide:ql};Tt.update(ue=>({...ue,margins:K[B]}))}function j(B){Tt.update(K=>({...K,columns:B}))}function ge(B,K){n.onFormat(B,K)}function ii(B){ge("fontSize",B.toString())}function Li(){const B=Un.indexOf(i());B<Un.length-1&&ii(Un[B+1])}function dr(){const B=Un.indexOf(i());B>0&&ii(Un[B-1])}function Pi(B){Ar.set(B)}var ri=Oa(),Pn=F(ri),Hn=F(Pn);Hn.__click=()=>ge("undo");var Ke=k(Hn,2);Ke.__click=()=>ge("redo");var hr=k(Ke,2);hr.__click=()=>n.onSave?.();var Kt=k(Pn,4),Hi=F(Kt),Zt=F(Hi);let li;Zt.__click=()=>{f(m,!e(m)),f(V,!1),f(d,!1)};var An=F(Zt),vt=F(An),Ai=k(Zt,2);{var On=B=>{var K=Ia();K.__click=$t=>$t.stopPropagation();var ue=F(K);let Fe;ue.__click=()=>he("p");var _e=k(ue,2);let at;_e.__click=()=>he("h1");var Je=k(_e,2);let it;Je.__click=()=>he("h2");var Ee=k(Je,2);let Z;Ee.__click=()=>he("h3");var me=k(Ee,2);let ke;me.__click=()=>he("h4");var Qe=k(me,4);let _n;Qe.__click=()=>he("blockquote"),Ye(()=>{Fe=J(ue,1,"heading-option style-p svelte-1dqac8y",null,Fe,{selected:e(ce)==="p"}),at=J(_e,1,"heading-option style-h1 svelte-1dqac8y",null,at,{selected:e(ce)==="h1"}),it=J(Je,1,"heading-option style-h2 svelte-1dqac8y",null,it,{selected:e(ce)==="h2"}),Z=J(Ee,1,"heading-option style-h3 svelte-1dqac8y",null,Z,{selected:e(ce)==="h3"}),ke=J(me,1,"heading-option style-h4 svelte-1dqac8y",null,ke,{selected:e(ce)==="h4"}),_n=J(Qe,1,"heading-option style-blockquote svelte-1dqac8y",null,_n,{selected:e(ce)==="blockquote"})}),Se(B,K)};Pt(Ai,B=>{e(m)&&B(On)})}var si=k(Kt,4),Te=F(si);Te.__change=B=>Pi(B.currentTarget.value),an(Te,21,()=>xa,xn,(B,K)=>{var ue=Ma(),Fe=F(ue),_e={};Ye(()=>{Lr(ue,`font-family: ${e(K)??""}`),Wt(Fe,e(K)),_e!==(_e=e(K))&&(ue.value=(ue.__value=e(K))??"")}),Se(B,ue)});var Ze;wr(Te);var qn=k(Te,2);qn.__click=dr;var pt=k(qn,2);pt.__change=B=>ii(parseInt(B.currentTarget.value)),an(pt,21,()=>Un,xn,(B,K)=>{var ue=za(),Fe=F(ue),_e={};Ye(()=>{Wt(Fe,e(K)),_e!==(_e=e(K))&&(ue.value=(ue.__value=e(K))??"")}),Se(B,ue)});var oi;wr(pt);var Xe=k(pt,2);Xe.__click=Li;var Jt=k(si,4),dn=F(Jt);dn.__click=()=>ge("bold");var ai=k(dn,2);ai.__click=()=>ge("italic");var Qt=k(ai,2);Qt.__click=()=>ge("underline");var $e=k(Qt,2);$e.__click=()=>ge("strikeThrough");var se=k($e,2),Ot=F(se);Ot.__change=B=>ge("foreColor",B.currentTarget.value);var gt=k(se,2),xe=F(gt);xe.__change=B=>ge("hiliteColor",B.currentTarget.value);var Ie=k(Jt,4),Me=F(Ie);Me.__click=()=>ge("justifyLeft");var Rn=k(Me,2);Rn.__click=()=>ge("justifyCenter");var qt=k(Rn,2);qt.__click=()=>ge("justifyRight");var U=k(qt,2);U.__click=()=>ge("justifyFull");var Ct=k(U,2),hn=F(Ct);let Rt;hn.__click=()=>{f(A,!e(A)),f(V,!1),f(d,!1),f(m,!1)};var Ft=k(hn,2);{var Oi=B=>{var K=Pa();K.__click=Ee=>Ee.stopPropagation();var ue=F(K),Fe=k(F(ue),2);an(Fe,21,()=>ka,xn,(Ee,Z)=>{var me=Ta();let ke;me.__click=()=>Or.set(e(Z).value);var Qe=F(me);Ye(()=>{ke=J(me,1,"dropdown-option spacing-option svelte-1dqac8y",null,ke,{selected:o()===e(Z).value}),Wt(Qe,e(Z).label)}),Se(Ee,me)});var _e=k(ue,2),at=k(F(_e),2);an(at,21,()=>Sa,xn,(Ee,Z)=>{var me=Ea();let ke;me.__click=()=>qr.set(e(Z).value);var Qe=F(me);Ye(()=>{ke=J(me,1,"dropdown-option spacing-option svelte-1dqac8y",null,ke,{selected:a()===e(Z).value}),Wt(Qe,e(Z).label)}),Se(Ee,me)});var Je=k(_e,2),it=k(F(Je),2);an(it,21,()=>Ca,xn,(Ee,Z)=>{var me=La();let ke;me.__click=()=>Rr.set(e(Z).value);var Qe=F(me);Ye(()=>{ke=J(me,1,"dropdown-option spacing-option svelte-1dqac8y",null,ke,{selected:p()===e(Z).value}),Wt(Qe,e(Z).label)}),Se(Ee,me)}),Se(B,K)};Pt(Ft,B=>{e(A)&&B(Oi)})}var ci=k(Ie,4),_t=F(ci);_t.__click=()=>ge("insertUnorderedList");var ui=k(_t,2);ui.__click=()=>ge("insertOrderedList");var je=k(ci,4),bt=F(je);bt.__click=()=>ge("insertImage");var fi=k(je,4),di=F(fi),Oe=F(di);let en;Oe.__click=()=>{f(V,!e(V)),f(d,!1)};var yt=k(Oe,2);{var qi=B=>{var K=Ha();K.__click=bn=>bn.stopPropagation();var ue=F(K),Fe=k(F(ue),2),_e=F(Fe);let at;_e.__click=()=>R("A4");var Je=k(_e,2);let it;Je.__click=()=>R("A5");var Ee=k(Je,2);let Z;Ee.__click=()=>R("LETTER");var me=k(Ee,2);let ke;me.__click=()=>R("LEGAL");var Qe=k(me,2);let _n;Qe.__click=()=>R("TEXTBOOK");var $t=k(ue,2),pi=k(F($t),2),fe=F(pi);let $i;fe.__click=()=>Tt.update(bn=>({...bn,orientation:"portrait"}));var Bi=k(fe,2);let Ni;Bi.__click=()=>Tt.update(bn=>({...bn,orientation:"landscape"}));var Wi=k($t,2),gr=k(F(Wi),2),gi=F(gr);let zt;gi.__click=()=>X("default");var Bn=k(gi,2);let Vi;Bn.__click=()=>X("narrow");var Ui=k(Bn,2);let Xi;Ui.__click=()=>X("wide"),Ye(()=>{at=J(_e,1,"dropdown-option svelte-1dqac8y",null,at,{selected:h().format.name==="A4"}),it=J(Je,1,"dropdown-option svelte-1dqac8y",null,it,{selected:h().format.name==="A5"}),Z=J(Ee,1,"dropdown-option svelte-1dqac8y",null,Z,{selected:h().format.name==="Letter"}),ke=J(me,1,"dropdown-option svelte-1dqac8y",null,ke,{selected:h().format.name==="Legal"}),_n=J(Qe,1,"dropdown-option svelte-1dqac8y",null,_n,{selected:h().format.name==="US Textbook"}),$i=J(fe,1,"dropdown-option orientation-option svelte-1dqac8y",null,$i,{selected:h().orientation==="portrait"}),Ni=J(Bi,1,"dropdown-option orientation-option svelte-1dqac8y",null,Ni,{selected:h().orientation==="landscape"}),zt=J(gi,1,"dropdown-option margin-option svelte-1dqac8y",null,zt,{selected:h().margins===Hr}),Vi=J(Bn,1,"dropdown-option margin-option svelte-1dqac8y",null,Vi,{selected:h().margins===Ol}),Xi=J(Ui,1,"dropdown-option margin-option svelte-1dqac8y",null,Xi,{selected:h().margins===ql})}),Se(B,K)};Pt(yt,B=>{e(V)&&B(qi)})}var Ri=k(di,2),tn=F(Ri);let vn;tn.__click=()=>{f(d,!e(d)),f(V,!1)};var Fn=k(tn,2);{var ee=B=>{var K=Aa();K.__click=Ee=>Ee.stopPropagation();var ue=F(K),Fe=k(F(ue),2),_e=F(Fe);let at;_e.__click=()=>{j(1),f(d,!1)};var Je=k(_e,2);let it;Je.__click=()=>{j(2),f(d,!1)},Ye(()=>{at=J(_e,1,"dropdown-option column-option svelte-1dqac8y",null,at,{selected:h().columns===1}),it=J(Je,1,"dropdown-option column-option svelte-1dqac8y",null,it,{selected:h().columns===2})}),Se(B,K)};Pt(Fn,B=>{e(d)&&B(ee)})}var pn=k(fi,4),Dt=F(pn);Dt.__click=()=>Ae(-10);var It=k(Dt,2);It.__change=B=>y(parseInt(B.currentTarget.value));var hi=F(It);hi.value=hi.__value="50";var gn=k(hi);gn.value=gn.__value="75";var nn=k(gn);nn.value=nn.__value="100";var Dn=k(nn);Dn.value=Dn.__value="125";var Mt=k(Dn);Mt.value=Mt.__value="150";var Fi=k(Mt);Fi.value=Fi.__value="200";var $n;wr(It);var vr=k(It,2);vr.__click=()=>Ae(10);var pr=k(pn,4),Di=F(pr),vi=F(Di);Ye(()=>{Hn.disabled=!I(),Ke.disabled=!$(),li=J(Zt,1,"toolbar-btn heading-dropdown-btn svelte-1dqac8y",null,li,{active:e(m)}),Wt(vt,we[e(ce)]),Ze!==(Ze=l())&&(Te.value=(Te.__value=l())??"",Qi(Te,l())),oi!==(oi=i())&&(pt.value=(pt.__value=i())??"",Qi(pt,i())),Rt=J(hn,1,"toolbar-btn svelte-1dqac8y",null,Rt,{active:e(A)}),en=J(Oe,1,"toolbar-btn svelte-1dqac8y",null,en,{active:e(V)}),vn=J(tn,1,"toolbar-btn svelte-1dqac8y",null,vn,{active:e(d)}),$n!==($n=u())&&(It.value=(It.__value=u())??"",Qi(It,u())),Wt(vi,`Page ${b()??""} of ${C()??""}`)}),Se(t,ri),or(),H()}Gr(["click","change"]);const Xn="ï¿¼",Rl="ï¿½";function xt(){return{align:"left",listType:"none",blockType:"p",indent:0}}function Sr(t){return{paragraphs:[...t.paragraphs],paragraphMeta:t.paragraphMeta.map(n=>({...n})),images:t.images.map(n=>({...n})),cursorPara:t.cursorPara,cursorOffset:t.cursorOffset,selectionStart:t.selectionStart?{...t.selectionStart}:null,selectionEnd:t.selectionEnd?{...t.selectionEnd}:null}}function Ra(t,n){if(t.paragraphs.length!==n.paragraphs.length||t.images.length!==n.images.length)return!1;for(let i=0;i<t.paragraphs.length;i++)if(t.paragraphs[i]!==n.paragraphs[i])return!1;for(let i=0;i<t.paragraphMeta.length;i++){const l=t.paragraphMeta[i],o=n.paragraphMeta[i];if(l.align!==o.align||l.listType!==o.listType||l.blockType!==o.blockType||l.indent!==o.indent||l.fontSize!==o.fontSize||l.textColor!==o.textColor)return!1}for(let i=0;i<t.images.length;i++){const l=t.images[i],o=n.images[i];if(l.id!==o.id||l.width!==o.width||l.height!==o.height||l.wrapStyle!==o.wrapStyle||l.x!==o.x||l.y!==o.y)return!1}return!0}function Fa(t=100){let n=[],i=[];return{push(l){const o=Sr(l);n.length>0&&Ra(n[n.length-1],o)||(n.push(o),i=[],n.length>t&&n.shift())},undo(){if(n.length<2)return null;const l=n.pop();i.push(l);const o=n[n.length-1];return Sr(o)},redo(){if(i.length===0)return null;const l=i.pop();return n.push(l),Sr(l)},canUndo(){return n.length>=2},canRedo(){return i.length>0},clear(){n=[],i=[]},size(){return n.length}}}function Da(t,n=300){let i=null,l=null;return{schedulePush(o){l=o,i!==null&&clearTimeout(i),i=setTimeout(()=>{l&&(t.push(l),l=null),i=null},n)},cancelPush(){i!==null&&(clearTimeout(i),i=null),l=null},flushPush(){i!==null&&(clearTimeout(i),i=null),l&&(t.push(l),l=null)}}}var $a=Ce("<canvas></canvas>"),Ba=Ce('<div class="popup-overlay svelte-1h8xysy"><div class="popup-dialog svelte-1h8xysy"><div class="popup-header svelte-1h8xysy"><h3 class="svelte-1h8xysy">Insert Image</h3> <button class="popup-close svelte-1h8xysy">&times;</button></div> <div class="popup-content svelte-1h8xysy"><div class="input-section svelte-1h8xysy"><label for="image-url" class="svelte-1h8xysy">Image URL</label> <div class="url-input-row svelte-1h8xysy"><input id="image-url" type="text" placeholder="https://example.com/image.jpg" class="svelte-1h8xysy"/> <button class="svelte-1h8xysy">Insert</button></div></div> <div class="divider svelte-1h8xysy"><span class="svelte-1h8xysy">or</span></div>  <div><svg width="48" height="48" viewBox="0 0 24 24" fill="#9aa0a6"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"></path></svg> <p class="svelte-1h8xysy">Drag and drop an image here</p> <p class="small svelte-1h8xysy">or click to select from your computer</p></div> <input id="file-input" type="file" accept="image/*" class="file-input svelte-1h8xysy"/> <p class="tip svelte-1h8xysy">Tip: You can also paste an image directly in the editor (Ctrl+V)</p></div></div></div>'),Na=Ce('<div class="image-options-section svelte-1h8xysy"><div class="section-label svelte-1h8xysy">Horizontal Position</div> <div class="image-options-buttons svelte-1h8xysy"><button title="Align left"><svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" class="svelte-1h8xysy"><rect x="2" y="6" width="10" height="12" rx="1" stroke="currentColor" stroke-width="1.5" fill="none"></rect></svg></button> <button title="Center"><svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" class="svelte-1h8xysy"><rect x="7" y="6" width="10" height="12" rx="1" stroke="currentColor" stroke-width="1.5" fill="none"></rect></svg></button> <button title="Align right"><svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" class="svelte-1h8xysy"><rect x="12" y="6" width="10" height="12" rx="1" stroke="currentColor" stroke-width="1.5" fill="none"></rect></svg></button></div></div>'),Wa=Ce('<div class="image-options-overlay svelte-1h8xysy"><div class="image-options-popup svelte-1h8xysy"><div class="image-options-header svelte-1h8xysy"><span>Layout Options</span> <button class="popup-close svelte-1h8xysy">&times;</button></div> <div class="image-options-section svelte-1h8xysy"><div class="section-label svelte-1h8xysy">In Line with Text</div> <div class="image-options-buttons svelte-1h8xysy"><button title="In line with text"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" class="svelte-1h8xysy"><line x1="2" y1="8" x2="8" y2="8" stroke="currentColor" stroke-width="1.5"></line><rect x="9" y="5" width="6" height="6" rx="1" stroke="currentColor" stroke-width="1.5" fill="none"></rect><line x1="16" y1="8" x2="22" y2="8" stroke="currentColor" stroke-width="1.5"></line><line x1="2" y1="14" x2="22" y2="14" stroke="currentColor" stroke-width="1.5"></line><line x1="2" y1="18" x2="22" y2="18" stroke="currentColor" stroke-width="1.5"></line></svg> <span>In Line</span></button></div></div> <div class="image-options-section svelte-1h8xysy"><div class="section-label svelte-1h8xysy">With Text Wrapping</div> <div class="image-options-buttons wrap-buttons svelte-1h8xysy"><button title="Square - text wraps in a square around the image"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" class="svelte-1h8xysy"><rect x="2" y="4" width="8" height="8" rx="1" stroke="currentColor" stroke-width="1.5" fill="none"></rect><line x1="12" y1="5" x2="22" y2="5" stroke="currentColor" stroke-width="1.5"></line><line x1="12" y1="8" x2="22" y2="8" stroke="currentColor" stroke-width="1.5"></line><line x1="12" y1="11" x2="22" y2="11" stroke="currentColor" stroke-width="1.5"></line><line x1="2" y1="15" x2="22" y2="15" stroke="currentColor" stroke-width="1.5"></line><line x1="2" y1="19" x2="22" y2="19" stroke="currentColor" stroke-width="1.5"></line></svg> <span>Square</span></button> <button title="Tight - text wraps tightly around the image"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" class="svelte-1h8xysy"><path d="M3 5 L9 5 L9 11 L3 11 Z" stroke="currentColor" stroke-width="1.5" fill="none"></path><line x1="11" y1="5" x2="21" y2="5" stroke="currentColor" stroke-width="1.5"></line><line x1="11" y1="8" x2="21" y2="8" stroke="currentColor" stroke-width="1.5"></line><line x1="11" y1="11" x2="21" y2="11" stroke="currentColor" stroke-width="1.5"></line><line x1="3" y1="14" x2="21" y2="14" stroke="currentColor" stroke-width="1.5"></line><line x1="3" y1="18" x2="21" y2="18" stroke="currentColor" stroke-width="1.5"></line></svg> <span>Tight</span></button> <button title="Through - text flows through the image"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" class="svelte-1h8xysy"><path d="M4 4 L10 4 L10 10 L4 10 Z" stroke="currentColor" stroke-width="1.5" fill="none" stroke-dasharray="2,1"></path><line x1="12" y1="5" x2="20" y2="5" stroke="currentColor" stroke-width="1.5"></line><line x1="12" y1="9" x2="20" y2="9" stroke="currentColor" stroke-width="1.5"></line><line x1="4" y1="14" x2="20" y2="14" stroke="currentColor" stroke-width="1.5"></line><line x1="4" y1="18" x2="20" y2="18" stroke="currentColor" stroke-width="1.5"></line></svg> <span>Through</span></button> <button title="Top and Bottom - text above and below only"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" class="svelte-1h8xysy"><line x1="2" y1="4" x2="22" y2="4" stroke="currentColor" stroke-width="1.5"></line><rect x="6" y="8" width="12" height="8" rx="1" stroke="currentColor" stroke-width="1.5" fill="none"></rect><line x1="2" y1="20" x2="22" y2="20" stroke="currentColor" stroke-width="1.5"></line></svg> <span>Top/Bottom</span></button> <button title="Behind Text - image appears behind text"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" class="svelte-1h8xysy"><rect x="6" y="6" width="12" height="12" rx="1" stroke="currentColor" stroke-width="1.5" fill="none" opacity="0.5"></rect><line x1="2" y1="8" x2="22" y2="8" stroke="currentColor" stroke-width="1.5"></line><line x1="2" y1="12" x2="22" y2="12" stroke="currentColor" stroke-width="1.5"></line><line x1="2" y1="16" x2="22" y2="16" stroke="currentColor" stroke-width="1.5"></line></svg> <span>Behind</span></button> <button title="In Front of Text - image appears in front of text"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" class="svelte-1h8xysy"><line x1="2" y1="8" x2="22" y2="8" stroke="currentColor" stroke-width="1.5" opacity="0.5"></line><line x1="2" y1="12" x2="22" y2="12" stroke="currentColor" stroke-width="1.5" opacity="0.5"></line><line x1="2" y1="16" x2="22" y2="16" stroke="currentColor" stroke-width="1.5" opacity="0.5"></line><rect x="6" y="6" width="12" height="12" rx="1" stroke="currentColor" stroke-width="1.5" fill="white"></rect></svg> <span>In Front</span></button></div></div> <!> <div class="image-options-section svelte-1h8xysy"><div class="section-label svelte-1h8xysy">Position</div> <div class="position-radio-group svelte-1h8xysy"><label class="radio-option svelte-1h8xysy"><input type="radio" name="positionMode" class="svelte-1h8xysy"/> <span>Move with text</span></label> <label class="radio-option svelte-1h8xysy"><input type="radio" name="positionMode" class="svelte-1h8xysy"/> <span>Fix position on page</span></label></div></div> <div class="image-options-section svelte-1h8xysy"><div class="section-label svelte-1h8xysy">Edit</div> <div class="image-options-buttons svelte-1h8xysy"><button class="layout-btn svelte-1h8xysy" title="Crop image"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" class="svelte-1h8xysy"><path d="M17 15h2V7c0-1.1-.9-2-2-2H9v2h8v8zM7 17V1H5v4H1v2h4v10c0 1.1.9 2 2 2h10v4h2v-4h4v-2H7z"></path></svg> <span>Crop</span></button> <button class="layout-btn svelte-1h8xysy" title="Reset crop"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" class="svelte-1h8xysy"><path d="M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"></path></svg> <span>Reset</span></button></div></div> <button class="delete-image-btn svelte-1h8xysy"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"></path></svg> Delete Image</button></div></div>'),Va=Ce('<div class="crop-mode-bar svelte-1h8xysy"><span>Crop Mode - Drag handles to adjust crop area</span> <div class="crop-mode-buttons svelte-1h8xysy"><button class="crop-btn done svelte-1h8xysy">Done</button> <button class="crop-btn reset svelte-1h8xysy">Reset</button> <button class="crop-btn cancel svelte-1h8xysy">Cancel</button></div></div>'),Ua=Ce('<div class="editor-wrapper svelte-1h8xysy"><!> <canvas class="measure-canvas svelte-1h8xysy"></canvas>  <textarea class="hidden-input svelte-1h8xysy" autocomplete="off"></textarea> <div class="editor-container svelte-1h8xysy"><div class="canvas-container svelte-1h8xysy"></div></div> <div class="page-indicator svelte-1h8xysy"> </div> <!> <!> <!></div>');function Xa(t,n){sr(n,!0);const i=()=>Re(Es,"$fontSizeStore",C),l=()=>Re(Ar,"$fontFamilyStore",C),o=()=>Re(Or,"$lineHeightStore",C),a=()=>Re(qr,"$letterSpacingStore",C),p=()=>Re(Rr,"$paragraphSpacingStore",C),h=()=>Re(Tt,"$pageConfig",C),u=()=>Re(er,"$zoomLevel",C),b=()=>Re(mi,"$currentPage",C),[C,D]=Jr();let H,I,$,V,d=W(st([""])),m=W(st([xt()])),A=W(st([])),ce=new Map,we=W(!1),he=W(""),Ae=W(!1),y=W(0),R=W(0),X=W(null),j=W(null);const ge=Fa(100),{schedulePush:ii,cancelPush:Li,flushPush:dr}=Da(ge,500);let Pi=W(!1),ri=W(!1);function Pn(){return{paragraphs:[...e(d)],paragraphMeta:e(m).map(r=>({...r})),images:e(A).map(r=>({...r})),cursorPara:e(y),cursorOffset:e(R),selectionStart:e(X)?{...e(X)}:null,selectionEnd:e(j)?{...e(j)}:null}}function Hn(r){f(d,[...r.paragraphs],!0),f(m,r.paragraphMeta.map(s=>({...s})),!0),f(A,r.images.map(s=>({...s})),!0),f(y,r.cursorPara,!0),f(R,r.cursorOffset,!0),f(X,r.selectionStart?{...r.selectionStart}:null,!0),f(j,r.selectionEnd?{...r.selectionEnd}:null,!0),Z(),fe()}function Ke(){dr(),ge.push(Pn()),Kt()}function hr(){ii(Pn()),Kt()}function Kt(){f(Pi,ge.canUndo(),!0),f(ri,ge.canRedo(),!0)}function Hi(){Li();const r=ge.undo();r&&(Hn(r),Kt())}function Zt(){Li();const r=ge.redo();r&&(Hn(r),Kt())}function li(){const r={version:1,savedAt:new Date().toISOString(),paragraphs:e(d),paragraphMeta:e(m),images:e(A).map(v=>({...v}))},s=JSON.stringify(r,null,2),c=new Blob([s],{type:"application/json"}),_=URL.createObjectURL(c),g=document.createElement("a");g.href=_,g.download=`document-${new Date().toISOString().slice(0,10)}.json`,document.body.appendChild(g),g.click(),document.body.removeChild(g),URL.revokeObjectURL(_)}let An=ye(i),vt=ye(l),Ai=ye(o),On=ye(a),si=ye(p),Te=W(!1),Ze=W(!1),qn=W(!1),pt=W(!1),oi=ye(()=>Qr(h())),Xe=ye(()=>el(h())),Jt=ye(()=>e(oi).height*u()/100),dn=ye(()=>e(oi).width*u()/100),ai=ye(()=>e(Xe).height*u()/100),Qt=ye(()=>e(Xe).width*u()/100),$e=ye(()=>ht(h().margins.top)*u()/100),se=ye(()=>ht(h().margins.left)*u()/100),Ot=ye(()=>h().columns||1),gt=ye(()=>ht(h().columnGap||10)*u()/100),xe=ye(()=>Ms(h())*u()/100),Ie=ye(()=>e(An)*u()/100),Me=ye(()=>e(Ie)*e(Ai)),Rn=ye(()=>Math.floor(e(ai)/e(Me))),qt=ye(()=>e(Rn)*e(Ot)),U=W(null),Ct=W(!1),hn=W(st({x:0,y:0})),Rt=W(!1),Ft=W(null),Oi=W(0),ci=W(0),_t=W(0),ui=W(0),je=W(!1),bt=W(null),fi=W(0),di=W(0),Oe=W(st({top:0,right:0,bottom:0,left:0})),en=W(st({top:0,right:0,bottom:0,left:0})),yt=W(!1),qi=W(0),Ri=W(0),tn=W(0),vn=W(0),Fn=W(st([])),ee=W(st([])),pn=ye(()=>Math.max(1,Math.ceil(e(ee).length/e(qt)))),Dt=[];function It(r){switch(r){case"nw":case"se":return"nwse-resize";case"ne":case"sw":return"nesw-resize";case"n":case"s":return"ns-resize";case"e":case"w":return"ew-resize";default:return"default"}}let hi=ye(()=>e(Rt)&&e(Ft)?It(e(Ft)):e(je)&&e(bt)?It(e(bt)):e(yt)?"move":e(U)?"default":"text"),gn=!1,nn=null;function Dn(){gn||(gn=!0,nn=requestAnimationFrame(()=>{gn=!1,nn=null,Bi()}))}const Mt=new Map,Fi=2e3;let $n=0;function vr(r,s){const c=s?.fontSize??e(An),_=s?.blockType??"p";return`${r}|${c}|${_}|${e(vt)}|${e(Te)}|${e(Ze)}|${u()}|${e(On)}`}function pr(){if(Mt.size<=Fi)return;const r=Array.from(Mt.entries());r.sort((c,_)=>c[1].lastAccess-_[1].lastAccess);const s=Math.floor(r.length*.25);for(let c=0;c<s;c++)Mt.delete(r[c][0])}function Di(){Mt.clear(),$n=0}let vi=W(0),B=W(2);const K=1;function ue(){if(!I)return;const r=I.scrollTop,s=I.clientHeight,c=e(Jt)+20,_=Math.floor(r/c),g=Math.ceil((r+s)/c),v=Math.max(0,_-K),z=Math.min(e(pn),g+K);(v!==e(vi)||z!==e(B))&&(f(vi,v,!0),f(B,z,!0),Dn())}let Fe=new Set,_e=!0;function at(){_e=!0,Fe.clear()}function Je(){return`${e(Ze)?"italic ":""}${e(Te)?"bold ":""}${e(Ie)}px ${e(vt)}`}function it(r,s){const c=vr(r,s),_=Mt.get(c);if(_!==void 0)return _.lastAccess=++$n,_.width;if(!V)return r.length*e(Ie)*.5;const g=V.getContext("2d");if(!g)return r.length*e(Ie)*.5;let v=e(Ie),z=e(Te)?"bold ":"",w=e(Ze)?"italic ":"";if(s){const O=s.fontSize?s.fontSize*u()/100:e(Ie);switch(s.blockType){case"h1":v=O*2,z="bold ";break;case"h2":v=O*1.5,z="bold ";break;case"h3":v=O*1.17,z="bold ";break;case"h4":v=O,z="bold ";break;case"blockquote":v=O,w="italic ";break;default:v=O}}g.font=`${w}${z}${v}px ${e(vt)}`;const x=g.measureText(r).width,M=e(On)*u()/100,E=x+(r.length>0?(r.length-1)*M:0);return Mt.set(c,{width:E,lastAccess:++$n}),pr(),E}function Ee(r,s,c,_){const g=e(m)[r]||xt(),v=g.fontSize?g.fontSize*u()/100:e(Ie);let z=v;switch(g.blockType){case"h1":z=v*2;break;case"h2":z=v*1.5;break;case"h3":z=v*1.17;break}const w=g.listType!=="none"?z*1.5:0,x=_?_.width+10:0,E=(e(xe)>0?e(xe):e(Qt)>0?e(Qt):500)-w-x;if(!s)return[{paraIndex:r,startOffset:0,endOffset:0,text:"",meta:g,listNumber:c,floatReduction:_}];const O=[];let L=0;for(;L<s.length;){const N=s.substring(L);if(it(N,g)<=E){O.push({paraIndex:r,startOffset:L,endOffset:s.length,text:N,meta:g,listNumber:O.length===0?c:void 0,floatReduction:_});break}let G=L,S=L;for(let q=L+1;q<=s.length;q++){const P=s.substring(L,q),T=it(P,g);if(q>L&&s[q-1]===" "&&(S=q),T>E){S>L?G=S:G=Math.max(L+1,q-1);break}G=q}for(G<=L&&(G=L+1),O.push({paraIndex:r,startOffset:L,endOffset:G,text:s.substring(L,G),meta:g,listNumber:O.length===0?c:void 0,floatReduction:_}),L=G;L<s.length&&s[L]===" ";)L++}return O}function Z(){const r=[],s=[];let c=0;const _=E=>E==="square"||E==="tight"||E==="through";for(let E=0;E<e(d).length;E++){const O=e(d)[E];if(O.startsWith(Xn)){const L=O.substring(1),N=e(A).find(G=>G.id===L);if(N&&_(N.wrapStyle)){const G=N.width*u()/100,S=N.height*u()/100,q=Math.ceil(S/e(Me));if(N.y!==void 0){const P=e(An)*e(Ai),T=Math.floor(N.y/P);let ne;if(N.horizontalAlign==="right")ne="right";else if(N.horizontalAlign==="center"){const Q=e(Xe).width/2;ne=(N.x??0)+N.width/2<Q?"left":"right"}else ne="left";s.push({id:L,startLine:T,endLine:T+q,width:G,side:ne})}}}}for(let E=0;E<e(d).length;E++){const O=e(m)[E]||xt(),L=e(d)[E];if(L===Rl){r.push({paraIndex:E,startOffset:0,endOffset:1,text:"",meta:O,isPageBreak:!0});continue}if(L.startsWith(Xn)){const P=L.substring(1),T=e(A).find(ne=>ne.id===P);if(T){const ne=T.width*u()/100,Q=T.height*u()/100,ie=Math.ceil(Q/e(Me));if(_(T.wrapStyle)){if(T.y===void 0){const Y=r.length;if(!s.find(be=>be.id===P)){let be;if(T.horizontalAlign==="right")be="right";else if(T.horizontalAlign==="center"){const Pe=e(Xe).width/2;be=(T.x??0)+T.width/2<Pe?"left":"right"}else be="left";s.push({id:P,startLine:Y,endLine:Y+ie,width:ne,side:be})}}r.push({paraIndex:E,startOffset:0,endOffset:L.length,text:"",meta:O,isImage:!0,imageId:P,imageHeight:ie})}else if(T.wrapStyle==="inline"){r.push({paraIndex:E,startOffset:0,endOffset:L.length,text:"",meta:O,isImage:!0,imageId:P,imageHeight:ie});for(let Y=1;Y<ie;Y++)r.push({paraIndex:E,startOffset:0,endOffset:L.length,text:"",meta:O,isImage:!0,imageId:P,imageHeight:0})}else if(T.wrapStyle==="top-bottom"){r.push({paraIndex:E,startOffset:0,endOffset:L.length,text:"",meta:O,isImage:!0,imageId:P,imageHeight:ie});for(let Y=1;Y<ie;Y++)r.push({paraIndex:E,startOffset:0,endOffset:L.length,text:"",meta:O,isImage:!0,imageId:P,imageHeight:0})}else if(T.wrapStyle==="behind"||T.wrapStyle==="in-front")r.push({paraIndex:E,startOffset:0,endOffset:L.length,text:"",meta:O,isImage:!0,imageId:P,imageHeight:0});else{r.push({paraIndex:E,startOffset:0,endOffset:L.length,text:"",meta:O,isImage:!0,imageId:P,imageHeight:ie});for(let Y=1;Y<ie;Y++)r.push({paraIndex:E,startOffset:0,endOffset:L.length,text:"",meta:O,isImage:!0,imageId:P})}}continue}let N;O.listType==="numbered"?(c++,N=c):(O.listType==="bullet"&&(N=void 0),c=0);const G=r.length;let S;for(const P of s)if(G>=P.startLine&&G<P.endLine){S={side:P.side,width:P.width};break}const q=Ee(E,L,N,S);for(let P=0;P<q.length;P++){const T=r.length;let ne;for(const Q of s)if(T>=Q.startLine&&T<Q.endLine){ne={side:Q.side,width:Q.width};break}q[P].floatReduction=ne,P===q.length-1&&(q[P].isLastLineOfParagraph=!0),r.push(q[P])}}const g=e(si)*u()/100;let v=0,z=0,w=0;const x=e(ai);for(let E=0;E<r.length;E++){const O=r[E];if(O.isPageBreak){O.pageIndex=z,O.yPosition=v,O.columnIndex=w,z++,w=0,v=0;continue}let L=e(Me);O.isImage&&O.imageHeight&&(L=O.imageHeight*e(Me));const N=O.isLastLineOfParagraph?g:0;v+L>x&&(e(Ot)>1&&w<e(Ot)-1?(w++,v=0):(z++,w=0,v=0)),O.pageIndex=z,O.yPosition=v,O.columnIndex=w,v+=L+N}f(Fn,s,!0),f(ee,r,!0);const M=r.reduce((E,O)=>Math.max(E,O.pageIndex??0),0);Ts.set(M+1),me()}function me(){const r=[];for(let s=0;s<e(d).length;s++){const _=(e(m)[s]||xt()).blockType;if(_.startsWith("h")){const g=parseInt(_[1]);g>=1&&g<=4&&r.push({id:`heading-${s}`,text:e(d)[s],level:g,paraIndex:s})}}zs.set(r)}function ke(r,s){for(let _=0;_<e(ee).length;_++){const g=e(ee)[_];if(g.paraIndex===r&&s>=g.startOffset&&s<=g.endOffset)return{line:_,col:s-g.startOffset}}const c=e(ee).length-1;return{line:c,col:e(ee)[c]?.text.length||0}}function Qe(r,s){if(r<0||r>=e(ee).length)return{para:e(d).length-1,offset:e(d)[e(d).length-1].length};const c=e(ee)[r];return{para:c.paraIndex,offset:c.startOffset+Math.min(s,c.text.length)}}function _n(r){if(r<0||r>=e(d).length)return;f(y,r,!0),f(R,0),f(X,null),f(j,null);const s=ke(e(y),e(R)),c=Math.floor(s.line/e(qt))+1;mi.set(c),Bn(),$?.focus(),fe()}Cs(()=>{$?.focus(),requestAnimationFrame(()=>{Z(),fe(),ge.push(Pn()),Kt()});const r=g=>{!H?.contains(document.activeElement)&&document.activeElement!==$||il(g)},s=g=>{e(Rt)?As(g.clientX,g.clientY):e(je)&&e(bt)?Ds(g.clientX,g.clientY):e(yt)&&Ns(g.clientX,g.clientY)},c=()=>{e(Rt)&&Os(),e(bt)&&$s(),e(yt)&&Ws()};document.addEventListener("paste",r),document.addEventListener("mousemove",s),document.addEventListener("mouseup",c);const _=()=>{ue()};return I&&I.addEventListener("scroll",_,{passive:!0}),ue(),()=>{document.removeEventListener("paste",r),document.removeEventListener("mousemove",s),document.removeEventListener("mouseup",c),I&&I.removeEventListener("scroll",_),nn!==null&&cancelAnimationFrame(nn)}}),Ji(()=>{e(d)&&u()&&h()&&e(Qt)>0&&(Di(),Z())}),Ji(()=>{e(ee).length>0&&e(y)!==void 0&&fe()}),Ji(()=>{e(vt),e(An),e(Te),e(Ze),e(On),Di()});function $t(r,s,c,_,g,v){const z=s.width*u()/100,w=s.cropTop||0,x=s.cropRight||0,M=s.cropBottom||0,E=s.cropLeft||0,O=E/100*c.naturalWidth,L=w/100*c.naturalHeight,N=(100-E-x)/100*c.naturalWidth,G=(100-w-M)/100*c.naturalHeight,S=N/G,q=z,P=z/S;if(s.wrapStyle==="behind"&&(r.globalAlpha=.5),r.drawImage(c,O,L,N,G,_,g,q,P),r.globalAlpha=1,e(U)===s.id){r.strokeStyle=e(yt)?"#4caf50":"#1a73e8",r.lineWidth=2,r.setLineDash([]),r.strokeRect(_-2,g-2,q+4,P+4);const T=8;r.fillStyle=e(je)?"#ff9800":e(yt)?"#4caf50":"#1a73e8",r.fillRect(_-T/2,g-T/2,T,T),r.fillRect(_+q-T/2,g-T/2,T,T),r.fillRect(_-T/2,g+P-T/2,T,T),r.fillRect(_+q-T/2,g+P-T/2,T,T),r.fillRect(_+q/2-T/2,g-T/2,T,T),r.fillRect(_+q/2-T/2,g+P-T/2,T,T),r.fillRect(_-T/2,g+P/2-T/2,T,T),r.fillRect(_+q-T/2,g+P/2-T/2,T,T),e(yt)&&(r.fillStyle="rgba(76, 175, 80, 0.2)",r.fillRect(_,g,q,P)),e(je)&&(r.strokeStyle="#ff9800",r.lineWidth=2,r.setLineDash([5,5]),r.strokeRect(_,g,q,P),r.setLineDash([]))}else r.strokeStyle="#e0e0e0",r.lineWidth=1,r.setLineDash([]),r.strokeRect(_,g,q,P)}function pi(r,s,c){const _=r.width*u()/100,g=r.wrapStyle==="inline";if(s.pageIndex!==c)return{x:0,y:0,visible:!1};if(!g&&r.x!==void 0&&r.y!==void 0){const E=e(Xe).height,O=Math.floor(r.y/E);if(O===c){const L=r.y-O*E,N=e(se)+r.x*u()/100,G=e($e)+L*u()/100;return{x:N,y:G,visible:!0}}return{x:0,y:0,visible:!1}}const v=e($e)+(s.yPosition??0),w=(s.columnIndex??0)*(e(xe)+e(gt));let x;if(g&&s.meta){const E=s.meta.align;x=E==="center"?"center":E==="right"?"right":"left"}else x=r.horizontalAlign||"left";let M;return x==="center"?M=e(se)+w+(e(xe)-_)/2:x==="right"?M=e(se)+w+e(xe)-_:M=e(se)+w,{x:M,y:v,visible:!0}}function fe(){at(),Dn()}function $i(r){const s=Dt[r];if(!s)return;const c=s.getContext("2d");if(!c)return;const _=window.devicePixelRatio||1;s.width=e(dn)*_,s.height=e(Jt)*_,s.style.width=`${e(dn)}px`,s.style.height=`${e(Jt)}px`,c.scale(_,_),c.fillStyle="white",c.fillRect(0,0,e(dn),e(Jt)),c.font=Je(),c.fillStyle="#202124",c.textBaseline="top";const g=e(ee).filter(x=>x.pageIndex===r),v=ke(e(y),e(R));let z=null,w=null;if(e(X)&&e(j)){const x=ke(e(X).para,e(X).offset),M=ke(e(j).para,e(j).offset);x.line<M.line||x.line===M.line&&x.col<=M.col?(z=x,w=M):(z=M,w=x)}for(const x of g){if(!x.isImage||!x.imageId||!x.imageHeight)continue;const M=e(A).find(L=>L.id===x.imageId);if(!M||M.wrapStyle!=="behind")continue;const E=ce.get(M.id);if(!E)continue;const O=pi(M,x,r);O.visible&&$t(c,M,E,O.x,O.y)}for(const x of e(Fn)){const M=e(A).find(S=>S.id===x.id);if(!M)continue;const E=ce.get(M.id);if(!E)continue;const O=M.width*u()/100;let L,N,G=!1;if(M.x!==void 0&&M.y!==void 0){const S=e(Xe).height,q=Math.floor(M.y/S);if(q===r){const P=M.y-q*S;L=e(se)+M.x*u()/100,N=e($e)+P*u()/100,G=!0}}else{const S=e(ee)[x.startLine];if(S&&S.pageIndex===r){N=e($e)+(S.yPosition??0);const P=(S.columnIndex??0)*(e(xe)+e(gt));L=x.side==="left"?e(se)+P:e(se)+P+e(xe)-O,G=!0}}G&&$t(c,M,E,L,N)}for(const x of g){if(!x.isImage||!x.imageId||!x.imageHeight)continue;const M=e(A).find(L=>L.id===x.imageId);if(!M||M.wrapStyle!=="inline"&&M.wrapStyle!=="top-bottom")continue;const E=ce.get(M.id);if(!E)continue;const O=pi(M,x,r);O.visible&&$t(c,M,E,O.x,O.y)}for(const x of g){if(x.isImage||x.isPageBreak)continue;const M=e($e)+(x.yPosition??0),O=(x.columnIndex??0)*(e(xe)+e(gt)),L=x.text,N=x.meta,G=e(ee).indexOf(x),S=N.listType!=="none"?e(Ie)*1.5:0,q=x.floatReduction&&x.floatReduction.side==="left"?x.floatReduction.width+10:0,P=e(se)+O+S+q,T=N.fontSize?N.fontSize*u()/100:e(Ie);let ne=T,Q=e(Te)?"bold ":"",ie=e(Ze)?"italic ":"";switch(N.blockType){case"h1":ne=T*2,Q="bold ";break;case"h2":ne=T*1.5,Q="bold ";break;case"h3":ne=T*1.17,Q="bold ";break;case"h4":Q="bold ";break;case"blockquote":ie="italic ";break}const Y=`${ie}${Q}${ne}px ${e(vt)}`;c.font=Y;const Le=c.measureText(L).width,be=x.floatReduction?x.floatReduction.width+10:0,Pe=e(xe)-S-be;let ve=P,Be=0;const qe=L.split(" "),le=x.endOffset>=e(d)[x.paraIndex].length;switch(N.align){case"center":ve=P+(Pe-Le)/2;break;case"right":ve=P+Pe-Le;break;case"justify":!le&&qe.length>1&&L.trim().length>0&&(Be=(Pe-Le)/(qe.length-1));break}if(z&&w&&G>=z.line&&G<=w.line){c.fillStyle="#b4d7ff";const te=G===z.line?z.col:0,de=G===w.line?w.col:L.length,rt=ve+c.measureText(L.substring(0,te)).width,He=c.measureText(L.substring(te,de)).width||5;c.fillRect(rt,M,He,e(Me))}if(x.startOffset===0&&N.listType!=="none")if(c.fillStyle="#202124",N.listType==="bullet"){const te=e(se)+O+e(Ie)*.5,de=M+e(Me)/2;c.beginPath(),c.arc(te,de,e(Ie)*.15,0,Math.PI*2),c.fill()}else N.listType==="numbered"&&x.listNumber&&(c.font=`${e(Ie)}px ${e(vt)}`,c.textAlign="right",c.fillText(`${x.listNumber}.`,e(se)+O+e(Ie)*1.2,M+(e(Me)-e(Ie))/2),c.textAlign="left",c.font=Y);N.blockType==="blockquote"&&x.startOffset===0&&(c.fillStyle="#ccc",c.fillRect(e(se)+O,M,3,e(Me))),c.fillStyle=N.textColor||"#202124",c.font=Y;const pe=M+(e(Me)-ne)/2,Ne=e(On)*u()/100,rn=(te,de)=>{if(Ne===0)return c.fillText(te,de,pe),c.measureText(te).width;{let rt=de;for(let He=0;He<te.length;He++)c.fillText(te[He],rt,pe),rt+=c.measureText(te[He]).width+Ne;return rt-de-Ne}};if(Be>0&&N.align==="justify"){let te=ve;for(let de=0;de<qe.length;de++)rn(qe[de],te),te+=c.measureText(qe[de]).width+qe[de].length*Ne,de<qe.length-1&&(te+=c.measureText(" ").width+Be)}else rn(L,ve);const mt=Be>0?Pe:Le;if(e(qn)&&L.length>0){const te=M+e(Me)-4;c.strokeStyle="#202124",c.lineWidth=1,c.beginPath(),c.moveTo(ve,te),c.lineTo(ve+mt,te),c.stroke()}if(e(pt)&&L.length>0){const te=M+e(Me)/2;c.strokeStyle="#202124",c.lineWidth=1,c.beginPath(),c.moveTo(ve,te),c.lineTo(ve+mt,te),c.stroke()}if(G===v.line&&!e(X)){let te=ve;if(Be>0&&N.align==="justify"){const de=L.substring(0,v.col),He=de.split(" ").length-1;te=ve+c.measureText(de).width+He*Be}else te=ve+c.measureText(L.substring(0,v.col)).width;c.fillStyle="#000",c.fillRect(te,M+2,2,e(Me)-4)}}for(const x of g){if(!x.isImage||!x.imageId||!x.imageHeight)continue;const M=e(A).find(L=>L.id===x.imageId);if(!M||M.wrapStyle!=="in-front")continue;const E=ce.get(M.id);if(!E)continue;const O=pi(M,x,r);O.visible&&$t(c,M,E,O.x,O.y)}c.fillStyle="#999",c.font=`10px ${e(vt)}`,c.textAlign="center",c.fillText(`${r+1}`,e(dn)/2,e(Jt)-20),c.textAlign="left"}function Bi(){const r=e(pn);for(let s=0;s<r;s++)!(s>=e(vi)&&s<e(B))&&!_e&&!Fe.has(s)||!_e&&!Fe.has(s)||$i(s);_e=!1,Fe.clear()}function Ni(r){const s=r.key;if(e(U)&&(s==="Delete"||s==="Backspace")){r.preventDefault(),ll();return}if(e(U)&&s!=="Delete"&&s!=="Backspace"&&(f(U,null),fe()),r.ctrlKey||r.metaKey){if(s==="Enter"){r.preventDefault(),gr();return}switch(s.toLowerCase()){case"b":r.preventDefault(),f(Te,!e(Te)),Z();return;case"i":r.preventDefault(),f(Ze,!e(Ze)),Z();return;case"a":r.preventDefault(),f(X,{para:0,offset:0},!0),f(j,{para:e(d).length-1,offset:e(d)[e(d).length-1].length},!0);return;case"c":case"x":if(e(X)&&e(j)){const v=gi();navigator.clipboard.writeText(v),s.toLowerCase()==="x"&&(Ke(),zt())}r.preventDefault();return;case"v":r.preventDefault(),Ke(),navigator.clipboard.readText().then(v=>{e(X)&&zt(),Wi(v)});return;case"z":r.preventDefault(),r.shiftKey?Zt():Hi();return;case"y":r.preventDefault(),Zt();return;case"s":r.preventDefault(),li();return}}const c=ke(e(y),e(R));switch(r.shiftKey&&["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Home","End"].includes(s)?e(X)||f(X,{para:e(y),offset:e(R)},!0):!r.shiftKey&&["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Home","End"].includes(s)&&(f(X,null),f(j,null)),s){case"ArrowLeft":r.preventDefault(),e(R)>0?sn(R,-1):e(y)>0&&(sn(y,-1),f(R,e(d)[e(y)].length,!0));break;case"ArrowRight":r.preventDefault(),e(R)<e(d)[e(y)].length?sn(R):e(y)<e(d).length-1&&(sn(y),f(R,0));break;case"ArrowUp":if(r.preventDefault(),c.line>0){const v=Qe(c.line-1,c.col);f(y,v.para,!0),f(R,v.offset,!0)}break;case"ArrowDown":if(r.preventDefault(),c.line<e(ee).length-1){const v=Qe(c.line+1,c.col);f(y,v.para,!0),f(R,v.offset,!0)}break;case"Home":r.preventDefault();{const v=e(ee)[c.line];f(R,v.startOffset,!0)}break;case"End":r.preventDefault();{const v=e(ee)[c.line];f(R,v.endOffset,!0)}break;case"Backspace":if(r.preventDefault(),Ke(),e(X)&&e(j))zt();else if(e(R)>0)e(d)[e(y)]=e(d)[e(y)].substring(0,e(R)-1)+e(d)[e(y)].substring(e(R)),sn(R,-1),Z();else if(e(y)>0)if(e(d)[e(y)-1].startsWith(Xn)){const v=e(d)[e(y)-1].substring(1);f(U,v,!0),fe()}else{const v=e(d)[e(y)-1].length;e(d)[e(y)-1]+=e(d)[e(y)],f(d,[...e(d).slice(0,e(y)),...e(d).slice(e(y)+1)],!0),f(m,[...e(m).slice(0,e(y)),...e(m).slice(e(y)+1)],!0),sn(y,-1),f(R,v,!0),Z()}break;case"Delete":if(r.preventDefault(),Ke(),e(X)&&e(j))zt();else if(e(R)<e(d)[e(y)].length)e(d)[e(y)]=e(d)[e(y)].substring(0,e(R))+e(d)[e(y)].substring(e(R)+1),Z();else if(e(y)<e(d).length-1)if(e(d)[e(y)+1].startsWith(Xn)){const v=e(d)[e(y)+1].substring(1);f(U,v,!0),fe()}else e(d)[e(y)]+=e(d)[e(y)+1],f(d,[...e(d).slice(0,e(y)+1),...e(d).slice(e(y)+2)],!0),f(m,[...e(m).slice(0,e(y)+1),...e(m).slice(e(y)+2)],!0),Z();break;case"Enter":r.preventDefault(),Ke(),e(X)&&e(j)&&zt();{const v=e(d)[e(y)].substring(0,e(R)),z=e(d)[e(y)].substring(e(R));e(d)[e(y)]=v,f(d,[...e(d).slice(0,e(y)+1),z,...e(d).slice(e(y)+1)],!0);const w=e(m)[e(y)]||xt(),x=w.blockType.startsWith("h")?"p":w.blockType;f(m,[...e(m).slice(0,e(y)+1),{...w,blockType:x},...e(m).slice(e(y)+1)],!0),sn(y),f(R,0),Z()}break;default:s.length===1&&(r.preventDefault(),e(X)&&e(j)&&(Ke(),zt()),Wi(s),hr())}r.shiftKey&&["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Home","End"].includes(s)&&f(j,{para:e(y),offset:e(R)},!0);const _=ke(e(y),e(R)),g=Math.floor(_.line/e(qt))+1;mi.set(g),Bn()}function Wi(r){const s=r.split(/\r?\n/);if(s.length===1)e(d)[e(y)]=e(d)[e(y)].substring(0,e(R))+r+e(d)[e(y)].substring(e(R)),f(R,e(R)+r.length);else{const c=e(d)[e(y)].substring(0,e(R)),_=e(d)[e(y)].substring(e(R)),g=e(m)[e(y)]||xt();e(d)[e(y)]=c+s[0];const v=s.slice(1,-1),z=s[s.length-1]+_;f(d,[...e(d).slice(0,e(y)+1),...v,z,...e(d).slice(e(y)+1)],!0);const w=s.slice(1).map(()=>({...g}));f(m,[...e(m).slice(0,e(y)+1),...w,...e(m).slice(e(y)+1)],!0),f(y,e(y)+(s.length-1)),f(R,s[s.length-1].length,!0)}Z()}function gr(){Ke(),e(X)&&e(j)&&zt();const r=e(d)[e(y)].substring(0,e(R)),s=e(d)[e(y)].substring(e(R));e(d)[e(y)]=r,f(d,[...e(d).slice(0,e(y)+1),Rl,s,...e(d).slice(e(y)+1)],!0);const c=e(m)[e(y)]||xt();f(m,[...e(m).slice(0,e(y)+1),{...xt()},{...c},...e(m).slice(e(y)+1)],!0),f(y,e(y)+2),f(R,0),Z(),fe()}function gi(){if(!e(X)||!e(j))return"";let r=e(X),s=e(j);if((r.para>s.para||r.para===s.para&&r.offset>s.offset)&&([r,s]=[s,r]),r.para===s.para)return e(d)[r.para].substring(r.offset,s.offset);let c=e(d)[r.para].substring(r.offset);for(let _=r.para+1;_<s.para;_++)c+=`
`+e(d)[_];return c+=`
`+e(d)[s.para].substring(0,s.offset),c}function zt(){if(!e(X)||!e(j))return;let r=e(X),s=e(j);if((r.para>s.para||r.para===s.para&&r.offset>s.offset)&&([r,s]=[s,r]),r.para===s.para)e(d)[r.para]=e(d)[r.para].substring(0,r.offset)+e(d)[r.para].substring(s.offset);else{const c=e(d)[r.para].substring(0,r.offset)+e(d)[s.para].substring(s.offset);f(d,[...e(d).slice(0,r.para),c,...e(d).slice(s.para+1)],!0),f(m,[...e(m).slice(0,r.para+1),...e(m).slice(s.para+1)],!0)}f(y,r.para,!0),f(R,r.offset,!0),f(X,null),f(j,null),Z()}function Bn(){const r=ke(e(y),e(R)),s=Math.floor(r.line/e(qt));I?.children[s]?.scrollIntoView({behavior:"smooth",block:"nearest"})}function Vi(r,s){const c=Dt[s];if(!c)return;const _=c.getBoundingClientRect(),g=r.clientX-_.left,v=r.clientY-_.top;if(e(U)&&!e(je)){const S=ji();if(S&&S.pageIndex===s){const q=cl(g,v,S);if(q){r.preventDefault(),Hs(q,r.clientX,r.clientY);return}if(g>=S.x&&g<=S.x+S.width&&v>=S.y&&v<=S.y+S.height){r.preventDefault(),Bs(r.clientX,r.clientY);return}}}if(e(U)&&e(je)){const S=ji();if(S&&S.pageIndex===s){const q=cl(g,v,S);if(q){r.preventDefault(),Fs(q,r.clientX,r.clientY);return}}}let z=0;e(Ot)>1&&g-e(se)>=e(xe)+e(gt)&&(z=1);const w=v-e($e),x=e(ee).filter(S=>S.pageIndex===s);let M=-1;for(const S of x){if(S.yPosition===void 0)continue;let q=e(Me);S.isImage&&S.imageHeight&&(q=S.imageHeight*e(Me));const P=S.yPosition,T=P+q;if(w>=P&&w<T){M=e(ee).indexOf(S);break}}M===-1&&w>=0&&x.length>0&&(M=e(ee).indexOf(x[x.length-1]));for(const S of e(Fn)){const q=e(A).find(P=>P.id===S.id);if(q){const P=q.width*u()/100,T=q.height*u()/100;let ne,Q,ie=!1;if(q.x!==void 0&&q.y!==void 0){const Y=e(Xe).height,Le=Math.floor(q.y/Y);if(Le===s){const be=q.y-Le*Y;ne=e(se)+q.x*u()/100,Q=e($e)+be*u()/100,ie=!0}}else{const Y=e(ee)[S.startLine];if(Y&&Y.pageIndex===s){Q=e($e)+(Y.yPosition??0);const be=(Y.columnIndex??0)*(e(xe)+e(gt));ne=S.side==="left"?e(se)+be:e(se)+be+e(xe)-P,ie=!0}}if(ie&&g>=ne&&g<=ne+P&&v>=Q&&v<=Q+T){f(U,q.id,!0),f(X,null),f(j,null),ol(r.clientX,r.clientY),$?.focus(),fe();return}}}if(M>=0&&M<e(ee).length){const S=e(ee)[M];if(S.isImage&&S.imageId){const q=e(A).find(T=>T.id===S.imageId);if(q&&(q.wrapStyle==="inline"||q.wrapStyle==="top-bottom"||q.wrapStyle==="behind"||q.wrapStyle==="in-front")){const T=q.width*u()/100,ne=q.height*u()/100;let Q;const ie=z*(e(xe)+e(gt));q.horizontalAlign==="center"?Q=e(se)+ie+(e(xe)-T)/2:q.horizontalAlign==="right"?Q=e(se)+ie+e(xe)-T:Q=e(se)+ie;let Y=M;for(;Y>0&&e(ee)[Y-1].imageId===S.imageId;)Y--;const Le=e(ee)[Y],be=e($e)+(Le.yPosition??0);if(g>=Q&&g<=Q+T&&v>=be&&v<=be+ne){f(U,q.id,!0),f(X,null),f(j,null),ol(r.clientX,r.clientY),$?.focus(),fe();return}}}}if(e(je)&&yr(),f(U,null),f(Ct,!1),M>=0&&M<e(ee).length){const S=e(ee)[M];if(S.isImage)f(y,S.paraIndex+1),f(R,0),e(y)>=e(d).length&&(f(y,e(d).length-1),f(R,e(d)[e(y)].length,!0));else{const q=z*(e(xe)+e(gt)),P=S.meta,T=P.listType!=="none"?e(Ie)*1.5:0,ne=S.floatReduction&&S.floatReduction.side==="left"?S.floatReduction.width+10:0,Q=e(se)+q+T+ne,ie=P.fontSize?P.fontSize*u()/100:e(Ie);let Y=ie;switch(P.blockType){case"h1":Y=ie*2;break;case"h2":Y=ie*1.5;break;case"h3":Y=ie*1.17;break}const Le=S.floatReduction?S.floatReduction.width+10:0,be=e(xe)-T-Le,Pe=V?.getContext("2d");if(Pe){const pe=["h1","h2","h3","h4"].includes(P.blockType)||e(Te)?"bold ":"",Ne=P.blockType==="blockquote"||e(Ze)?"italic ":"";Pe.font=`${Ne}${pe}${Y}px ${e(vt)}`}const ve=Pe?Pe.measureText(S.text).width:S.text.length*Y*.5;let Be=Q;P.align==="center"?Be=Q+(be-ve)/2:P.align==="right"&&(Be=Q+be-ve);let qe=0,le=Be;for(let pe=0;pe<=S.text.length;pe++){const Ne=pe<S.text.length&&Pe?Pe.measureText(S.text[pe]).width:0;if(le+Ne/2>=g){qe=pe;break}le+=Ne,qe=pe+1}qe=Math.min(qe,S.text.length),f(y,S.paraIndex,!0),f(R,S.startOffset+qe)}}else if(M<0){const S=x[0];S&&(f(y,S.paraIndex,!0),f(R,S.startOffset,!0))}else{const S=e(ee).length-1;if(S>=0){const q=e(ee)[S];f(y,q.paraIndex,!0),f(R,q.endOffset,!0)}}f(X,null),f(j,null);let E=!1;const O=e(y),L=e(R),N=S=>{E=!0,e(X)||f(X,{para:O,offset:L},!0);for(let q=0;q<Dt.length;q++){const P=Dt[q];if(!P)continue;const T=P.getBoundingClientRect();if(S.clientY>=T.top&&S.clientY<=T.bottom){const ne=S.clientX-T.left,Q=S.clientY-T.top;let ie=0;e(Ot)>1&&ne-e(se)>=e(xe)+e(gt)&&(ie=1);const Y=q*e(qt),Le=Math.min(Y+e(qt),e(ee).length),be=e(si)*u()/100,Pe=Q-e($e);let ve=-1,Be=0;for(let le=Y;le<Le;le++){const pe=le-Y;if((e(Ot)>1?Math.floor(pe/e(Rn)):0)!==ie){const rt=e(ee)[le];rt&&rt.isLastLineOfParagraph&&(Be+=be);continue}const mt=(e(Ot)>1?pe%e(Rn):pe)*e(Me)+Be,te=mt+e(Me);if(Pe>=mt&&Pe<te){ve=le;break}const de=e(ee)[le];de&&de.isLastLineOfParagraph&&(Be+=be)}ve===-1&&Pe>=0&&(ve=Le-1);const qe=ie*(e(xe)+e(gt));if(ve>=0&&ve<e(ee).length){const le=e(ee)[ve],pe=le.meta,Ne=pe.listType!=="none"?e(Ie)*1.5:0,rn=le.floatReduction&&le.floatReduction.side==="left"?le.floatReduction.width+10:0,mt=e(se)+qe+Ne+rn,te=pe.fontSize?pe.fontSize*u()/100:e(Ie);let de=te;switch(pe.blockType){case"h1":de=te*2;break;case"h2":de=te*1.5;break;case"h3":de=te*1.17;break}const rt=le.floatReduction?le.floatReduction.width+10:0,He=e(xe)-Ne-rt,Bt=V?.getContext("2d");if(Bt){const wt=["h1","h2","h3","h4"].includes(pe.blockType)||e(Te)?"bold ":"",wn=pe.blockType==="blockquote"||e(Ze)?"italic ":"";Bt.font=`${wn}${wt}${de}px ${e(vt)}`}const Yi=Bt?Bt.measureText(le.text).width:le.text.length*de*.5;let mn=mt;pe.align==="center"?mn=mt+(He-Yi)/2:pe.align==="right"&&(mn=mt+He-Yi);let ln=0,Nn=mn;for(let wt=0;wt<=le.text.length;wt++){const wn=wt<le.text.length&&Bt?Bt.measureText(le.text[wt]).width:0;if(Nn+wn/2>=ne){ln=wt;break}Nn+=wn,ln=wt+1}ln=Math.min(ln,le.text.length),f(y,le.paraIndex,!0),f(R,le.startOffset+ln),f(j,{para:e(y),offset:e(R)},!0)}break}}},G=()=>{window.removeEventListener("mousemove",N),window.removeEventListener("mouseup",G),(!E||e(X)&&e(j)&&e(X).para===e(j).para&&e(X).offset===e(j).offset)&&(f(X,null),f(j,null)),$?.focus(),fe()};window.addEventListener("mousemove",N),window.addEventListener("mouseup",G),mi.set(s+1),$?.focus(),fe()}function Ui(r,s){let c=e(y),_=e(y);switch(e(X)&&e(j)&&(c=Math.min(e(X).para,e(j).para),_=Math.max(e(X).para,e(j).para)),["justifyLeft","justifyCenter","justifyRight","justifyFull","insertUnorderedList","insertOrderedList","formatBlock","fontSize","foreColor"].includes(r)&&Ke(),r){case"bold":f(Te,!e(Te));break;case"italic":f(Ze,!e(Ze));break;case"underline":f(qn,!e(qn));break;case"strikeThrough":f(pt,!e(pt));break;case"justifyLeft":for(let v=c;v<=_;v++)e(m)[v]={...e(m)[v],align:"left"};break;case"justifyCenter":for(let v=c;v<=_;v++)e(m)[v]={...e(m)[v],align:"center"};break;case"justifyRight":for(let v=c;v<=_;v++)e(m)[v]={...e(m)[v],align:"right"};break;case"justifyFull":for(let v=c;v<=_;v++)e(m)[v]={...e(m)[v],align:"justify"};break;case"insertUnorderedList":for(let v=c;v<=_;v++){const z=e(m)[v].listType;e(m)[v]={...e(m)[v],listType:z==="bullet"?"none":"bullet"}}break;case"insertOrderedList":for(let v=c;v<=_;v++){const z=e(m)[v].listType;e(m)[v]={...e(m)[v],listType:z==="numbered"?"none":"numbered"}}break;case"formatBlock":if(s){const v=s;for(let z=c;z<=_;z++)e(m)[z]={...e(m)[z],blockType:v}}break;case"fontSize":if(s){const v=parseInt(s);for(let z=c;z<=_;z++)e(m)[z]={...e(m)[z],fontSize:v}}break;case"foreColor":if(s)for(let v=c;v<=_;v++)e(m)[v]={...e(m)[v],textColor:s};break;case"undo":Hi();return;case"redo":Zt();return;case"insertImage":f(we,!0);return}f(m,[...e(m)],!0),Z(),fe(),$?.focus()}function Xi(){return"img-"+Date.now()+"-"+Math.random().toString(36).substring(2,11)}function bn(r){return new Promise((s,c)=>{const _=new Image;_.crossOrigin="anonymous",_.onload=()=>s(_),_.onerror=c,_.src=r})}async function tl(r,s="inline"){try{Ke();const c=await bn(r),_=Xi(),g=e(Xe).width*.8*u()/100;let v=c.naturalWidth,z=c.naturalHeight;if(v>g){const L=g/v;v=g,z=z*L}const w={id:_,src:r,width:v,height:z,naturalWidth:c.naturalWidth,naturalHeight:c.naturalHeight,wrapStyle:s,positionMode:"move-with-text",horizontalAlign:"left",cropTop:0,cropRight:0,cropBottom:0,cropLeft:0};f(A,[...e(A),w],!0),ce.set(_,c);const x=e(d)[e(y)].substring(0,e(R)),M=e(d)[e(y)].substring(e(R));e(d)[e(y)]=x;const E=Xn+_;f(d,[...e(d).slice(0,e(y)+1),E,M,...e(d).slice(e(y)+1)],!0);const O=e(m)[e(y)]||xt();f(m,[...e(m).slice(0,e(y)+1),{...xt(),align:"center"},{...O},...e(m).slice(e(y)+1)],!0),f(y,e(y)+2),f(R,0),Z(),fe()}catch(c){console.error("Failed to load image:",c),alert("Failed to load image. Please check the URL.")}}function nl(){e(he).trim()&&(tl(e(he).trim()),f(he,""),f(we,!1),$?.focus())}function Ls(r){r.preventDefault(),f(Ae,!1);const s=r.dataTransfer?.files;s&&s.length>0&&_r(s[0])}function Ps(r){const s=r.target;s.files&&s.files.length>0&&_r(s.files[0])}function _r(r){if(!r.type.startsWith("image/")){alert("Please select an image file");return}const s=new FileReader;s.onload=c=>{const _=c.target?.result;tl(_),f(we,!1),$?.focus()},s.readAsDataURL(r)}function il(r){const s=r.clipboardData?.items;if(s){for(const c of s)if(c.type.startsWith("image/")){r.preventDefault();const _=c.getAsFile();_&&_r(_);return}}}function rl(){f(we,!1),f(he,""),f(Ae,!1),$?.focus()}function ll(){if(!e(U))return;Ke();const r=e(d).findIndex(s=>s===Xn+e(U));r!==-1&&(f(A,e(A).filter(s=>s.id!==e(U)),!0),ce.delete(e(U)),f(d,[...e(d).slice(0,r),...e(d).slice(r+1)],!0),f(m,[...e(m).slice(0,r),...e(m).slice(r+1)],!0),e(d).length===0&&(f(d,[""],!0),f(m,[xt()],!0)),e(y)>=e(d).length?(f(y,e(d).length-1),f(R,e(d)[e(y)].length,!0)):e(y)>r&&sn(y,-1),f(U,null),f(Ct,!1),Z(),fe())}function yn(r){if(!e(U))return;const s=e(A).findIndex(_=>_.id===e(U));if(s===-1)return;const c={...e(A)[s],wrapStyle:r};(c.positionMode==="move-with-text"||r==="inline")&&(c.x=void 0,c.y=void 0,c.pageIndex=void 0),e(A)[s]=c,f(A,[...e(A)],!0),Z(),fe()}function sl(r){if(!e(U))return;const s=e(A).findIndex(_=>_.id===e(U));if(s===-1)return;const c={...e(A)[s],positionMode:r};r==="move-with-text"&&(c.x=void 0,c.y=void 0,c.pageIndex=void 0),e(A)[s]=c,f(A,[...e(A)],!0),Z(),fe()}function br(r){if(!e(U))return;const s=e(A).findIndex(c=>c.id===e(U));s!==-1&&(e(A)[s]={...e(A)[s],horizontalAlign:r},f(A,[...e(A)],!0),Z(),fe())}function ol(r,s){f(hn,{x:r,y:s},!0),f(Ct,!0)}function al(){f(Ct,!1)}function ji(){if(!e(U))return null;const r=e(A).find(P=>P.id===e(U));if(!r)return null;const s=ce.get(r.id);if(!s)return null;const c=r.width*u()/100,_=r.cropTop||0,g=r.cropRight||0,v=r.cropBottom||0,w=(100-(r.cropLeft||0)-g)/100*s.naturalWidth,x=(100-_-v)/100*s.naturalHeight,M=w/x,E=c,O=c/M;if(r.x!==void 0&&r.y!==void 0){const P=e(Xe).height,T=Math.floor(r.y/P),ne=r.y-T*P,Q=e(se)+r.x*u()/100,ie=e($e)+ne*u()/100;return{x:Q,y:ie,width:E,height:O,pageIndex:T}}const L=e(ee).find(P=>P.imageId===e(U)&&P.isImage);if(!L||L.pageIndex===void 0)return null;const N=L.pageIndex,G=e(Fn).find(P=>P.id===e(U));let S;G?S=G.side==="left"?e(se):e(se)+e(Qt)-E:S=e(se)+(e(Qt)-E)/2;const q=e($e)+(L.yPosition??0);return{x:S,y:q,width:E,height:O,pageIndex:N}}function cl(r,s,c){const{x:g,y:v,width:z,height:w}=c;if(r>=g-10&&r<=g+10&&s>=v-10&&s<=v+10)return"nw";if(r>=g+z-10&&r<=g+z+10&&s>=v-10&&s<=v+10)return"ne";if(r>=g-10&&r<=g+10&&s>=v+w-10&&s<=v+w+10)return"sw";if(r>=g+z-10&&r<=g+z+10&&s>=v+w-10&&s<=v+w+10)return"se";const x=g+z/2,M=v+w/2;return r>=x-10&&r<=x+10&&s>=v-10&&s<=v+10?"n":r>=x-10&&r<=x+10&&s>=v+w-10&&s<=v+w+10?"s":r>=g-10&&r<=g+10&&s>=M-10&&s<=M+10?"w":r>=g+z-10&&r<=g+z+10&&s>=M-10&&s<=M+10?"e":null}function Hs(r,s,c){if(!e(U)||!r)return;const _=e(A).find(g=>g.id===e(U));_&&(f(Rt,!0),f(Ft,r,!0),f(Oi,s,!0),f(ci,c,!0),f(_t,_.width,!0),f(ui,_.height,!0),f(Ct,!1))}function As(r,s){if(!e(Rt)||!e(U)||!e(Ft))return;const c=e(A).findIndex(E=>E.id===e(U));if(c===-1)return;const _=e(A)[c],g=_.naturalWidth/_.naturalHeight,v=(r-e(Oi))*(100/u()),z=(s-e(ci))*(100/u());let w=e(_t),x=e(ui);switch(e(Ft)){case"se":w=Math.max(50,e(_t)+v),x=w/g;break;case"sw":w=Math.max(50,e(_t)-v),x=w/g;break;case"ne":w=Math.max(50,e(_t)+v),x=w/g;break;case"nw":w=Math.max(50,e(_t)-v),x=w/g;break;case"e":w=Math.max(50,e(_t)+v),x=w/g;break;case"w":w=Math.max(50,e(_t)-v),x=w/g;break;case"n":case"s":x=Math.max(50,e(ui)+(e(Ft)==="s"?z:-z)),w=x*g;break}const M=e(Xe).width*.95;w>M&&(w=M,x=w/g),e(A)[c]={..._,width:w,height:x},f(A,[...e(A)],!0),Z(),fe()}function Os(){f(Rt,!1),f(Ft,null)}function qs(){if(!e(U))return;const r=e(A).find(s=>s.id===e(U));r&&f(en,{top:r.cropTop||0,right:r.cropRight||0,bottom:r.cropBottom||0,left:r.cropLeft||0},!0),f(je,!0),f(Ct,!1),fe()}function yr(){f(je,!1),f(bt,null),fe()}function Rs(){if(!e(U))return;const r=e(A).findIndex(s=>s.id===e(U));r!==-1&&(e(A)[r]={...e(A)[r],cropTop:e(en).top,cropRight:e(en).right,cropBottom:e(en).bottom,cropLeft:e(en).left},f(A,[...e(A)],!0)),yr()}function Fs(r,s,c){if(!e(U)||!r)return;const _=e(A).find(g=>g.id===e(U));_&&(f(bt,r,!0),f(fi,s,!0),f(di,c,!0),f(Oe,{top:_.cropTop||0,right:_.cropRight||0,bottom:_.cropBottom||0,left:_.cropLeft||0},!0))}function Ds(r,s){if(!e(je)||!e(U)||!e(bt))return;const c=e(A).findIndex(x=>x.id===e(U));if(c===-1)return;const _=e(A)[c],g=ji();if(!g)return;const v=(r-e(fi))/g.width*100,z=(s-e(di))/g.height*100;let w={...e(Oe)};switch(e(bt)){case"n":w.top=Math.max(0,Math.min(100-w.bottom-10,e(Oe).top+z));break;case"s":w.bottom=Math.max(0,Math.min(100-w.top-10,e(Oe).bottom-z));break;case"w":w.left=Math.max(0,Math.min(100-w.right-10,e(Oe).left+v));break;case"e":w.right=Math.max(0,Math.min(100-w.left-10,e(Oe).right-v));break;case"nw":w.top=Math.max(0,Math.min(100-w.bottom-10,e(Oe).top+z)),w.left=Math.max(0,Math.min(100-w.right-10,e(Oe).left+v));break;case"ne":w.top=Math.max(0,Math.min(100-w.bottom-10,e(Oe).top+z)),w.right=Math.max(0,Math.min(100-w.left-10,e(Oe).right-v));break;case"sw":w.bottom=Math.max(0,Math.min(100-w.top-10,e(Oe).bottom-z)),w.left=Math.max(0,Math.min(100-w.right-10,e(Oe).left+v));break;case"se":w.bottom=Math.max(0,Math.min(100-w.top-10,e(Oe).bottom-z)),w.right=Math.max(0,Math.min(100-w.left-10,e(Oe).right-v));break}e(A)[c]={..._,cropTop:w.top,cropRight:w.right,cropBottom:w.bottom,cropLeft:w.left},f(A,[...e(A)],!0),fe()}function $s(){f(bt,null)}function ul(){if(!e(U))return;const r=e(A).findIndex(s=>s.id===e(U));r!==-1&&(e(A)[r]={...e(A)[r],cropTop:0,cropRight:0,cropBottom:0,cropLeft:0},f(A,[...e(A)],!0),fe())}function Bs(r,s,c){if(!e(U))return;const _=e(A).find(g=>g.id===e(U));if(_&&_.wrapStyle!=="inline"){if(f(yt,!0),f(qi,r,!0),f(Ri,s,!0),_.x===void 0||_.y===void 0){const g=ji();g?(f(tn,(g.x-e(se))*(100/u())),f(vn,g.pageIndex*e(Xe).height+(g.y-e($e))*(100/u()))):(f(tn,0),f(vn,0))}else f(tn,_.x,!0),f(vn,_.y,!0);f(Ct,!1)}}function Ns(r,s){if(!e(yt)||!e(U))return;const c=e(A).findIndex(L=>L.id===e(U));if(c===-1)return;const _=e(A)[c],g=(r-e(qi))*(100/u()),v=(s-e(Ri))*(100/u());let z=e(tn)+g,w=e(vn)+v;const x=e(Xe).width-_.width;z=Math.max(0,Math.min(x,z));const M=e(Xe).height,E=Math.max(0,w),O=Math.floor(E/M);e(A)[c]={..._,x:z,y:E,pageIndex:O},f(A,[...e(A)],!0),Z(),fe()}function Ws(){f(yt,!1)}let Vs=ye(()=>Array.from({length:e(pn)},(r,s)=>s));var Us={navigateToParagraph:_n},fl=Ua(),dl=F(fl);qa(dl,{onFormat:Ui,get canUndo(){return e(Pi)},get canRedo(){return e(ri)},onSave:li});var hl=k(dl,2);jn(hl,r=>V=r,()=>V);var _i=k(hl,2);_i.__keydown=Ni,ks(_i,"spellcheck",!1),jn(_i,r=>$=r,()=>$);var mr=k(_i,2),vl=F(mr);an(vl,20,()=>e(Vs),r=>r,(r,s)=>{var c=$a();let _;c.__mousedown=g=>Vi(g,s),jn(c,(g,v)=>Dt[v]=g,g=>Dt?.[g],()=>[s]),Ye(()=>{_=J(c,1,"page-canvas svelte-1h8xysy",null,_,{active:b()===s+1}),Lr(c,`cursor: ${e(hi)??""};`)}),Se(r,c)}),jn(vl,r=>I=r,()=>I),jn(mr,r=>H=r,()=>H);var pl=k(mr,2),Xs=F(pl),gl=k(pl,2);{var js=r=>{var s=Ba();s.__click=rl;var c=F(s);c.__click=N=>N.stopPropagation();var _=F(c),g=k(F(_),2);g.__click=rl;var v=k(_,2),z=F(v),w=k(F(z),2),x=F(w);x.__keydown=N=>N.key==="Enter"&&nl();var M=k(x,2);M.__click=nl;var E=k(z,4);let O;E.__click=()=>document.getElementById("file-input")?.click();var L=k(E,2);L.__change=Ps,Ye(()=>O=J(E,1,"drop-zone svelte-1h8xysy",null,O,{"drag-over":e(Ae)})),_a(x,()=>e(he),N=>f(he,N)),Ki("dragover",E,N=>{N.preventDefault(),f(Ae,!0)}),Ki("dragleave",E,()=>f(Ae,!1)),Ki("drop",E,Ls),Se(r,s)};Pt(gl,r=>{e(we)&&r(js)})}var _l=k(gl,2);{var Ys=r=>{const s=ye(()=>e(A).find(He=>He.id===e(U)));var c=Wa();c.__click=al;var _=F(c);_.__click=He=>He.stopPropagation();var g=F(_),v=k(F(g),2);v.__click=al;var z=k(g,2),w=k(F(z),2),x=F(w);let M;x.__click=()=>yn("inline");var E=k(z,2),O=k(F(E),2),L=F(O);let N;L.__click=()=>yn("square");var G=k(L,2);let S;G.__click=()=>yn("tight");var q=k(G,2);let P;q.__click=()=>yn("through");var T=k(q,2);let ne;T.__click=()=>yn("top-bottom");var Q=k(T,2);let ie;Q.__click=()=>yn("behind");var Y=k(Q,2);let Le;Y.__click=()=>yn("in-front");var be=k(E,2);{var Pe=He=>{var Bt=Na(),Yi=k(F(Bt),2),mn=F(Yi);let ln;mn.__click=()=>br("left");var Nn=k(mn,2);let wt;Nn.__click=()=>br("center");var wn=k(Nn,2);let bl;wn.__click=()=>br("right"),Ye(()=>{ln=J(mn,1,"layout-btn small svelte-1h8xysy",null,ln,{active:e(s)?.horizontalAlign==="left"}),wt=J(Nn,1,"layout-btn small svelte-1h8xysy",null,wt,{active:e(s)?.horizontalAlign==="center"}),bl=J(wn,1,"layout-btn small svelte-1h8xysy",null,bl,{active:e(s)?.horizontalAlign==="right"})}),Se(He,Bt)};Pt(be,He=>{e(s)?.wrapStyle!=="inline"&&He(Pe)})}var ve=k(be,2),Be=k(F(ve),2),qe=F(Be),le=F(qe);le.__change=()=>sl("move-with-text");var pe=k(qe,2),Ne=F(pe);Ne.__change=()=>sl("fixed-position");var rn=k(ve,2),mt=k(F(rn),2),te=F(mt);te.__click=qs;var de=k(te,2);de.__click=ul;var rt=k(rn,2);rt.__click=ll,Ye(()=>{Lr(_,`left: ${e(hn).x??""}px; top: ${e(hn).y??""}px;`),M=J(x,1,"layout-btn svelte-1h8xysy",null,M,{active:e(s)?.wrapStyle==="inline"}),N=J(L,1,"layout-btn svelte-1h8xysy",null,N,{active:e(s)?.wrapStyle==="square"}),S=J(G,1,"layout-btn svelte-1h8xysy",null,S,{active:e(s)?.wrapStyle==="tight"}),P=J(q,1,"layout-btn svelte-1h8xysy",null,P,{active:e(s)?.wrapStyle==="through"}),ne=J(T,1,"layout-btn svelte-1h8xysy",null,ne,{active:e(s)?.wrapStyle==="top-bottom"}),ie=J(Q,1,"layout-btn svelte-1h8xysy",null,ie,{active:e(s)?.wrapStyle==="behind"}),Le=J(Y,1,"layout-btn svelte-1h8xysy",null,Le,{active:e(s)?.wrapStyle==="in-front"}),Ll(le,e(s)?.positionMode==="move-with-text"),Ll(Ne,e(s)?.positionMode==="fixed-position")}),Se(r,c)};Pt(_l,r=>{e(Ct)&&e(U)&&!e(je)&&r(Ys)})}var Gs=k(_l,2);{var Ks=r=>{var s=Va(),c=k(F(s),2),_=F(c);_.__click=yr;var g=k(_,2);g.__click=ul;var v=k(g,2);v.__click=Rs,Se(r,s)};Pt(Gs,r=>{e(je)&&e(U)&&r(Ks)})}Ye(()=>Wt(Xs,`Page ${b()??""} of ${e(pn)??""}`)),Ki("paste",_i,il),Se(t,fl);var Zs=or(Us);return D(),Zs}Gr(["keydown","mousedown","click","change"]);var ja=Ce('<ul class="heading-list nested svelte-1nhzsi7"></ul>'),Ya=Ce('<li><button class="heading-link svelte-1nhzsi7"> </button> <!></li>'),Ga=Ce('<p class="empty-message svelte-1nhzsi7">No headings yet</p>'),Ka=Ce('<ul class="heading-list svelte-1nhzsi7"></ul>'),Za=Ce('<aside class="sidebar svelte-1nhzsi7"><div class="sidebar-header svelte-1nhzsi7"><h3 class="svelte-1nhzsi7">Document Outline</h3></div> <nav class="sidebar-nav svelte-1nhzsi7"><!></nav></aside>');function Ja(t,n){sr(n,!0);const i=()=>Re(zs,"$headings",l),[l,o]=Jr(),a=(I,$=Ut)=>{var V=Ya(),d=F(V);d.__click=()=>n.onNavigate($().paraIndex);var m=F(d),A=k(d,2);{var ce=we=>{var he=ja();an(he,21,()=>$().children,xn,(Ae,y)=>{a(Ae,()=>e(y))}),Se(we,he)};Pt(A,we=>{$().children.length>0&&we(ce)})}Ye(()=>{J(V,1,`heading-item level-${$().level??""}`,"svelte-1nhzsi7"),ks(d,"title",$().text),Wt(m,$().text||"(Empty heading)")}),Se(I,V)};function p(I){const $=[],V=[];for(const d of I){const m={...d,children:[]};for(;V.length>0&&V[V.length-1].level>=d.level;)V.pop();V.length===0?$.push(m):V[V.length-1].children.push(m),V.push(m)}return $}let h=ye(()=>p(i()));var u=Za(),b=k(F(u),2),C=F(b);{var D=I=>{var $=Ga();Se(I,$)},H=I=>{var $=Ka();an($,21,()=>e(h),xn,(V,d)=>{a(V,()=>e(d))}),Se(I,$)};Pt(C,I=>{e(h).length===0?I(D):I(H,!1)})}Se(t,u),or(),o()}Gr(["click"]);var Qa=Ce('<main class="svelte-1n46o8q"><div class="app-layout svelte-1n46o8q"><!> <div class="editor-wrapper svelte-1n46o8q"><!></div></div></main>');function ec(t){let n=Ur();function i(u){e(n)?.navigateToParagraph(u)}var l=Qa(),o=F(l),a=F(o);Ja(a,{onNavigate:i});var p=k(a,2),h=F(p);jn(Xa(h,{$$legacy:!0}),u=>f(n,u),()=>e(n)),Se(t,l)}la(ec,{target:document.getElementById("app")});
