(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))i(l);new MutationObserver(l=>{for(const s of l)if(s.type==="childList")for(const v of s.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&i(v)}).observe(document,{childList:!0,subtree:!0});function r(l){const s={};return l.integrity&&(s.integrity=l.integrity),l.referrerPolicy&&(s.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?s.credentials="include":l.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(l){if(l.ep)return;l.ep=!0;const s=r(l);fetch(l.href,s)}})();const Oi=!1;var Ki=Array.isArray,vl=Array.prototype.indexOf,bi=Array.from,Qs=Object.defineProperty,Ar=Object.getOwnPropertyDescriptor,pl=Object.getOwnPropertyDescriptors,gl=Object.prototype,_l=Array.prototype,eo=Object.getPrototypeOf,As=Object.isExtensible;const sn=()=>{};function to(t){for(var n=0;n<t.length;n++)t[n]()}function no(){var t,n,r=new Promise((i,l)=>{t=i,n=l});return{promise:r,resolve:t,reject:n}}const je=2,Ji=4,Zi=8,bl=1<<24,an=16,cn=32,Gn=64,yi=128,Ht=512,et=1024,at=2048,Ut=4096,gt=8192,Cn=16384,Qi=32768,fr=65536,Ps=1<<17,ro=1<<18,pr=1<<19,yl=1<<20,rn=1<<25,Xn=32768,qi=1<<21,es=1<<22,Tn=1<<23,cr=Symbol("$state"),wl=Symbol(""),ar=new class extends Error{name="StaleReactionError";message="The reaction that called `getAbortSignal()` was re-run or destroyed"};function ml(t){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}function xl(){throw new Error("https://svelte.dev/e/async_derived_orphan")}function kl(t){throw new Error("https://svelte.dev/e/effect_in_teardown")}function Sl(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function Cl(t){throw new Error("https://svelte.dev/e/effect_orphan")}function Tl(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function Il(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function Ml(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function El(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}function zl(){throw new Error("https://svelte.dev/e/svelte_boundary_reset_onerror")}const Ll=1,Al=2,io=4,Pl=8,Rl=16,Hl=2,Ze=Symbol(),Ol="http://www.w3.org/1999/xhtml";function ql(){console.warn("https://svelte.dev/e/select_multiple_invalid_value")}function Fl(){console.warn("https://svelte.dev/e/svelte_boundary_reset_noop")}function so(t){return t===this.v}function oo(t,n){return t!=t?n==n:t!==n||t!==null&&typeof t=="object"||typeof t=="function"}function lo(t){return!oo(t,this.v)}let Dl=!1,_t=null;function dr(t){_t=t}function Dr(t,n=!1,r){_t={p:_t,i:!1,c:null,e:null,s:t,x:null,l:null}}function Br(t){var n=_t,r=n.e;if(r!==null){n.e=null;for(var i of r)So(i)}return t!==void 0&&(n.x=t),n.i=!0,_t=n.p,t??{}}function ao(){return!0}let $n=[];function co(){var t=$n;$n=[],to(t)}function gr(t){if($n.length===0&&!Pr){var n=$n;queueMicrotask(()=>{n===$n&&co()})}$n.push(t)}function Bl(){for(;$n.length>0;)co()}function uo(t){var n=me;if(n===null)return ue.f|=Tn,t;if((n.f&Qi)===0){if((n.f&yi)===0)throw t;n.b.error(t)}else hr(t,n)}function hr(t,n){for(;n!==null;){if((n.f&yi)!==0)try{n.b.error(t);return}catch(r){t=r}n=n.parent}throw t}const si=new Set;let ve=null,ai=null,kt=null,mt=[],wi=null,Fi=!1,Pr=!1;class Nt{committed=!1;current=new Map;previous=new Map;#e=new Set;#t=new Set;#r=0;#n=0;#a=null;#s=new Set;#i=new Set;skipped_effects=new Set;is_fork=!1;is_deferred(){return this.is_fork||this.#n>0}process(n){mt=[],ai=null,this.apply();var r={parent:null,effect:null,effects:[],render_effects:[]};for(const i of n)this.#o(i,r);this.is_fork||this.#u(),this.is_deferred()?(this.#l(r.effects),this.#l(r.render_effects)):(ai=this,ve=null,Rs(r.render_effects),Rs(r.effects),ai=null,this.#a?.resolve()),kt=null}#o(n,r){n.f^=et;for(var i=n.first;i!==null;){var l=i.f,s=(l&(cn|Gn))!==0,v=s&&(l&et)!==0,h=v||(l&gt)!==0||this.skipped_effects.has(i);if((i.f&yi)!==0&&i.b?.is_pending()&&(r={parent:r,effect:i,effects:[],render_effects:[]}),!h&&i.fn!==null){s?i.f^=et:(l&Ji)!==0?r.effects.push(i):Wr(i)&&((i.f&an)!==0&&this.#s.add(i),Fr(i));var c=i.first;if(c!==null){i=c;continue}}var p=i.parent;for(i=i.next;i===null&&p!==null;)p===r.effect&&(this.#l(r.effects),this.#l(r.render_effects),r=r.parent),i=p.next,p=p.parent}}#l(n){for(const r of n)(r.f&at)!==0?this.#s.add(r):(r.f&Ut)!==0&&this.#i.add(r),this.#c(r.deps),tt(r,et)}#c(n){if(n!==null)for(const r of n)(r.f&je)===0||(r.f&Xn)===0||(r.f^=Xn,this.#c(r.deps))}capture(n,r){this.previous.has(n)||this.previous.set(n,r),(n.f&Tn)===0&&(this.current.set(n,n.v),kt?.set(n,n.v))}activate(){ve=this,this.apply()}deactivate(){ve===this&&(ve=null,kt=null)}flush(){if(this.activate(),mt.length>0){if(fo(),ve!==null&&ve!==this)return}else this.#r===0&&this.process([]);this.deactivate()}discard(){for(const n of this.#t)n(this);this.#t.clear()}#u(){if(this.#n===0){for(const n of this.#e)n();this.#e.clear()}this.#r===0&&this.#f()}#f(){if(si.size>1){this.previous.clear();var n=kt,r=!0,i={parent:null,effect:null,effects:[],render_effects:[]};for(const s of si){if(s===this){r=!1;continue}const v=[];for(const[c,p]of this.current){if(s.current.has(c))if(r&&p!==s.current.get(c))s.current.set(c,p);else continue;v.push(c)}if(v.length===0)continue;const h=[...s.current.keys()].filter(c=>!this.current.has(c));if(h.length>0){var l=mt;mt=[];const c=new Set,p=new Map;for(const C of v)ho(C,h,c,p);if(mt.length>0){ve=s,s.apply();for(const C of mt)s.#o(C,i);s.deactivate()}mt=l}}ve=null,kt=n}this.committed=!0,si.delete(this)}increment(n){this.#r+=1,n&&(this.#n+=1)}decrement(n){this.#r-=1,n&&(this.#n-=1),this.revive()}revive(){for(const n of this.#s)this.#i.delete(n),tt(n,at),jn(n);for(const n of this.#i)tt(n,Ut),jn(n);this.flush()}oncommit(n){this.#e.add(n)}ondiscard(n){this.#t.add(n)}settled(){return(this.#a??=no()).promise}static ensure(){if(ve===null){const n=ve=new Nt;si.add(ve),Pr||Nt.enqueue(()=>{ve===n&&n.flush()})}return ve}static enqueue(n){gr(n)}apply(){}}function $l(t){var n=Pr;Pr=!0;try{for(var r;;){if(Bl(),mt.length===0&&(ve?.flush(),mt.length===0))return wi=null,r;fo()}}finally{Pr=n}}function fo(){var t=Vn;Fi=!0;var n=null;try{var r=0;for(gi(!0);mt.length>0;){var i=Nt.ensure();if(r++>1e3){var l,s;Wl()}i.process(mt),In.clear()}}finally{Fi=!1,gi(t),wi=null}}function Wl(){try{Tl()}catch(t){hr(t,wi)}}let tn=null;function Rs(t){var n=t.length;if(n!==0){for(var r=0;r<n;){var i=t[r++];if((i.f&(Cn|gt))===0&&Wr(i)&&(tn=new Set,Fr(i),i.deps===null&&i.first===null&&i.nodes===null&&(i.teardown===null&&i.ac===null?Io(i):i.fn=null),tn?.size>0)){In.clear();for(const l of tn){if((l.f&(Cn|gt))!==0)continue;const s=[l];let v=l.parent;for(;v!==null;)tn.has(v)&&(tn.delete(v),s.push(v)),v=v.parent;for(let h=s.length-1;h>=0;h--){const c=s[h];(c.f&(Cn|gt))===0&&Fr(c)}}tn.clear()}}tn=null}}function ho(t,n,r,i){if(!r.has(t)&&(r.add(t),t.reactions!==null))for(const l of t.reactions){const s=l.f;(s&je)!==0?ho(l,n,r,i):(s&(es|an))!==0&&(s&at)===0&&vo(l,n,i)&&(tt(l,at),jn(l))}}function vo(t,n,r){const i=r.get(t);if(i!==void 0)return i;if(t.deps!==null)for(const l of t.deps){if(n.includes(l))return!0;if((l.f&je)!==0&&vo(l,n,r))return r.set(l,!0),!0}return r.set(t,!1),!1}function jn(t){for(var n=wi=t;n.parent!==null;){n=n.parent;var r=n.f;if(Fi&&n===me&&(r&an)!==0&&(r&ro)===0)return;if((r&(Gn|cn))!==0){if((r&et)===0)return;n.f^=et}}mt.push(n)}function Nl(t){let n=0,r=Yn(0),i;return()=>{Or()&&(e(r),is(()=>(n===0&&(i=Nr(()=>t(()=>Rr(r)))),n+=1,()=>{gr(()=>{n-=1,n===0&&(i?.(),i=void 0,Rr(r))})})))}}var Vl=fr|pr|yi;function Ul(t,n,r){new Xl(t,n,r)}class Xl{parent;#e=!1;#t;#r=null;#n;#a;#s;#i=null;#o=null;#l=null;#c=null;#u=null;#f=0;#d=0;#v=!1;#h=null;#y=Nl(()=>(this.#h=Yn(this.#f),()=>{this.#h=null}));constructor(n,r,i){this.#t=n,this.#n=r,this.#a=i,this.parent=me.b,this.#e=!!this.#n.pending,this.#s=ss(()=>{me.b=this;{var l=this.#_();try{this.#i=xt(()=>i(l))}catch(s){this.error(s)}this.#d>0?this.#g():this.#e=!1}return()=>{this.#u?.remove()}},Vl)}#w(){try{this.#i=xt(()=>this.#a(this.#t))}catch(n){this.error(n)}this.#e=!1}#m(){const n=this.#n.pending;n&&(this.#o=xt(()=>n(this.#t)),Nt.enqueue(()=>{var r=this.#_();this.#i=this.#p(()=>(Nt.ensure(),xt(()=>this.#a(r)))),this.#d>0?this.#g():(Nn(this.#o,()=>{this.#o=null}),this.#e=!1)}))}#_(){var n=this.#t;return this.#e&&(this.#u=on(),this.#t.before(this.#u),n=this.#u),n}is_pending(){return this.#e||!!this.parent&&this.parent.is_pending()}has_pending_snippet(){return!!this.#n.pending}#p(n){var r=me,i=ue,l=_t;Xt(this.#s),ot(this.#s),dr(this.#s.ctx);try{return n()}catch(s){return uo(s),null}finally{Xt(r),ot(i),dr(l)}}#g(){const n=this.#n.pending;this.#i!==null&&(this.#c=document.createDocumentFragment(),this.#c.append(this.#u),zo(this.#i,this.#c)),this.#o===null&&(this.#o=xt(()=>n(this.#t)))}#b(n){if(!this.has_pending_snippet()){this.parent&&this.parent.#b(n);return}this.#d+=n,this.#d===0&&(this.#e=!1,this.#o&&Nn(this.#o,()=>{this.#o=null}),this.#c&&(this.#t.before(this.#c),this.#c=null))}update_pending_count(n){this.#b(n),this.#f+=n,this.#h&&vr(this.#h,this.#f)}get_effect_pending(){return this.#y(),e(this.#h)}error(n){var r=this.#n.onerror;let i=this.#n.failed;if(this.#v||!r&&!i)throw n;this.#i&&(lt(this.#i),this.#i=null),this.#o&&(lt(this.#o),this.#o=null),this.#l&&(lt(this.#l),this.#l=null);var l=!1,s=!1;const v=()=>{if(l){Fl();return}l=!0,s&&zl(),Nt.ensure(),this.#f=0,this.#l!==null&&Nn(this.#l,()=>{this.#l=null}),this.#e=this.has_pending_snippet(),this.#i=this.#p(()=>(this.#v=!1,xt(()=>this.#a(this.#t)))),this.#d>0?this.#g():this.#e=!1};var h=ue;try{ot(null),s=!0,r?.(n,v),s=!1}catch(c){hr(c,this.#s&&this.#s.parent)}finally{ot(h)}i&&gr(()=>{this.#l=this.#p(()=>{Nt.ensure(),this.#v=!0;try{return xt(()=>{i(this.#t,()=>n,()=>v)})}catch(c){return hr(c,this.#s.parent),null}finally{this.#v=!1}})})}}function jl(t,n,r,i){const l=ts;if(r.length===0&&t.length===0){i(n.map(l));return}var s=ve,v=me,h=Yl();function c(){Promise.all(r.map(p=>Gl(p))).then(p=>{h();try{i([...n.map(l),...p])}catch(C){(v.f&Cn)===0&&hr(C,v)}s?.deactivate(),pi()}).catch(p=>{hr(p,v)})}t.length>0?Promise.all(t).then(()=>{h();try{return c()}finally{s?.deactivate(),pi()}}):c()}function Yl(){var t=me,n=ue,r=_t,i=ve;return function(s=!0){Xt(t),ot(n),dr(r),s&&i?.activate()}}function pi(){Xt(null),ot(null),dr(null)}function ts(t){var n=je|at,r=ue!==null&&(ue.f&je)!==0?ue:null;return me!==null&&(me.f|=pr),{ctx:_t,deps:null,effects:null,equals:so,f:n,fn:t,reactions:null,rv:0,v:Ze,wv:0,parent:r??me,ac:null}}function Gl(t,n){let r=me;r===null&&xl();var i=r.b,l=void 0,s=Yn(Ze),v=!ue,h=new Map;return ca(()=>{var c=no();l=c.promise;try{Promise.resolve(t()).then(c.resolve,c.reject).then(()=>{p===ve&&p.committed&&p.deactivate(),pi()})}catch(I){c.reject(I),pi()}var p=ve;if(v){var C=!i.is_pending();i.update_pending_count(1),p.increment(C),h.get(p)?.reject(ar),h.delete(p),h.set(p,c)}const D=(I,x=void 0)=>{if(p.activate(),x)x!==ar&&(s.f|=Tn,vr(s,x));else{(s.f&Tn)!==0&&(s.f^=Tn),vr(s,I);for(const[B,U]of h){if(h.delete(B),B===p)break;U.reject(ar)}}v&&(i.update_pending_count(-1),p.decrement(C))};c.promise.then(D,I=>D(null,I||"unknown"))}),xi(()=>{for(const c of h.values())c.reject(ar)}),new Promise(c=>{function p(C){function D(){C===l?c(s):p(l)}C.then(D,D)}p(l)})}function Ie(t){const n=ts(t);return Lo(n),n}function Kl(t){const n=ts(t);return n.equals=lo,n}function po(t){var n=t.effects;if(n!==null){t.effects=null;for(var r=0;r<n.length;r+=1)lt(n[r])}}function Jl(t){for(var n=t.parent;n!==null;){if((n.f&je)===0)return(n.f&Cn)===0?n:null;n=n.parent}return null}function ns(t){var n,r=me;Xt(Jl(t));try{t.f&=~Xn,po(t),n=Ho(t)}finally{Xt(r)}return n}function go(t){var n=ns(t);if(t.equals(n)||(ve?.is_fork||(t.v=n),t.wv=Po()),!_r)if(kt!==null)(Or()||ve?.is_fork)&&kt.set(t,n);else{var r=(t.f&Ht)===0?Ut:et;tt(t,r)}}let Di=new Set;const In=new Map;let _o=!1;function Yn(t,n){var r={f:0,v:t,reactions:null,equals:so,rv:0,wv:0};return r}function V(t,n){const r=Yn(t);return Lo(r),r}function bo(t,n=!1,r=!0){const i=Yn(t);return n||(i.equals=lo),i}function f(t,n,r=!1){ue!==null&&(!Vt||(ue.f&Ps)!==0)&&ao()&&(ue.f&(je|an|es|Ps))!==0&&!ln?.includes(t)&&El();let i=r?vt(n):n;return vr(t,i)}function vr(t,n){if(!t.equals(n)){var r=t.v;_r?In.set(t,n):In.set(t,r),t.v=n;var i=Nt.ensure();i.capture(t,r),(t.f&je)!==0&&((t.f&at)!==0&&ns(t),tt(t,(t.f&Ht)!==0?et:Ut)),t.wv=Po(),yo(t,at),me!==null&&(me.f&et)!==0&&(me.f&(cn|Gn))===0&&(wt===null?da([t]):wt.push(t)),!i.is_fork&&Di.size>0&&!_o&&Zl()}return n}function Zl(){_o=!1;var t=Vn;gi(!0);const n=Array.from(Di);try{for(const r of n)(r.f&et)!==0&&tt(r,Ut),Wr(r)&&Fr(r)}finally{gi(t)}Di.clear()}function Qe(t,n=1){var r=e(t),i=n===1?r++:r--;return f(t,r),i}function Rr(t){f(t,t.v+1)}function yo(t,n){var r=t.reactions;if(r!==null)for(var i=r.length,l=0;l<i;l++){var s=r[l],v=s.f,h=(v&at)===0;if(h&&tt(s,n),(v&je)!==0){var c=s;kt?.delete(c),(v&Xn)===0&&(v&Ht&&(s.f|=Xn),yo(c,Ut))}else h&&((v&an)!==0&&tn!==null&&tn.add(s),jn(s))}}function vt(t){if(typeof t!="object"||t===null||cr in t)return t;const n=eo(t);if(n!==gl&&n!==_l)return t;var r=new Map,i=Ki(t),l=V(0),s=Un,v=h=>{if(Un===s)return h();var c=ue,p=Un;ot(null),Ds(s);var C=h();return ot(c),Ds(p),C};return i&&r.set("length",V(t.length)),new Proxy(t,{defineProperty(h,c,p){(!("value"in p)||p.configurable===!1||p.enumerable===!1||p.writable===!1)&&Il();var C=r.get(c);return C===void 0?C=v(()=>{var D=V(p.value);return r.set(c,D),D}):f(C,p.value,!0),!0},deleteProperty(h,c){var p=r.get(c);if(p===void 0){if(c in h){const C=v(()=>V(Ze));r.set(c,C),Rr(l)}}else f(p,Ze),Rr(l);return!0},get(h,c,p){if(c===cr)return t;var C=r.get(c),D=c in h;if(C===void 0&&(!D||Ar(h,c)?.writable)&&(C=v(()=>{var x=vt(D?h[c]:Ze),B=V(x);return B}),r.set(c,C)),C!==void 0){var I=e(C);return I===Ze?void 0:I}return Reflect.get(h,c,p)},getOwnPropertyDescriptor(h,c){var p=Reflect.getOwnPropertyDescriptor(h,c);if(p&&"value"in p){var C=r.get(c);C&&(p.value=e(C))}else if(p===void 0){var D=r.get(c),I=D?.v;if(D!==void 0&&I!==Ze)return{enumerable:!0,configurable:!0,value:I,writable:!0}}return p},has(h,c){if(c===cr)return!0;var p=r.get(c),C=p!==void 0&&p.v!==Ze||Reflect.has(h,c);if(p!==void 0||me!==null&&(!C||Ar(h,c)?.writable)){p===void 0&&(p=v(()=>{var I=C?vt(h[c]):Ze,x=V(I);return x}),r.set(c,p));var D=e(p);if(D===Ze)return!1}return C},set(h,c,p,C){var D=r.get(c),I=c in h;if(i&&c==="length")for(var x=p;x<D.v;x+=1){var B=r.get(x+"");B!==void 0?f(B,Ze):x in h&&(B=v(()=>V(Ze)),r.set(x+"",B))}if(D===void 0)(!I||Ar(h,c)?.writable)&&(D=v(()=>V(void 0)),f(D,vt(p)),r.set(c,D));else{I=D.v!==Ze;var U=v(()=>vt(p));f(D,U)}var d=Reflect.getOwnPropertyDescriptor(h,c);if(d?.set&&d.set.call(C,p),!I){if(i&&typeof c=="string"){var w=r.get("length"),L=Number(c);Number.isInteger(L)&&L>=w.v&&f(w,L+1)}Rr(l)}return!0},ownKeys(h){e(l);var c=Reflect.ownKeys(h).filter(D=>{var I=r.get(D);return I===void 0||I.v!==Ze});for(var[p,C]of r)C.v!==Ze&&!(p in h)&&c.push(p);return c},setPrototypeOf(){Ml()}})}function Hs(t){try{if(t!==null&&typeof t=="object"&&cr in t)return t[cr]}catch{}return t}function Ql(t,n){return Object.is(Hs(t),Hs(n))}var Os,wo,mo,xo;function ea(){if(Os===void 0){Os=window,wo=/Firefox/.test(navigator.userAgent);var t=Element.prototype,n=Node.prototype,r=Text.prototype;mo=Ar(n,"firstChild").get,xo=Ar(n,"nextSibling").get,As(t)&&(t.__click=void 0,t.__className=void 0,t.__attributes=null,t.__style=void 0,t.__e=void 0),As(r)&&(r.__t=void 0)}}function on(t=""){return document.createTextNode(t)}function rs(t){return mo.call(t)}function $r(t){return xo.call(t)}function q(t,n){return rs(t)}function ta(t,n=!1){{var r=rs(t);return r instanceof Comment&&r.data===""?$r(r):r}}function m(t,n=1,r=!1){let i=t;for(;n--;)i=$r(i);return i}function na(t){t.textContent=""}function ko(){return!1}let qs=!1;function ra(){qs||(qs=!0,document.addEventListener("reset",t=>{Promise.resolve().then(()=>{if(!t.defaultPrevented)for(const n of t.target.elements)n.__on_r?.()})},{capture:!0}))}function mi(t){var n=ue,r=me;ot(null),Xt(null);try{return t()}finally{ot(n),Xt(r)}}function ia(t,n,r,i=r){t.addEventListener(n,()=>mi(r));const l=t.__on_r;l?t.__on_r=()=>{l(),i(!0)}:t.__on_r=()=>i(!0),ra()}function sa(t){me===null&&(ue===null&&Cl(),Sl()),_r&&kl()}function oa(t,n){var r=n.last;r===null?n.last=n.first=t:(r.next=t,t.prev=r,n.last=t)}function un(t,n,r){var i=me;i!==null&&(i.f&gt)!==0&&(t|=gt);var l={ctx:_t,deps:null,nodes:null,f:t|at|Ht,first:null,fn:n,last:null,next:null,parent:i,b:i&&i.b,prev:null,teardown:null,wv:0,ac:null};if(r)try{Fr(l),l.f|=Qi}catch(h){throw lt(l),h}else n!==null&&jn(l);var s=l;if(r&&s.deps===null&&s.teardown===null&&s.nodes===null&&s.first===s.last&&(s.f&pr)===0&&(s=s.first,(t&an)!==0&&(t&fr)!==0&&s!==null&&(s.f|=fr)),s!==null&&(s.parent=i,i!==null&&oa(s,i),ue!==null&&(ue.f&je)!==0&&(t&Gn)===0)){var v=ue;(v.effects??=[]).push(s)}return l}function Or(){return ue!==null&&!Vt}function xi(t){const n=un(Zi,null,!1);return tt(n,et),n.teardown=t,n}function ci(t){sa();var n=me.f,r=!ue&&(n&cn)!==0&&(n&Qi)===0;if(r){var i=_t;(i.e??=[]).push(t)}else return So(t)}function So(t){return un(Ji|yl,t,!1)}function la(t){Nt.ensure();const n=un(Gn|pr,t,!0);return(r={})=>new Promise(i=>{r.outro?Nn(n,()=>{lt(n),i(void 0)}):(lt(n),i(void 0))})}function aa(t){return un(Ji,t,!1)}function ca(t){return un(es|pr,t,!0)}function is(t,n=0){return un(Zi|n,t,!0)}function Be(t,n=[],r=[],i=[]){jl(i,n,r,l=>{un(Zi,()=>t(...l.map(e)),!0)})}function ss(t,n=0){var r=un(an|n,t,!0);return r}function xt(t){return un(cn|pr,t,!0)}function Co(t){var n=t.teardown;if(n!==null){const r=_r,i=ue;Fs(!0),ot(null);try{n.call(null)}finally{Fs(r),ot(i)}}}function To(t,n=!1){var r=t.first;for(t.first=t.last=null;r!==null;){const l=r.ac;l!==null&&mi(()=>{l.abort(ar)});var i=r.next;(r.f&Gn)!==0?r.parent=null:lt(r,n),r=i}}function ua(t){for(var n=t.first;n!==null;){var r=n.next;(n.f&cn)===0&&lt(n),n=r}}function lt(t,n=!0){var r=!1;(n||(t.f&ro)!==0)&&t.nodes!==null&&t.nodes.end!==null&&(fa(t.nodes.start,t.nodes.end),r=!0),To(t,n&&!r),_i(t,0),tt(t,Cn);var i=t.nodes&&t.nodes.t;if(i!==null)for(const s of i)s.stop();Co(t);var l=t.parent;l!==null&&l.first!==null&&Io(t),t.next=t.prev=t.teardown=t.ctx=t.deps=t.fn=t.nodes=t.ac=null}function fa(t,n){for(;t!==null;){var r=t===n?null:$r(t);t.remove(),t=r}}function Io(t){var n=t.parent,r=t.prev,i=t.next;r!==null&&(r.next=i),i!==null&&(i.prev=r),n!==null&&(n.first===t&&(n.first=i),n.last===t&&(n.last=r))}function Nn(t,n,r=!0){var i=[];Mo(t,i,!0);var l=()=>{r&&lt(t),n&&n()},s=i.length;if(s>0){var v=()=>--s||l();for(var h of i)h.out(v)}else l()}function Mo(t,n,r){if((t.f&gt)===0){t.f^=gt;var i=t.nodes&&t.nodes.t;if(i!==null)for(const h of i)(h.is_global||r)&&n.push(h);for(var l=t.first;l!==null;){var s=l.next,v=(l.f&fr)!==0||(l.f&cn)!==0&&(t.f&an)!==0;Mo(l,n,v?r:!1),l=s}}}function os(t){Eo(t,!0)}function Eo(t,n){if((t.f&gt)!==0){t.f^=gt,(t.f&et)===0&&(tt(t,at),jn(t));for(var r=t.first;r!==null;){var i=r.next,l=(r.f&fr)!==0||(r.f&cn)!==0;Eo(r,l?n:!1),r=i}var s=t.nodes&&t.nodes.t;if(s!==null)for(const v of s)(v.is_global||n)&&v.in()}}function zo(t,n){if(t.nodes)for(var r=t.nodes.start,i=t.nodes.end;r!==null;){var l=r===i?null:$r(r);n.append(r),r=l}}let Vn=!1;function gi(t){Vn=t}let _r=!1;function Fs(t){_r=t}let ue=null,Vt=!1;function ot(t){ue=t}let me=null;function Xt(t){me=t}let ln=null;function Lo(t){ue!==null&&(ln===null?ln=[t]:ln.push(t))}let rt=null,ht=0,wt=null;function da(t){wt=t}let Ao=1,qr=0,Un=qr;function Ds(t){Un=t}function Po(){return++Ao}function Wr(t){var n=t.f;if((n&at)!==0)return!0;if(n&je&&(t.f&=~Xn),(n&Ut)!==0){var r=t.deps;if(r!==null)for(var i=r.length,l=0;l<i;l++){var s=r[l];if(Wr(s)&&go(s),s.wv>t.wv)return!0}(n&Ht)!==0&&kt===null&&tt(t,et)}return!1}function Ro(t,n,r=!0){var i=t.reactions;if(i!==null&&!ln?.includes(t))for(var l=0;l<i.length;l++){var s=i[l];(s.f&je)!==0?Ro(s,n,!1):n===s&&(r?tt(s,at):(s.f&et)!==0&&tt(s,Ut),jn(s))}}function Ho(t){var n=rt,r=ht,i=wt,l=ue,s=ln,v=_t,h=Vt,c=Un,p=t.f;rt=null,ht=0,wt=null,ue=(p&(cn|Gn))===0?t:null,ln=null,dr(t.ctx),Vt=!1,Un=++qr,t.ac!==null&&(mi(()=>{t.ac.abort(ar)}),t.ac=null);try{t.f|=qi;var C=t.fn,D=C(),I=t.deps;if(rt!==null){var x;if(_i(t,ht),I!==null&&ht>0)for(I.length=ht+rt.length,x=0;x<rt.length;x++)I[ht+x]=rt[x];else t.deps=I=rt;if(Or()&&(t.f&Ht)!==0)for(x=ht;x<I.length;x++)(I[x].reactions??=[]).push(t)}else I!==null&&ht<I.length&&(_i(t,ht),I.length=ht);if(ao()&&wt!==null&&!Vt&&I!==null&&(t.f&(je|Ut|at))===0)for(x=0;x<wt.length;x++)Ro(wt[x],t);return l!==null&&l!==t&&(qr++,wt!==null&&(i===null?i=wt:i.push(...wt))),(t.f&Tn)!==0&&(t.f^=Tn),D}catch(B){return uo(B)}finally{t.f^=qi,rt=n,ht=r,wt=i,ue=l,ln=s,dr(v),Vt=h,Un=c}}function ha(t,n){let r=n.reactions;if(r!==null){var i=vl.call(r,t);if(i!==-1){var l=r.length-1;l===0?r=n.reactions=null:(r[i]=r[l],r.pop())}}r===null&&(n.f&je)!==0&&(rt===null||!rt.includes(n))&&(tt(n,Ut),(n.f&Ht)!==0&&(n.f^=Ht,n.f&=~Xn),po(n),_i(n,0))}function _i(t,n){var r=t.deps;if(r!==null)for(var i=n;i<r.length;i++)ha(t,r[i])}function Fr(t){var n=t.f;if((n&Cn)===0){tt(t,et);var r=me,i=Vn;me=t,Vn=!0;try{(n&(an|bl))!==0?ua(t):To(t),Co(t);var l=Ho(t);t.teardown=typeof l=="function"?l:null,t.wv=Ao;var s;Oi&&Dl&&(t.f&at)!==0&&t.deps}finally{Vn=i,me=r}}}async function va(){await Promise.resolve(),$l()}function e(t){var n=t.f,r=(n&je)!==0;if(ue!==null&&!Vt){var i=me!==null&&(me.f&Cn)!==0;if(!i&&!ln?.includes(t)){var l=ue.deps;if((ue.f&qi)!==0)t.rv<qr&&(t.rv=qr,rt===null&&l!==null&&l[ht]===t?ht++:rt===null?rt=[t]:rt.includes(t)||rt.push(t));else{(ue.deps??=[]).push(t);var s=t.reactions;s===null?t.reactions=[ue]:s.includes(ue)||s.push(ue)}}}if(_r){if(In.has(t))return In.get(t);if(r){var v=t,h=v.v;return((v.f&et)===0&&v.reactions!==null||qo(v))&&(h=ns(v)),In.set(v,h),h}}else r&&(!kt?.has(t)||ve?.is_fork&&!Or())&&(v=t,Wr(v)&&go(v),Vn&&Or()&&(v.f&Ht)===0&&Oo(v));if(kt?.has(t))return kt.get(t);if((t.f&Tn)!==0)throw t.v;return t.v}function Oo(t){if(t.deps!==null){t.f^=Ht;for(const n of t.deps)(n.reactions??=[]).push(t),(n.f&je)!==0&&(n.f&Ht)===0&&Oo(n)}}function qo(t){if(t.v===Ze)return!0;if(t.deps===null)return!1;for(const n of t.deps)if(In.has(n)||(n.f&je)!==0&&qo(n))return!0;return!1}function Nr(t){var n=Vt;try{return Vt=!0,t()}finally{Vt=n}}const pa=-7169;function tt(t,n){t.f=t.f&pa|n}const ga=["touchstart","touchmove"];function _a(t){return ga.includes(t)}const Fo=new Set,Bi=new Set;function ba(t,n,r,i={}){function l(s){if(i.capture||Mr.call(n,s),!s.cancelBubble)return mi(()=>r?.call(this,s))}return t.startsWith("pointer")||t.startsWith("touch")||t==="wheel"?gr(()=>{n.addEventListener(t,l,i)}):n.addEventListener(t,l,i),l}function oi(t,n,r,i,l){var s={capture:i,passive:l},v=ba(t,n,r,s);(n===document.body||n===window||n===document||n instanceof HTMLMediaElement)&&xi(()=>{n.removeEventListener(t,v,s)})}function Vr(t){for(var n=0;n<t.length;n++)Fo.add(t[n]);for(var r of Bi)r(t)}let Bs=null;function Mr(t){var n=this,r=n.ownerDocument,i=t.type,l=t.composedPath?.()||[],s=l[0]||t.target;Bs=t;var v=0,h=Bs===t&&t.__root;if(h){var c=l.indexOf(h);if(c!==-1&&(n===document||n===window)){t.__root=n;return}var p=l.indexOf(n);if(p===-1)return;c<=p&&(v=c)}if(s=l[v]||t.target,s!==n){Qs(t,"currentTarget",{configurable:!0,get(){return s||r}});var C=ue,D=me;ot(null),Xt(null);try{for(var I,x=[];s!==null;){var B=s.assignedSlot||s.parentNode||s.host||null;try{var U=s["__"+i];U!=null&&(!s.disabled||t.target===s)&&U.call(s,t)}catch(d){I?x.push(d):I=d}if(t.cancelBubble||B===n||B===null)break;s=B}if(I){for(let d of x)queueMicrotask(()=>{throw d});throw I}}finally{t.__root=n,delete t.currentTarget,ot(C),Xt(D)}}}function ya(t){var n=document.createElement("template");return n.innerHTML=t.replaceAll("<!>","<!---->"),n.content}function ls(t,n){var r=me;r.nodes===null&&(r.nodes={start:t,end:n,a:null,t:null})}function Ee(t,n){var r=(n&Hl)!==0,i,l=!t.startsWith("<!>");return()=>{i===void 0&&(i=ya(l?t:"<!>"+t),i=rs(i));var s=r||wo?document.importNode(i,!0):i.cloneNode(!0);return ls(s,s),s}}function zi(t=""){{var n=on(t+"");return ls(n,n),n}}function wa(){var t=document.createDocumentFragment(),n=document.createComment(""),r=on();return t.append(n,r),ls(n,r),t}function we(t,n){t!==null&&t.before(n)}function Rt(t,n){var r=n==null?"":typeof n=="object"?n+"":n;r!==(t.__t??=t.nodeValue)&&(t.__t=r,t.nodeValue=r+"")}function ma(t,n){return xa(t,n)}const ir=new Map;function xa(t,{target:n,anchor:r,props:i={},events:l,context:s,intro:v=!0}){ea();var h=new Set,c=D=>{for(var I=0;I<D.length;I++){var x=D[I];if(!h.has(x)){h.add(x);var B=_a(x);n.addEventListener(x,Mr,{passive:B});var U=ir.get(x);U===void 0?(document.addEventListener(x,Mr,{passive:B}),ir.set(x,1)):ir.set(x,U+1)}}};c(bi(Fo)),Bi.add(c);var p=void 0,C=la(()=>{var D=r??n.appendChild(on());return Ul(D,{pending:()=>{}},I=>{if(s){Dr({});var x=_t;x.c=s}l&&(i.$$events=l),p=t(I,i)||{},s&&Br()}),()=>{for(var I of h){n.removeEventListener(I,Mr);var x=ir.get(I);--x===0?(document.removeEventListener(I,Mr),ir.delete(I)):ir.set(I,x)}Bi.delete(c),D!==r&&D.parentNode?.removeChild(D)}});return ka.set(p,C),p}let ka=new WeakMap;class Sa{anchor;#e=new Map;#t=new Map;#r=new Map;#n=new Set;#a=!0;constructor(n,r=!0){this.anchor=n,this.#a=r}#s=()=>{var n=ve;if(this.#e.has(n)){var r=this.#e.get(n),i=this.#t.get(r);if(i)os(i),this.#n.delete(r);else{var l=this.#r.get(r);l&&(this.#t.set(r,l.effect),this.#r.delete(r),l.fragment.lastChild.remove(),this.anchor.before(l.fragment),i=l.effect)}for(const[s,v]of this.#e){if(this.#e.delete(s),s===n)break;const h=this.#r.get(v);h&&(lt(h.effect),this.#r.delete(v))}for(const[s,v]of this.#t){if(s===r||this.#n.has(s))continue;const h=()=>{if(Array.from(this.#e.values()).includes(s)){var p=document.createDocumentFragment();zo(v,p),p.append(on()),this.#r.set(s,{effect:v,fragment:p})}else lt(v);this.#n.delete(s),this.#t.delete(s)};this.#a||!i?(this.#n.add(s),Nn(v,h,!1)):h()}}};#i=n=>{this.#e.delete(n);const r=Array.from(this.#e.values());for(const[i,l]of this.#r)r.includes(i)||(lt(l.effect),this.#r.delete(i))};ensure(n,r){var i=ve,l=ko();if(r&&!this.#t.has(n)&&!this.#r.has(n))if(l){var s=document.createDocumentFragment(),v=on();s.append(v),this.#r.set(n,{effect:xt(()=>r(v)),fragment:s})}else this.#t.set(n,xt(()=>r(this.anchor)));if(this.#e.set(i,n),l){for(const[h,c]of this.#t)h===n?i.skipped_effects.delete(c):i.skipped_effects.add(c);for(const[h,c]of this.#r)h===n?i.skipped_effects.delete(c.effect):i.skipped_effects.add(c.effect);i.oncommit(this.#s),i.ondiscard(this.#i)}else this.#s()}}function pt(t,n,r=!1){var i=new Sa(t),l=r?fr:0;function s(v,h){i.ensure(v,h)}ss(()=>{var v=!1;n((h,c=!0)=>{v=!0,s(c,h)}),v||s(!1,null)},l)}function Bn(t,n){return n}function Ca(t,n,r){for(var i=[],l=n.length,s,v=n.length,h=0;h<l;h++){let D=n[h];Nn(D,()=>{if(s){if(s.pending.delete(D),s.done.add(D),s.pending.size===0){var I=t.outrogroups;$i(bi(s.done)),I.delete(s),I.size===0&&(t.outrogroups=null)}}else v-=1},!1)}if(v===0){var c=i.length===0&&r!==null;if(c){var p=r,C=p.parentNode;na(C),C.append(p),t.items.clear()}$i(n,!c)}else s={pending:new Set(n),done:new Set},(t.outrogroups??=new Set).add(s)}function $i(t,n=!0){for(var r=0;r<t.length;r++)lt(t[r],n)}var $s;function Sn(t,n,r,i,l,s=null){var v=t,h=new Map,c=(n&io)!==0;if(c){var p=t;v=p.appendChild(on())}var C=null,D=Kl(()=>{var w=r();return Ki(w)?w:w==null?[]:bi(w)}),I,x=!0;function B(){d.fallback=C,Ta(d,I,v,n,i),C!==null&&(I.length===0?(C.f&rn)===0?os(C):(C.f^=rn,Er(C,null,v)):Nn(C,()=>{C=null}))}var U=ss(()=>{I=e(D);for(var w=I.length,L=new Set,oe=ve,fe=ko(),pe=0;pe<w;pe+=1){var Pe=I[pe],y=i(Pe,pe),F=x?null:h.get(y);F?(F.v&&vr(F.v,Pe),F.i&&vr(F.i,pe),fe&&oe.skipped_effects.delete(F.e)):(F=Ia(h,x?v:$s??=on(),Pe,y,pe,l,n,r),x||(F.e.f|=rn),h.set(y,F)),L.add(y)}if(w===0&&s&&!C&&(x?C=xt(()=>s(v)):(C=xt(()=>s($s??=on())),C.f|=rn)),!x)if(fe){for(const[G,K]of h)L.has(G)||oe.skipped_effects.add(K.e);oe.oncommit(B),oe.ondiscard(()=>{})}else B();e(D)}),d={effect:U,items:h,outrogroups:null,fallback:C};x=!1}function Ta(t,n,r,i,l){var s=(i&Pl)!==0,v=n.length,h=t.items,c=t.effect.first,p,C=null,D,I=[],x=[],B,U,d,w;if(s)for(w=0;w<v;w+=1)B=n[w],U=l(B,w),d=h.get(U).e,(d.f&rn)===0&&(d.nodes?.a?.measure(),(D??=new Set).add(d));for(w=0;w<v;w+=1){if(B=n[w],U=l(B,w),d=h.get(U).e,t.outrogroups!==null)for(const K of t.outrogroups)K.pending.delete(d),K.done.delete(d);if((d.f&rn)!==0)if(d.f^=rn,d===c)Er(d,null,r);else{var L=C?C.next:c;d===t.effect.last&&(t.effect.last=d.prev),d.prev&&(d.prev.next=d.next),d.next&&(d.next.prev=d.prev),kn(t,C,d),kn(t,d,L),Er(d,L,r),C=d,I=[],x=[],c=C.next;continue}if((d.f&gt)!==0&&(os(d),s&&(d.nodes?.a?.unfix(),(D??=new Set).delete(d))),d!==c){if(p!==void 0&&p.has(d)){if(I.length<x.length){var oe=x[0],fe;C=oe.prev;var pe=I[0],Pe=I[I.length-1];for(fe=0;fe<I.length;fe+=1)Er(I[fe],oe,r);for(fe=0;fe<x.length;fe+=1)p.delete(x[fe]);kn(t,pe.prev,Pe.next),kn(t,C,pe),kn(t,Pe,oe),c=oe,C=Pe,w-=1,I=[],x=[]}else p.delete(d),Er(d,c,r),kn(t,d.prev,d.next),kn(t,d,C===null?t.effect.first:C.next),kn(t,C,d),C=d;continue}for(I=[],x=[];c!==null&&c!==d;)(p??=new Set).add(c),x.push(c),c=c.next;if(c===null)continue}(d.f&rn)===0&&I.push(d),C=d,c=d.next}if(t.outrogroups!==null){for(const K of t.outrogroups)K.pending.size===0&&($i(bi(K.done)),t.outrogroups?.delete(K));t.outrogroups.size===0&&(t.outrogroups=null)}if(c!==null||p!==void 0){var y=[];if(p!==void 0)for(d of p)(d.f&gt)===0&&y.push(d);for(;c!==null;)(c.f&gt)===0&&c!==t.fallback&&y.push(c),c=c.next;var F=y.length;if(F>0){var G=(i&io)!==0&&v===0?r:null;if(s){for(w=0;w<F;w+=1)y[w].nodes?.a?.measure();for(w=0;w<F;w+=1)y[w].nodes?.a?.fix()}Ca(t,y,G)}}s&&gr(()=>{if(D!==void 0)for(d of D)d.nodes?.a?.apply()})}function Ia(t,n,r,i,l,s,v,h){var c=(v&Ll)!==0?(v&Rl)===0?bo(r,!1,!1):Yn(r):null,p=(v&Al)!==0?Yn(l):null;return{v:c,i:p,e:xt(()=>(s(n,c??r,p??l,h),()=>{t.delete(i)}))}}function Er(t,n,r){if(t.nodes)for(var i=t.nodes.start,l=t.nodes.end,s=n&&(n.f&rn)===0?n.nodes.start:r;i!==null;){var v=$r(i);if(s.before(i),i===l)return;i=v}}function kn(t,n,r){n===null?t.effect.first=r:n.next=r,r===null?t.effect.last=n:r.prev=n}const Ws=[...` 	
\r\fÂ \v\uFEFF`];function Ma(t,n,r){var i=t==null?"":""+t;if(n&&(i=i?i+" "+n:n),r){for(var l in r)if(r[l])i=i?i+" "+l:l;else if(i.length)for(var s=l.length,v=0;(v=i.indexOf(l,v))>=0;){var h=v+s;(v===0||Ws.includes(i[v-1]))&&(h===i.length||Ws.includes(i[h]))?i=(v===0?"":i.substring(0,v))+i.substring(h+1):v=h}}return i===""?null:i}function Ea(t,n){return t==null?null:String(t)}function Z(t,n,r,i,l,s){var v=t.__className;if(v!==r||v===void 0){var h=Ma(r,i,s);h==null?t.removeAttribute("class"):t.className=h,t.__className=r}else if(s&&l!==s)for(var c in s){var p=!!s[c];(l==null||p!==!!l[c])&&t.classList.toggle(c,p)}return s}function Wi(t,n,r,i){var l=t.__style;if(l!==n){var s=Ea(n);s==null?t.removeAttribute("style"):t.style.cssText=s,t.__style=n}return i}function ui(t,n,r=!1){if(t.multiple){if(n==null)return;if(!Ki(n))return ql();for(var i of t.options)i.selected=n.includes(Ns(i));return}for(i of t.options){var l=Ns(i);if(Ql(l,n)){i.selected=!0;return}}(!r||n!==void 0)&&(t.selectedIndex=-1)}function Li(t){var n=new MutationObserver(()=>{ui(t,t.__value)});n.observe(t,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),xi(()=>{n.disconnect()})}function Ns(t){return"__value"in t?t.__value:t.value}const za=Symbol("is custom element"),La=Symbol("is html");function Vs(t,n){var r=Bo(t);r.checked!==(r.checked=n??void 0)&&(t.checked=n)}function Do(t,n,r,i){var l=Bo(t);l[n]!==(l[n]=r)&&(n==="loading"&&(t[wl]=r),r==null?t.removeAttribute(n):typeof r!="string"&&Aa(t).includes(n)?t[n]=r:t.setAttribute(n,r))}function Bo(t){return t.__attributes??={[za]:t.nodeName.includes("-"),[La]:t.namespaceURI===Ol}}var Us=new Map;function Aa(t){var n=t.getAttribute("is")||t.nodeName,r=Us.get(n);if(r)return r;Us.set(n,r=[]);for(var i,l=t,s=Element.prototype;s!==l;){i=pl(l);for(var v in i)i[v].set&&r.push(v);l=eo(l)}return r}function Pa(t,n,r=n){var i=new WeakSet;ia(t,"input",async l=>{var s=l?t.defaultValue:t.value;if(s=Ai(t)?Pi(s):s,r(s),ve!==null&&i.add(ve),await va(),s!==(s=n())){var v=t.selectionStart,h=t.selectionEnd,c=t.value.length;if(t.value=s??"",h!==null){var p=t.value.length;v===h&&h===c&&p>c?(t.selectionStart=p,t.selectionEnd=p):(t.selectionStart=v,t.selectionEnd=Math.min(h,p))}}}),Nr(n)==null&&t.value&&(r(Ai(t)?Pi(t.value):t.value),ve!==null&&i.add(ve)),is(()=>{var l=n();if(t===document.activeElement){var s=ai??ve;if(i.has(s))return}Ai(t)&&l===Pi(t.value)||t.type==="date"&&!l&&!t.value||l!==t.value&&(t.value=l??"")})}function Ai(t){var n=t.type;return n==="number"||n==="range"}function Pi(t){return t===""?null:+t}function Xs(t,n){return t===n||t?.[cr]===n}function nn(t={},n,r,i){return aa(()=>{var l,s;return is(()=>{l=s,s=i?.()||[],Nr(()=>{t!==r(...s)&&(n(t,...s),l&&Xs(r(...l),t)&&n(null,...l))})}),()=>{gr(()=>{s&&Xs(r(...s),t)&&n(null,...s)})}}),t}function as(t,n,r){if(t==null)return n(void 0),r&&r(void 0),sn;const i=Nr(()=>t.subscribe(n,r));return i.unsubscribe?()=>i.unsubscribe():i}const sr=[];function Ra(t,n){return{subscribe:Ot(t,n).subscribe}}function Ot(t,n=sn){let r=null;const i=new Set;function l(h){if(oo(t,h)&&(t=h,r)){const c=!sr.length;for(const p of i)p[1](),sr.push(p,t);if(c){for(let p=0;p<sr.length;p+=2)sr[p][0](sr[p+1]);sr.length=0}}}function s(h){l(h(t))}function v(h,c=sn){const p=[h,c];return i.add(p),i.size===1&&(r=n(l,s)||sn),h(t),()=>{i.delete(p),i.size===0&&r&&(r(),r=null)}}return{set:l,update:s,subscribe:v}}function cs(t,n,r){const i=!Array.isArray(t),l=i?[t]:t;if(!l.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const s=n.length<2;return Ra(r,(v,h)=>{let c=!1;const p=[];let C=0,D=sn;const I=()=>{if(C)return;D();const B=n(i?p[0]:p,v,h);s?v(B):D=typeof B=="function"?B:sn},x=l.map((B,U)=>as(B,d=>{p[U]=d,C&=~(1<<U),c&&I()},()=>{C|=1<<U}));return c=!0,I(),function(){to(x),D(),c=!1}})}function Ha(t){let n;return as(t,r=>n=r)(),n}let Ni=Symbol();function Ne(t,n,r){const i=r[n]??={store:null,source:bo(void 0),unsubscribe:sn};if(i.store!==t&&!(Ni in r))if(i.unsubscribe(),i.store=t??null,t==null)i.source.v=void 0,i.unsubscribe=sn;else{var l=!0;i.unsubscribe=as(t,s=>{l?i.source.v=s:f(i.source,s)}),l=!1}return t&&Ni in r?Ha(t):e(i.source)}function us(){const t={};function n(){xi(()=>{for(var r in t)t[r].unsubscribe();Qs(t,Ni,{enumerable:!1,value:!0})})}return[t,n]}function js(t,n,r,i){var l=i,s=!0,v=()=>(s&&(s=!1,l=i),l),h;h=t[n],h===void 0&&i!==void 0&&(h=v());var c;return c=()=>{var p=t[n];return p===void 0?v():(s=!0,p)},c}function fs(t){_t===null&&ml(),ci(()=>{const n=Nr(t);if(typeof n=="function")return n})}const Oa="5";typeof window<"u"&&((window.__svelte??={}).v??=new Set).add(Oa);const $o={A4:{name:"A4",width:210,height:297},A5:{name:"A5",width:148,height:210},LETTER:{name:"Letter",width:215.9,height:279.4},LEGAL:{name:"Legal",width:215.9,height:355.6},TEXTBOOK:{name:"US Textbook",width:236.2,height:279.4}},Vi={top:25.4,right:25.4,bottom:25.4,left:25.4},Ys={top:12.7,right:12.7,bottom:12.7,left:12.7},Gs={top:25.4,right:50.8,bottom:25.4,left:50.8};function St(t){return t/25.4*96}function ds(t){const{format:n,orientation:r}=t;return r==="landscape"?{width:St(n.height),height:St(n.width)}:{width:St(n.width),height:St(n.height)}}function hs(t){const n=ds(t),{margins:r}=t;return{width:n.width-St(r.left)-St(r.right),height:n.height-St(r.top)-St(r.bottom)}}function Wo(t){const n=hs(t),r=t.columns||1,i=St(t.columnGap||0);return r===1?n.width:(n.width-i)/2}const No=Ot([]),zr=Ot(1),Vo=Ot(1),Wt=Ot({format:$o.A4,margins:Vi,orientation:"portrait",columns:1,columnGap:10}),fi=Ot(100);cs(Wt,t=>ds(t));cs(Wt,t=>hs(t));cs(Wt,t=>Wo(t));const Uo=Ot(16),Ui=Ot("Arial"),Xi=Ot(1.5),ji=Ot(0),Yi=Ot(12),or=[8,9,10,11,12,14,16,18,20,24,28,32,36,48,72],qa=["Arial","Times New Roman","Georgia","Verdana","Courier New","Trebuchet MS","Comic Sans MS","Impact","Palatino Linotype","Garamond"],Fa=[{value:1,label:"Single"},{value:1.15,label:"1.15"},{value:1.5,label:"1.5"},{value:2,label:"Double"},{value:2.5,label:"2.5"},{value:3,label:"Triple"}],Da=[{value:-1,label:"Tight"},{value:0,label:"Normal"},{value:.5,label:"Wide"},{value:1,label:"Wider"},{value:2,label:"Widest"}],Ba=[{value:0,label:"None"},{value:6,label:"Small"},{value:12,label:"Medium"},{value:18,label:"Large"},{value:24,label:"Extra Large"}];var $a=Ee('<div class="dropdown-menu heading-dropdown-menu svelte-1dqac8y"><button>Normal text</button> <button>Heading 1</button> <button>Heading 2</button> <button>Heading 3</button> <button>Heading 4</button> <div class="heading-divider svelte-1dqac8y"></div> <button>Quote</button></div>'),Wa=Ee("<option> </option>"),Na=Ee("<option> </option>"),Va=Ee("<button> </button>"),Ua=Ee("<button> </button>"),Xa=Ee("<button> </button>"),ja=Ee('<div class="dropdown-menu spacing-menu svelte-1dqac8y"><div class="dropdown-section svelte-1dqac8y"><label class="dropdown-label svelte-1dqac8y">Line Height</label> <div class="dropdown-options spacing-options svelte-1dqac8y"></div></div> <div class="dropdown-section svelte-1dqac8y"><label class="dropdown-label svelte-1dqac8y">Letter Spacing</label> <div class="dropdown-options spacing-options svelte-1dqac8y"></div></div> <div class="dropdown-section svelte-1dqac8y"><label class="dropdown-label svelte-1dqac8y">Paragraph Spacing</label> <div class="dropdown-options spacing-options svelte-1dqac8y"></div></div></div>'),Ya=Ee('<div class="dropdown-menu page-settings-menu svelte-1dqac8y"><div class="dropdown-section svelte-1dqac8y"><label class="dropdown-label svelte-1dqac8y">Page Size</label> <div class="dropdown-options svelte-1dqac8y"><button>A4</button> <button>A5</button> <button>Letter</button> <button>Legal</button> <button>US Textbook</button></div></div> <div class="dropdown-section svelte-1dqac8y"><label class="dropdown-label svelte-1dqac8y">Orientation</label> <div class="dropdown-options svelte-1dqac8y"><button><svg width="16" height="20" viewBox="0 0 16 20" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="1" y="1" width="14" height="18" rx="1"></rect></svg> Portrait</button> <button><svg width="20" height="16" viewBox="0 0 20 16" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="1" y="1" width="18" height="14" rx="1"></rect></svg> Landscape</button></div></div> <div class="dropdown-section svelte-1dqac8y"><label class="dropdown-label svelte-1dqac8y">Margins</label> <div class="dropdown-options margins-options svelte-1dqac8y"><button><svg width="24" height="30" viewBox="0 0 24 30" fill="none" stroke="currentColor" stroke-width="1"><rect x="1" y="1" width="22" height="28" rx="1"></rect><rect x="4" y="4" width="16" height="22" fill="#e0e0e0" stroke="none"></rect></svg> Normal</button> <button><svg width="24" height="30" viewBox="0 0 24 30" fill="none" stroke="currentColor" stroke-width="1"><rect x="1" y="1" width="22" height="28" rx="1"></rect><rect x="2" y="2" width="20" height="26" fill="#e0e0e0" stroke="none"></rect></svg> Narrow</button> <button><svg width="24" height="30" viewBox="0 0 24 30" fill="none" stroke="currentColor" stroke-width="1"><rect x="1" y="1" width="22" height="28" rx="1"></rect><rect x="6" y="6" width="12" height="18" fill="#e0e0e0" stroke="none"></rect></svg> Wide</button></div></div></div>'),Ga=Ee('<div class="dropdown-menu columns-menu svelte-1dqac8y"><div class="dropdown-section svelte-1dqac8y"><label class="dropdown-label svelte-1dqac8y">Columns</label> <div class="dropdown-options columns-options svelte-1dqac8y"><button><svg width="32" height="40" viewBox="0 0 32 40" fill="none" stroke="currentColor" stroke-width="1"><rect x="1" y="1" width="30" height="38" rx="1"></rect><rect x="4" y="4" width="24" height="32" fill="#e0e0e0" stroke="none"></rect></svg> One</button> <button><svg width="32" height="40" viewBox="0 0 32 40" fill="none" stroke="currentColor" stroke-width="1"><rect x="1" y="1" width="30" height="38" rx="1"></rect><rect x="4" y="4" width="11" height="32" fill="#e0e0e0" stroke="none"></rect><rect x="17" y="4" width="11" height="32" fill="#e0e0e0" stroke="none"></rect></svg> Two</button></div></div></div>'),Ka=Ee('<div class="toolbar svelte-1dqac8y"><div class="toolbar-group svelte-1dqac8y"><button class="toolbar-btn svelte-1dqac8y" title="Undo (Ctrl+Z)"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z"></path></svg></button> <button class="toolbar-btn svelte-1dqac8y" title="Redo (Ctrl+Y)"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M18.4 10.6C16.55 8.99 14.15 8 11.5 8c-4.65 0-8.58 3.03-9.96 7.22L3.9 16c1.05-3.19 4.05-5.5 7.6-5.5 1.95 0 3.73.72 5.12 1.88L13 16h9V7l-3.6 3.6z"></path></svg></button> <button class="toolbar-btn svelte-1dqac8y" title="Save (Ctrl+S)"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"></path></svg></button></div> <div class="toolbar-divider svelte-1dqac8y"></div> <div class="toolbar-group svelte-1dqac8y"><div class="dropdown-wrapper svelte-1dqac8y"><button title="Text style"><span class="heading-btn-label svelte-1dqac8y"> </span> <svg class="dropdown-arrow svelte-1dqac8y" width="12" height="12" viewBox="0 0 24 24" fill="currentColor"><path d="M7 10l5 5 5-5z"></path></svg></button> <!></div></div> <div class="toolbar-divider svelte-1dqac8y"></div> <div class="toolbar-group svelte-1dqac8y"><select class="toolbar-select font-family-select svelte-1dqac8y" title="Font family"></select> <button class="toolbar-btn font-size-btn svelte-1dqac8y" title="Decrease font size"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M5.12 14L7.5 7.67 9.87 14H5.12zM6.5 5L1 19h2.25l1.12-3h6.25l1.12 3H14L8.5 5h-2z"></path><path d="M18 7h-4v2h4v-2z"></path></svg></button> <select class="toolbar-select font-size-select svelte-1dqac8y" title="Font size"></select> <button class="toolbar-btn font-size-btn svelte-1dqac8y" title="Increase font size"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M5.12 14L7.5 7.67 9.87 14H5.12zM6.5 5L1 19h2.25l1.12-3h6.25l1.12 3H14L8.5 5h-2z"></path><path d="M20 9h-2v2h-2v2h2v2h2v-2h2v-2h-2V9z"></path></svg></button></div> <div class="toolbar-divider svelte-1dqac8y"></div> <div class="toolbar-group svelte-1dqac8y"><button class="toolbar-btn svelte-1dqac8y" title="Bold (Ctrl+B)"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M15.6 10.79c.97-.67 1.65-1.77 1.65-2.79 0-2.26-1.75-4-4-4H7v14h7.04c2.09 0 3.71-1.7 3.71-3.79 0-1.52-.86-2.82-2.15-3.42zM10 6.5h3c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5h-3v-3zm3.5 9H10v-3h3.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5z"></path></svg></button> <button class="toolbar-btn svelte-1dqac8y" title="Italic (Ctrl+I)"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M10 4v3h2.21l-3.42 8H6v3h8v-3h-2.21l3.42-8H18V4z"></path></svg></button> <button class="toolbar-btn svelte-1dqac8y" title="Underline (Ctrl+U)"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M12 17c3.31 0 6-2.69 6-6V3h-2.5v8c0 1.93-1.57 3.5-3.5 3.5S8.5 12.93 8.5 11V3H6v8c0 3.31 2.69 6 6 6zm-7 2v2h14v-2H5z"></path></svg></button> <button class="toolbar-btn svelte-1dqac8y" title="Strikethrough"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M10 19h4v-3h-4v3zM5 4v3h5v3h4V7h5V4H5zM3 14h18v-2H3v2z"></path></svg></button> <div class="color-picker-wrapper svelte-1dqac8y"><input type="color" class="color-input svelte-1dqac8y" value="#000000" title="Text color"/> <svg class="color-icon svelte-1dqac8y" width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M11 2L5.5 16h2.25l1.12-3h6.25l1.12 3h2.25L13 2h-2zm-1.38 9L12 4.67 14.38 11H9.62z"></path><rect x="5" y="18" width="14" height="3" fill="currentColor"></rect></svg></div> <div class="color-picker-wrapper svelte-1dqac8y"><input type="color" class="color-input svelte-1dqac8y" value="#FFFF00" title="Highlight color"/> <svg class="color-icon svelte-1dqac8y" width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M16.56 8.94L7.62 0 6.21 1.41l2.38 2.38-5.15 5.15c-.59.59-.59 1.54 0 2.12l5.5 5.5c.29.29.68.44 1.06.44s.77-.15 1.06-.44l5.5-5.5c.59-.58.59-1.53 0-2.12zM5.21 10L10 5.21 14.79 10H5.21zM19 11.5s-2 2.17-2 3.5c0 1.1.9 2 2 2s2-.9 2-2c0-1.33-2-3.5-2-3.5z"></path><rect x="4" y="18" width="14" height="3" fill="#FFFF00"></rect></svg></div></div> <div class="toolbar-divider svelte-1dqac8y"></div> <div class="toolbar-group svelte-1dqac8y"><button class="toolbar-btn svelte-1dqac8y" title="Align left"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M15 15H3v2h12v-2zm0-8H3v2h12V7zM3 13h18v-2H3v2zm0 8h18v-2H3v2zM3 3v2h18V3H3z"></path></svg></button> <button class="toolbar-btn svelte-1dqac8y" title="Align center"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M7 15v2h10v-2H7zm-4 6h18v-2H3v2zm0-8h18v-2H3v2zm4-6v2h10V7H7zM3 3v2h18V3H3z"></path></svg></button> <button class="toolbar-btn svelte-1dqac8y" title="Align right"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M3 21h18v-2H3v2zm6-4h12v-2H9v2zm-6-4h18v-2H3v2zm6-4h12V7H9v2zM3 3v2h18V3H3z"></path></svg></button> <button class="toolbar-btn svelte-1dqac8y" title="Justify"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M3 21h18v-2H3v2zm0-4h18v-2H3v2zm0-4h18v-2H3v2zm0-4h18V7H3v2zM3 3v2h18V3H3z"></path></svg></button> <div class="dropdown-wrapper svelte-1dqac8y"><button title="Line and paragraph spacing"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M6 7h2.5L5 3.5 1.5 7H4v10H1.5L5 20.5 8.5 17H6V7zm4-2v2h12V5H10zm0 14h12v-2H10v2zm0-6h12v-2H10v2z"></path></svg></button> <!></div></div> <div class="toolbar-divider svelte-1dqac8y"></div> <div class="toolbar-group svelte-1dqac8y"><button class="toolbar-btn svelte-1dqac8y" title="Bulleted list"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M4 10.5c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zm0-6c-.83 0-1.5.67-1.5 1.5S3.17 7.5 4 7.5 5.5 6.83 5.5 6 4.83 4.5 4 4.5zm0 12c-.83 0-1.5.68-1.5 1.5s.68 1.5 1.5 1.5 1.5-.68 1.5-1.5-.67-1.5-1.5-1.5zM7 19h14v-2H7v2zm0-6h14v-2H7v2zm0-8v2h14V5H7z"></path></svg></button> <button class="toolbar-btn svelte-1dqac8y" title="Numbered list"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M2 17h2v.5H3v1h1v.5H2v1h3v-4H2v1zm1-9h1V4H2v1h1v3zm-1 3h1.8L2 13.1v.9h3v-1H3.2L5 10.9V10H2v1zm5-6v2h14V5H7zm0 14h14v-2H7v2zm0-6h14v-2H7v2z"></path></svg></button></div> <div class="toolbar-divider svelte-1dqac8y"></div> <div class="toolbar-group svelte-1dqac8y"><button class="toolbar-btn svelte-1dqac8y" title="Insert image"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"></path></svg></button></div> <div class="toolbar-divider svelte-1dqac8y"></div> <div class="toolbar-group page-controls svelte-1dqac8y"><div class="dropdown-wrapper svelte-1dqac8y"><button title="Page settings"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M14 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V8l-6-6zM6 20V4h7v5h5v11H6z"></path></svg></button> <!></div> <div class="dropdown-wrapper svelte-1dqac8y"><button title="Columns"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><rect x="4" y="4" width="7" height="16" rx="1" stroke="currentColor" stroke-width="1.5" fill="none"></rect><rect x="13" y="4" width="7" height="16" rx="1" stroke="currentColor" stroke-width="1.5" fill="none"></rect></svg></button> <!></div></div> <div class="toolbar-divider svelte-1dqac8y"></div> <div class="toolbar-group zoom-controls svelte-1dqac8y"><button class="toolbar-btn svelte-1dqac8y" title="Zoom out"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14zM7 9h5v1H7z"></path></svg></button> <select class="toolbar-select zoom-select svelte-1dqac8y"><option>50%</option><option>75%</option><option>100%</option><option>125%</option><option>150%</option><option>200%</option></select> <button class="toolbar-btn svelte-1dqac8y" title="Zoom in"><svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14zm.5-7H9v2H7v1h2v2h1v-2h2V9h-2z"></path></svg></button></div> <div class="toolbar-spacer svelte-1dqac8y"></div> <div class="toolbar-group page-info svelte-1dqac8y"><span class="page-indicator svelte-1dqac8y"> </span></div></div>');function Ja(t,n){Dr(n,!0);const r=()=>Ne(Uo,"$fontSize",D),i=()=>Ne(Ui,"$fontFamily",D),l=()=>Ne(Xi,"$lineHeight",D),s=()=>Ne(ji,"$letterSpacing",D),v=()=>Ne(Yi,"$paragraphSpacing",D),h=()=>Ne(Wt,"$pageConfig",D),c=()=>Ne(fi,"$zoomLevel",D),p=()=>Ne(zr,"$currentPage",D),C=()=>Ne(Vo,"$totalPages",D),[D,I]=us();let x=js(n,"canUndo",3,!1),B=js(n,"canRedo",3,!1),U=V(!1),d=V(!1),w=V(!1),L=V(!1),oe=V("p");fs(()=>{const N=ee=>{ee.target.closest(".dropdown-wrapper")||(f(U,!1),f(d,!1),f(w,!1),f(L,!1))};return document.addEventListener("click",N),()=>document.removeEventListener("click",N)});const fe={p:"Normal text",h1:"Heading 1",h2:"Heading 2",h3:"Heading 3",h4:"Heading 4",blockquote:"Quote"};function pe(N){f(oe,N,!0),ge("formatBlock",N),f(w,!1)}function Pe(N){fi.update(ee=>Math.min(200,Math.max(25,ee+N)))}function y(N){fi.set(N)}function F(N){Wt.update(ee=>({...ee,format:$o[N]}))}function G(N){const ee={default:Vi,narrow:Ys,wide:Gs};Wt.update(_e=>({..._e,margins:ee[N]}))}function K(N){Wt.update(ee=>({...ee,columns:N}))}function ge(N,ee){n.onFormat(N,ee)}function fn(N){ge("fontSize",N.toString())}function Kn(){const N=or.indexOf(r());N<or.length-1&&fn(or[N+1])}function Jn(){const N=or.indexOf(r());N>0&&fn(or[N-1])}function Mn(N){Ui.set(N)}var dn=Ka(),jt=q(dn),hn=q(jt);hn.__click=()=>ge("undo");var Ye=m(hn,2);Ye.__click=()=>ge("redo");var br=m(Ye,2);br.__click=()=>n.onSave?.();var Ct=m(jt,4),vn=q(Ct),qt=q(vn);let pn;qt.__click=()=>{f(w,!e(w)),f(U,!1),f(d,!1)};var $=q(qt),W=q($),le=m(qt,2);{var Ve=N=>{var ee=$a();ee.__click=Qt=>Qt.stopPropagation();var _e=q(ee);let Xe;_e.__click=()=>pe("p");var Ce=m(_e,2);let yt;Ce.__click=()=>pe("h1");var it=m(Ce,2);let ft;it.__click=()=>pe("h2");var Oe=m(it,2);let te;Oe.__click=()=>pe("h3");var Me=m(Oe,2);let Le;Me.__click=()=>pe("h4");var st=m(Me,4);let Rn;st.__click=()=>pe("blockquote"),Be(()=>{Xe=Z(_e,1,"heading-option style-p svelte-1dqac8y",null,Xe,{selected:e(oe)==="p"}),yt=Z(Ce,1,"heading-option style-h1 svelte-1dqac8y",null,yt,{selected:e(oe)==="h1"}),ft=Z(it,1,"heading-option style-h2 svelte-1dqac8y",null,ft,{selected:e(oe)==="h2"}),te=Z(Oe,1,"heading-option style-h3 svelte-1dqac8y",null,te,{selected:e(oe)==="h3"}),Le=Z(Me,1,"heading-option style-h4 svelte-1dqac8y",null,Le,{selected:e(oe)==="h4"}),Rn=Z(st,1,"heading-option style-blockquote svelte-1dqac8y",null,Rn,{selected:e(oe)==="blockquote"})}),we(N,ee)};pt(le,N=>{e(w)&&N(Ve)})}var ct=m(Ct,4),re=q(ct);re.__change=N=>Mn(N.currentTarget.value),Sn(re,21,()=>qa,Bn,(N,ee)=>{var _e=Wa(),Xe=q(_e),Ce={};Be(()=>{Wi(_e,`font-family: ${e(ee)??""}`),Rt(Xe,e(ee)),Ce!==(Ce=e(ee))&&(_e.value=(_e.__value=e(ee))??"")}),we(N,_e)});var xe;Li(re);var Tt=m(re,2);Tt.__click=Jn;var Ue=m(Tt,2);Ue.__change=N=>fn(parseInt(N.currentTarget.value)),Sn(Ue,21,()=>or,Bn,(N,ee)=>{var _e=Na(),Xe=q(_e),Ce={};Be(()=>{Rt(Xe,e(ee)),Ce!==(Ce=e(ee))&&(_e.value=(_e.__value=e(ee))??"")}),we(N,_e)});var gn;Li(Ue);var He=m(Ue,2);He.__click=Kn;var bt=m(ct,4),ut=q(bt);ut.__click=()=>ge("bold");var En=m(ut,2);En.__click=()=>ge("italic");var _n=m(En,2);_n.__click=()=>ge("underline");var Ge=m(_n,2);Ge.__click=()=>ge("strikeThrough");var he=m(Ge,2),Yt=q(he);Yt.__change=N=>ge("foreColor",N.currentTarget.value);var It=m(he,2),ze=q(It);ze.__change=N=>ge("hiliteColor",N.currentTarget.value);var Ae=m(bt,4),Re=q(Ae);Re.__click=()=>ge("justifyLeft");var Zn=m(Re,2);Zn.__click=()=>ge("justifyCenter");var Gt=m(Zn,2);Gt.__click=()=>ge("justifyRight");var j=m(Gt,2);j.__click=()=>ge("justifyFull");var Ft=m(j,2),zn=q(Ft);let Kt;zn.__click=()=>{f(L,!e(L)),f(U,!1),f(d,!1),f(w,!1)};var Jt=m(zn,2);{var Ur=N=>{var ee=ja();ee.__click=Oe=>Oe.stopPropagation();var _e=q(ee),Xe=m(q(_e),2);Sn(Xe,21,()=>Fa,Bn,(Oe,te)=>{var Me=Va();let Le;Me.__click=()=>Xi.set(e(te).value);var st=q(Me);Be(()=>{Le=Z(Me,1,"dropdown-option spacing-option svelte-1dqac8y",null,Le,{selected:l()===e(te).value}),Rt(st,e(te).label)}),we(Oe,Me)});var Ce=m(_e,2),yt=m(q(Ce),2);Sn(yt,21,()=>Da,Bn,(Oe,te)=>{var Me=Ua();let Le;Me.__click=()=>ji.set(e(te).value);var st=q(Me);Be(()=>{Le=Z(Me,1,"dropdown-option spacing-option svelte-1dqac8y",null,Le,{selected:s()===e(te).value}),Rt(st,e(te).label)}),we(Oe,Me)});var it=m(Ce,2),ft=m(q(it),2);Sn(ft,21,()=>Ba,Bn,(Oe,te)=>{var Me=Xa();let Le;Me.__click=()=>Yi.set(e(te).value);var st=q(Me);Be(()=>{Le=Z(Me,1,"dropdown-option spacing-option svelte-1dqac8y",null,Le,{selected:v()===e(te).value}),Rt(st,e(te).label)}),we(Oe,Me)}),we(N,ee)};pt(Jt,N=>{e(L)&&N(Ur)})}var yr=m(Ae,4),Mt=q(yr);Mt.__click=()=>ge("insertUnorderedList");var wr=m(Mt,2);wr.__click=()=>ge("insertOrderedList");var nt=m(yr,4),Et=q(nt);Et.__click=()=>ge("insertImage");var mr=m(nt,4),xr=q(mr),$e=q(xr);let bn;$e.__click=()=>{f(U,!e(U)),f(d,!1)};var zt=m($e,2);{var Xr=N=>{var ee=Ya();ee.__click=Hn=>Hn.stopPropagation();var _e=q(ee),Xe=m(q(_e),2),Ce=q(Xe);let yt;Ce.__click=()=>F("A4");var it=m(Ce,2);let ft;it.__click=()=>F("A5");var Oe=m(it,2);let te;Oe.__click=()=>F("LETTER");var Me=m(Oe,2);let Le;Me.__click=()=>F("LEGAL");var st=m(Me,2);let Rn;st.__click=()=>F("TEXTBOOK");var Qt=m(_e,2),Cr=m(q(Qt),2),be=q(Cr);let Kr;be.__click=()=>Wt.update(Hn=>({...Hn,orientation:"portrait"}));var Jr=m(be,2);let Zr;Jr.__click=()=>Wt.update(Hn=>({...Hn,orientation:"landscape"}));var Qr=m(Qt,2),Ci=m(q(Qr),2),Tr=q(Ci);let $t;Tr.__click=()=>G("default");var nr=m(Tr,2);let ei;nr.__click=()=>G("narrow");var ti=m(nr,2);let ni;ti.__click=()=>G("wide"),Be(()=>{yt=Z(Ce,1,"dropdown-option svelte-1dqac8y",null,yt,{selected:h().format.name==="A4"}),ft=Z(it,1,"dropdown-option svelte-1dqac8y",null,ft,{selected:h().format.name==="A5"}),te=Z(Oe,1,"dropdown-option svelte-1dqac8y",null,te,{selected:h().format.name==="Letter"}),Le=Z(Me,1,"dropdown-option svelte-1dqac8y",null,Le,{selected:h().format.name==="Legal"}),Rn=Z(st,1,"dropdown-option svelte-1dqac8y",null,Rn,{selected:h().format.name==="US Textbook"}),Kr=Z(be,1,"dropdown-option orientation-option svelte-1dqac8y",null,Kr,{selected:h().orientation==="portrait"}),Zr=Z(Jr,1,"dropdown-option orientation-option svelte-1dqac8y",null,Zr,{selected:h().orientation==="landscape"}),$t=Z(Tr,1,"dropdown-option margin-option svelte-1dqac8y",null,$t,{selected:h().margins===Vi}),ei=Z(nr,1,"dropdown-option margin-option svelte-1dqac8y",null,ei,{selected:h().margins===Ys}),ni=Z(ti,1,"dropdown-option margin-option svelte-1dqac8y",null,ni,{selected:h().margins===Gs})}),we(N,ee)};pt(zt,N=>{e(U)&&N(Xr)})}var jr=m(xr,2),yn=q(jr);let Ln;yn.__click=()=>{f(d,!e(d)),f(U,!1)};var Qn=m(yn,2);{var ie=N=>{var ee=Ga();ee.__click=Oe=>Oe.stopPropagation();var _e=q(ee),Xe=m(q(_e),2),Ce=q(Xe);let yt;Ce.__click=()=>{K(1),f(d,!1)};var it=m(Ce,2);let ft;it.__click=()=>{K(2),f(d,!1)},Be(()=>{yt=Z(Ce,1,"dropdown-option column-option svelte-1dqac8y",null,yt,{selected:h().columns===1}),ft=Z(it,1,"dropdown-option column-option svelte-1dqac8y",null,ft,{selected:h().columns===2})}),we(N,ee)};pt(Qn,N=>{e(d)&&N(ie)})}var An=m(mr,4),Zt=q(An);Zt.__click=()=>Pe(-10);var Dt=m(Zt,2);Dt.__change=N=>y(parseInt(N.currentTarget.value));var kr=q(Dt);kr.value=kr.__value="50";var Pn=m(kr);Pn.value=Pn.__value="75";var wn=m(Pn);wn.value=wn.__value="100";var er=m(wn);er.value=er.__value="125";var Bt=m(er);Bt.value=Bt.__value="150";var Yr=m(Bt);Yr.value=Yr.__value="200";var tr;Li(Dt);var ki=m(Dt,2);ki.__click=()=>Pe(10);var Si=m(An,4),Gr=q(Si),Sr=q(Gr);Be(()=>{hn.disabled=!x(),Ye.disabled=!B(),pn=Z(qt,1,"toolbar-btn heading-dropdown-btn svelte-1dqac8y",null,pn,{active:e(w)}),Rt(W,fe[e(oe)]),xe!==(xe=i())&&(re.value=(re.__value=i())??"",ui(re,i())),gn!==(gn=r())&&(Ue.value=(Ue.__value=r())??"",ui(Ue,r())),Kt=Z(zn,1,"toolbar-btn svelte-1dqac8y",null,Kt,{active:e(L)}),bn=Z($e,1,"toolbar-btn svelte-1dqac8y",null,bn,{active:e(U)}),Ln=Z(yn,1,"toolbar-btn svelte-1dqac8y",null,Ln,{active:e(d)}),tr!==(tr=c())&&(Dt.value=(Dt.__value=c())??"",ui(Dt,c())),Rt(Sr,`Page ${p()??""} of ${C()??""}`)}),we(t,dn),Br(),I()}Vr(["click","change"]);const lr="ï¿¼",Ks="ï¿½";function Pt(){return{align:"left",listType:"none",blockType:"p",indent:0}}function Ri(t){return{paragraphs:[...t.paragraphs],paragraphMeta:t.paragraphMeta.map(n=>({...n})),images:t.images.map(n=>({...n})),cursorPara:t.cursorPara,cursorOffset:t.cursorOffset,selectionStart:t.selectionStart?{...t.selectionStart}:null,selectionEnd:t.selectionEnd?{...t.selectionEnd}:null}}function Za(t,n){if(t.paragraphs.length!==n.paragraphs.length||t.images.length!==n.images.length)return!1;for(let r=0;r<t.paragraphs.length;r++)if(t.paragraphs[r]!==n.paragraphs[r])return!1;for(let r=0;r<t.paragraphMeta.length;r++){const i=t.paragraphMeta[r],l=n.paragraphMeta[r];if(i.align!==l.align||i.listType!==l.listType||i.blockType!==l.blockType||i.indent!==l.indent||i.fontSize!==l.fontSize||i.textColor!==l.textColor)return!1}for(let r=0;r<t.images.length;r++){const i=t.images[r],l=n.images[r];if(i.id!==l.id||i.width!==l.width||i.height!==l.height||i.wrapStyle!==l.wrapStyle||i.x!==l.x||i.y!==l.y)return!1}return!0}function Qa(t=100){let n=[],r=[];return{push(i){const l=Ri(i);n.length>0&&Za(n[n.length-1],l)||(n.push(l),r=[],n.length>t&&n.shift())},undo(){if(n.length<2)return null;const i=n.pop();r.push(i);const l=n[n.length-1];return Ri(l)},redo(){if(r.length===0)return null;const i=r.pop();return n.push(i),Ri(i)},canUndo(){return n.length>=2},canRedo(){return r.length>0},clear(){n=[],r=[]},size(){return n.length}}}function ec(t,n=300){let r=null,i=null;return{schedulePush(l){i=l,r!==null&&clearTimeout(r),r=setTimeout(()=>{i&&(t.push(i),i=null),r=null},n)},cancelPush(){r!==null&&(clearTimeout(r),r=null),i=null},flushPush(){r!==null&&(clearTimeout(r),r=null),i&&(t.push(i),i=null)}}}var tc=Ee("<canvas></canvas>"),nc=Ee('<div class="popup-overlay svelte-1h8xysy"><div class="popup-dialog svelte-1h8xysy"><div class="popup-header svelte-1h8xysy"><h3 class="svelte-1h8xysy">Insert Image</h3> <button class="popup-close svelte-1h8xysy">&times;</button></div> <div class="popup-content svelte-1h8xysy"><div class="input-section svelte-1h8xysy"><label for="image-url" class="svelte-1h8xysy">Image URL</label> <div class="url-input-row svelte-1h8xysy"><input id="image-url" type="text" placeholder="https://example.com/image.jpg" class="svelte-1h8xysy"/> <button class="svelte-1h8xysy">Insert</button></div></div> <div class="divider svelte-1h8xysy"><span class="svelte-1h8xysy">or</span></div>  <div><svg width="48" height="48" viewBox="0 0 24 24" fill="#9aa0a6"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"></path></svg> <p class="svelte-1h8xysy">Drag and drop an image here</p> <p class="small svelte-1h8xysy">or click to select from your computer</p></div> <input id="file-input" type="file" accept="image/*" class="file-input svelte-1h8xysy"/> <p class="tip svelte-1h8xysy">Tip: You can also paste an image directly in the editor (Ctrl+V)</p></div></div></div>'),rc=Ee('<div class="image-options-section svelte-1h8xysy"><div class="section-label svelte-1h8xysy">Horizontal Position</div> <div class="image-options-buttons svelte-1h8xysy"><button title="Align left"><svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" class="svelte-1h8xysy"><rect x="2" y="6" width="10" height="12" rx="1" stroke="currentColor" stroke-width="1.5" fill="none"></rect></svg></button> <button title="Center"><svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" class="svelte-1h8xysy"><rect x="7" y="6" width="10" height="12" rx="1" stroke="currentColor" stroke-width="1.5" fill="none"></rect></svg></button> <button title="Align right"><svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" class="svelte-1h8xysy"><rect x="12" y="6" width="10" height="12" rx="1" stroke="currentColor" stroke-width="1.5" fill="none"></rect></svg></button></div></div>'),ic=Ee('<div class="image-options-overlay svelte-1h8xysy"><div class="image-options-popup svelte-1h8xysy"><div class="image-options-header svelte-1h8xysy"><span>Layout Options</span> <button class="popup-close svelte-1h8xysy">&times;</button></div> <div class="image-options-section svelte-1h8xysy"><div class="section-label svelte-1h8xysy">In Line with Text</div> <div class="image-options-buttons svelte-1h8xysy"><button title="In line with text"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" class="svelte-1h8xysy"><line x1="2" y1="8" x2="8" y2="8" stroke="currentColor" stroke-width="1.5"></line><rect x="9" y="5" width="6" height="6" rx="1" stroke="currentColor" stroke-width="1.5" fill="none"></rect><line x1="16" y1="8" x2="22" y2="8" stroke="currentColor" stroke-width="1.5"></line><line x1="2" y1="14" x2="22" y2="14" stroke="currentColor" stroke-width="1.5"></line><line x1="2" y1="18" x2="22" y2="18" stroke="currentColor" stroke-width="1.5"></line></svg> <span>In Line</span></button></div></div> <div class="image-options-section svelte-1h8xysy"><div class="section-label svelte-1h8xysy">With Text Wrapping</div> <div class="image-options-buttons wrap-buttons svelte-1h8xysy"><button title="Square - text wraps in a square around the image"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" class="svelte-1h8xysy"><rect x="2" y="4" width="8" height="8" rx="1" stroke="currentColor" stroke-width="1.5" fill="none"></rect><line x1="12" y1="5" x2="22" y2="5" stroke="currentColor" stroke-width="1.5"></line><line x1="12" y1="8" x2="22" y2="8" stroke="currentColor" stroke-width="1.5"></line><line x1="12" y1="11" x2="22" y2="11" stroke="currentColor" stroke-width="1.5"></line><line x1="2" y1="15" x2="22" y2="15" stroke="currentColor" stroke-width="1.5"></line><line x1="2" y1="19" x2="22" y2="19" stroke="currentColor" stroke-width="1.5"></line></svg> <span>Square</span></button> <button title="Tight - text wraps tightly around the image"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" class="svelte-1h8xysy"><path d="M3 5 L9 5 L9 11 L3 11 Z" stroke="currentColor" stroke-width="1.5" fill="none"></path><line x1="11" y1="5" x2="21" y2="5" stroke="currentColor" stroke-width="1.5"></line><line x1="11" y1="8" x2="21" y2="8" stroke="currentColor" stroke-width="1.5"></line><line x1="11" y1="11" x2="21" y2="11" stroke="currentColor" stroke-width="1.5"></line><line x1="3" y1="14" x2="21" y2="14" stroke="currentColor" stroke-width="1.5"></line><line x1="3" y1="18" x2="21" y2="18" stroke="currentColor" stroke-width="1.5"></line></svg> <span>Tight</span></button> <button title="Through - text flows through the image"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" class="svelte-1h8xysy"><path d="M4 4 L10 4 L10 10 L4 10 Z" stroke="currentColor" stroke-width="1.5" fill="none" stroke-dasharray="2,1"></path><line x1="12" y1="5" x2="20" y2="5" stroke="currentColor" stroke-width="1.5"></line><line x1="12" y1="9" x2="20" y2="9" stroke="currentColor" stroke-width="1.5"></line><line x1="4" y1="14" x2="20" y2="14" stroke="currentColor" stroke-width="1.5"></line><line x1="4" y1="18" x2="20" y2="18" stroke="currentColor" stroke-width="1.5"></line></svg> <span>Through</span></button> <button title="Top and Bottom - text above and below only"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" class="svelte-1h8xysy"><line x1="2" y1="4" x2="22" y2="4" stroke="currentColor" stroke-width="1.5"></line><rect x="6" y="8" width="12" height="8" rx="1" stroke="currentColor" stroke-width="1.5" fill="none"></rect><line x1="2" y1="20" x2="22" y2="20" stroke="currentColor" stroke-width="1.5"></line></svg> <span>Top/Bottom</span></button> <button title="Behind Text - image appears behind text"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" class="svelte-1h8xysy"><rect x="6" y="6" width="12" height="12" rx="1" stroke="currentColor" stroke-width="1.5" fill="none" opacity="0.5"></rect><line x1="2" y1="8" x2="22" y2="8" stroke="currentColor" stroke-width="1.5"></line><line x1="2" y1="12" x2="22" y2="12" stroke="currentColor" stroke-width="1.5"></line><line x1="2" y1="16" x2="22" y2="16" stroke="currentColor" stroke-width="1.5"></line></svg> <span>Behind</span></button> <button title="In Front of Text - image appears in front of text"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" class="svelte-1h8xysy"><line x1="2" y1="8" x2="22" y2="8" stroke="currentColor" stroke-width="1.5" opacity="0.5"></line><line x1="2" y1="12" x2="22" y2="12" stroke="currentColor" stroke-width="1.5" opacity="0.5"></line><line x1="2" y1="16" x2="22" y2="16" stroke="currentColor" stroke-width="1.5" opacity="0.5"></line><rect x="6" y="6" width="12" height="12" rx="1" stroke="currentColor" stroke-width="1.5" fill="white"></rect></svg> <span>In Front</span></button></div></div> <!> <div class="image-options-section svelte-1h8xysy"><div class="section-label svelte-1h8xysy">Position</div> <div class="position-radio-group svelte-1h8xysy"><label class="radio-option svelte-1h8xysy"><input type="radio" name="positionMode" class="svelte-1h8xysy"/> <span>Move with text</span></label> <label class="radio-option svelte-1h8xysy"><input type="radio" name="positionMode" class="svelte-1h8xysy"/> <span>Fix position on page</span></label></div></div> <div class="image-options-section svelte-1h8xysy"><div class="section-label svelte-1h8xysy">Edit</div> <div class="image-options-buttons svelte-1h8xysy"><button class="layout-btn svelte-1h8xysy" title="Crop image"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" class="svelte-1h8xysy"><path d="M17 15h2V7c0-1.1-.9-2-2-2H9v2h8v8zM7 17V1H5v4H1v2h4v10c0 1.1.9 2 2 2h10v4h2v-4h4v-2H7z"></path></svg> <span>Crop</span></button> <button class="layout-btn svelte-1h8xysy" title="Reset crop"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" class="svelte-1h8xysy"><path d="M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"></path></svg> <span>Reset</span></button></div></div> <button class="delete-image-btn svelte-1h8xysy"><svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"></path></svg> Delete Image</button></div></div>'),sc=Ee('<div class="crop-mode-bar svelte-1h8xysy"><span>Crop Mode - Drag handles to adjust crop area</span> <div class="crop-mode-buttons svelte-1h8xysy"><button class="crop-btn done svelte-1h8xysy">Done</button> <button class="crop-btn reset svelte-1h8xysy">Reset</button> <button class="crop-btn cancel svelte-1h8xysy">Cancel</button></div></div>'),oc=Ee('<div class="editor-wrapper svelte-1h8xysy"><!> <canvas class="measure-canvas svelte-1h8xysy"></canvas>  <textarea class="hidden-input svelte-1h8xysy" autocomplete="off"></textarea> <div class="editor-container svelte-1h8xysy"><div class="canvas-container svelte-1h8xysy"></div></div> <div class="page-indicator svelte-1h8xysy"> </div> <!> <!> <!></div>');function lc(t,n){Dr(n,!0);const r=()=>Ne(Uo,"$fontSizeStore",C),i=()=>Ne(Ui,"$fontFamilyStore",C),l=()=>Ne(Xi,"$lineHeightStore",C),s=()=>Ne(ji,"$letterSpacingStore",C),v=()=>Ne(Yi,"$paragraphSpacingStore",C),h=()=>Ne(Wt,"$pageConfig",C),c=()=>Ne(fi,"$zoomLevel",C),p=()=>Ne(zr,"$currentPage",C),[C,D]=us();let I,x,B,U,d=V(vt([""])),w=V(vt([Pt()])),L=V(vt([])),oe=new Map,fe=V(!1),pe=V(""),Pe=V(!1),y=V(0),F=V(0),G=V(null),K=V(null);const ge=Qa(100),{schedulePush:fn,cancelPush:Kn,flushPush:Jn}=ec(ge,500);let Mn=V(!1),dn=V(!1);function jt(){return{paragraphs:[...e(d)],paragraphMeta:e(w).map(o=>({...o})),images:e(L).map(o=>({...o})),cursorPara:e(y),cursorOffset:e(F),selectionStart:e(G)?{...e(G)}:null,selectionEnd:e(K)?{...e(K)}:null}}function hn(o){f(d,[...o.paragraphs],!0),f(w,o.paragraphMeta.map(a=>({...a})),!0),f(L,o.images.map(a=>({...a})),!0),f(y,o.cursorPara,!0),f(F,o.cursorOffset,!0),f(G,o.selectionStart?{...o.selectionStart}:null,!0),f(K,o.selectionEnd?{...o.selectionEnd}:null,!0),te(),be()}function Ye(){Jn(),ge.push(jt()),Ct()}function br(){fn(jt()),Ct()}function Ct(){f(Mn,ge.canUndo(),!0),f(dn,ge.canRedo(),!0)}function vn(){Kn();const o=ge.undo();o&&(hn(o),Ct())}function qt(){Kn();const o=ge.redo();o&&(hn(o),Ct())}function pn(){const o={version:1,savedAt:new Date().toISOString(),paragraphs:e(d),paragraphMeta:e(w),images:e(L).map(g=>({...g}))},a=JSON.stringify(o,null,2),u=new Blob([a],{type:"application/json"}),b=URL.createObjectURL(u),_=document.createElement("a");_.href=b,_.download=`document-${new Date().toISOString().slice(0,10)}.json`,document.body.appendChild(_),_.click(),document.body.removeChild(_),URL.revokeObjectURL(b)}let $=Ie(r),W=Ie(i),le=Ie(l),Ve=Ie(s),ct=Ie(v),re=V(!1),xe=V(!1),Tt=V(!1),Ue=V(!1),gn=Ie(()=>ds(h())),He=Ie(()=>hs(h())),bt=Ie(()=>e(gn).height*c()/100),ut=Ie(()=>e(gn).width*c()/100),En=Ie(()=>e(He).height*c()/100),_n=Ie(()=>e(He).width*c()/100),Ge=Ie(()=>St(h().margins.top)*c()/100),he=Ie(()=>St(h().margins.left)*c()/100),Yt=Ie(()=>h().columns||1),It=Ie(()=>St(h().columnGap||10)*c()/100),ze=Ie(()=>Wo(h())*c()/100),Ae=Ie(()=>e($)*c()/100),Re=Ie(()=>e(Ae)*e(le)),Zn=Ie(()=>Math.floor(e(En)/e(Re))),Gt=Ie(()=>e(Zn)*e(Yt)),j=V(null),Ft=V(!1),zn=V(vt({x:0,y:0})),Kt=V(!1),Jt=V(null),Ur=V(0),yr=V(0),Mt=V(0),wr=V(0),nt=V(!1),Et=V(null),mr=V(0),xr=V(0),$e=V(vt({top:0,right:0,bottom:0,left:0})),bn=V(vt({top:0,right:0,bottom:0,left:0})),zt=V(!1),Xr=V(0),jr=V(0),yn=V(0),Ln=V(0),Qn=V(vt([])),ie=V(vt([])),An=Ie(()=>Math.max(1,Math.ceil(e(ie).length/e(Gt)))),Zt=[];function Dt(o){switch(o){case"nw":case"se":return"nwse-resize";case"ne":case"sw":return"nesw-resize";case"n":case"s":return"ns-resize";case"e":case"w":return"ew-resize";default:return"default"}}let kr=Ie(()=>e(Kt)&&e(Jt)?Dt(e(Jt)):e(nt)&&e(Et)?Dt(e(Et)):e(zt)?"move":e(j)?"default":"text"),Pn=!1,wn=null;function er(){Pn||(Pn=!0,wn=requestAnimationFrame(()=>{Pn=!1,wn=null,Jr()}))}const Bt=new Map,Yr=2e3;let tr=0;function ki(o,a){const u=a?.fontSize??e($),b=a?.blockType??"p";return`${o}|${u}|${b}|${e(W)}|${e(re)}|${e(xe)}|${c()}|${e(Ve)}`}function Si(){if(Bt.size<=Yr)return;const o=Array.from(Bt.entries());o.sort((u,b)=>u[1].lastAccess-b[1].lastAccess);const a=Math.floor(o.length*.25);for(let u=0;u<a;u++)Bt.delete(o[u][0])}function Gr(){Bt.clear(),tr=0}let Sr=V(0),N=V(2);const ee=1;function _e(){if(!x)return;const o=x.scrollTop,a=x.clientHeight,u=e(bt)+20,b=Math.floor(o/u),_=Math.ceil((o+a)/u),g=Math.max(0,b-ee),E=Math.min(e(An),_+ee);(g!==e(Sr)||E!==e(N))&&(f(Sr,g,!0),f(N,E,!0),er())}let Xe=new Set,Ce=!0;function yt(){Ce=!0,Xe.clear()}function it(){return`${e(xe)?"italic ":""}${e(re)?"bold ":""}${e(Ae)}px ${e(W)}`}function ft(o,a){const u=ki(o,a),b=Bt.get(u);if(b!==void 0)return b.lastAccess=++tr,b.width;if(!U)return o.length*e(Ae)*.5;const _=U.getContext("2d");if(!_)return o.length*e(Ae)*.5;let g=e(Ae),E=e(re)?"bold ":"",k=e(xe)?"italic ":"";if(a){const H=a.fontSize?a.fontSize*c()/100:e(Ae);switch(a.blockType){case"h1":g=H*2,E="bold ";break;case"h2":g=H*1.5,E="bold ";break;case"h3":g=H*1.17,E="bold ";break;case"h4":g=H,E="bold ";break;case"blockquote":g=H,k="italic ";break;default:g=H}}_.font=`${k}${E}${g}px ${e(W)}`;const S=_.measureText(o).width,M=e(Ve)*c()/100,A=S+(o.length>0?(o.length-1)*M:0);return Bt.set(u,{width:A,lastAccess:++tr}),Si(),A}function Oe(o,a,u,b){const _=e(w)[o]||Pt(),g=_.fontSize?_.fontSize*c()/100:e(Ae);let E=g;switch(_.blockType){case"h1":E=g*2;break;case"h2":E=g*1.5;break;case"h3":E=g*1.17;break}const k=_.listType!=="none"?E*1.5:0,S=b?b.width+10:0,A=(e(ze)>0?e(ze):e(_n)>0?e(_n):500)-k-S;if(!a)return[{paraIndex:o,startOffset:0,endOffset:0,text:"",meta:_,listNumber:u,floatReduction:b}];const H=[];let P=0;for(;P<a.length;){const X=a.substring(P);if(ft(X,_)<=A){H.push({paraIndex:o,startOffset:P,endOffset:a.length,text:X,meta:_,listNumber:H.length===0?u:void 0,floatReduction:b});break}let Q=P,T=P;for(let O=P+1;O<=a.length;O++){const R=a.substring(P,O),z=ft(R,_);if(O>P&&a[O-1]===" "&&(T=O),z>A){T>P?Q=T:Q=Math.max(P+1,O-1);break}Q=O}for(Q<=P&&(Q=P+1),H.push({paraIndex:o,startOffset:P,endOffset:Q,text:a.substring(P,Q),meta:_,listNumber:H.length===0?u:void 0,floatReduction:b}),P=Q;P<a.length&&a[P]===" ";)P++}return H}function te(){const o=[],a=[];let u=0;const b=A=>A==="square"||A==="tight"||A==="through";for(let A=0;A<e(d).length;A++){const H=e(d)[A];if(H.startsWith(lr)){const P=H.substring(1),X=e(L).find(Q=>Q.id===P);if(X&&b(X.wrapStyle)){const Q=X.width*c()/100,T=X.height*c()/100,O=Math.ceil(T/e(Re));if(X.y!==void 0){const R=e($)*e(le),z=Math.floor(X.y/R);let ae;if(X.horizontalAlign==="right")ae="right";else if(X.horizontalAlign==="center"){const ne=e(He).width/2;ae=(X.x??0)+X.width/2<ne?"left":"right"}else ae="left";a.push({id:P,startLine:z,endLine:z+O,width:Q,side:ae})}}}}for(let A=0;A<e(d).length;A++){const H=e(w)[A]||Pt(),P=e(d)[A];if(P===Ks){o.push({paraIndex:A,startOffset:0,endOffset:1,text:"",meta:H,isPageBreak:!0});continue}if(P.startsWith(lr)){const R=P.substring(1),z=e(L).find(ae=>ae.id===R);if(z){const ae=z.width*c()/100,ne=z.height*c()/100,ce=Math.ceil(ne/e(Re));if(b(z.wrapStyle)){if(z.y===void 0){const J=o.length;if(!a.find(Te=>Te.id===R)){let Te;if(z.horizontalAlign==="right")Te="right";else if(z.horizontalAlign==="center"){const Fe=e(He).width/2;Te=(z.x??0)+z.width/2<Fe?"left":"right"}else Te="left";a.push({id:R,startLine:J,endLine:J+ce,width:ae,side:Te})}}o.push({paraIndex:A,startOffset:0,endOffset:P.length,text:"",meta:H,isImage:!0,imageId:R,imageHeight:ce})}else if(z.wrapStyle==="inline"){o.push({paraIndex:A,startOffset:0,endOffset:P.length,text:"",meta:H,isImage:!0,imageId:R,imageHeight:ce});for(let J=1;J<ce;J++)o.push({paraIndex:A,startOffset:0,endOffset:P.length,text:"",meta:H,isImage:!0,imageId:R,imageHeight:0})}else if(z.wrapStyle==="top-bottom"){o.push({paraIndex:A,startOffset:0,endOffset:P.length,text:"",meta:H,isImage:!0,imageId:R,imageHeight:ce});for(let J=1;J<ce;J++)o.push({paraIndex:A,startOffset:0,endOffset:P.length,text:"",meta:H,isImage:!0,imageId:R,imageHeight:0})}else if(z.wrapStyle==="behind"||z.wrapStyle==="in-front")o.push({paraIndex:A,startOffset:0,endOffset:P.length,text:"",meta:H,isImage:!0,imageId:R,imageHeight:0});else{o.push({paraIndex:A,startOffset:0,endOffset:P.length,text:"",meta:H,isImage:!0,imageId:R,imageHeight:ce});for(let J=1;J<ce;J++)o.push({paraIndex:A,startOffset:0,endOffset:P.length,text:"",meta:H,isImage:!0,imageId:R})}}continue}let X;H.listType==="numbered"?(u++,X=u):(H.listType==="bullet"&&(X=void 0),u=0);const Q=o.length;let T;for(const R of a)if(Q>=R.startLine&&Q<R.endLine){T={side:R.side,width:R.width};break}const O=Oe(A,P,X,T);for(let R=0;R<O.length;R++){const z=o.length;let ae;for(const ne of a)if(z>=ne.startLine&&z<ne.endLine){ae={side:ne.side,width:ne.width};break}O[R].floatReduction=ae,R===O.length-1&&(O[R].isLastLineOfParagraph=!0),o.push(O[R])}}const _=e(ct)*c()/100;let g=0,E=0,k=0;const S=e(En);for(let A=0;A<o.length;A++){const H=o[A];if(H.isPageBreak){H.pageIndex=E,H.yPosition=g,H.columnIndex=k,E++,k=0,g=0;continue}let P=e(Re);H.isImage&&H.imageHeight&&(P=H.imageHeight*e(Re));const X=H.isLastLineOfParagraph?_:0;g+P>S&&(e(Yt)>1&&k<e(Yt)-1?(k++,g=0):(E++,k=0,g=0)),H.pageIndex=E,H.yPosition=g,H.columnIndex=k,g+=P+X}f(Qn,a,!0),f(ie,o,!0);const M=o.reduce((A,H)=>Math.max(A,H.pageIndex??0),0);Vo.set(M+1),Me()}function Me(){const o=[];for(let a=0;a<e(d).length;a++){const b=(e(w)[a]||Pt()).blockType;if(b.startsWith("h")){const _=parseInt(b[1]);_>=1&&_<=4&&o.push({id:`heading-${a}`,text:e(d)[a],level:_,paraIndex:a})}}No.set(o)}function Le(o,a){for(let b=0;b<e(ie).length;b++){const _=e(ie)[b];if(_.paraIndex===o&&a>=_.startOffset&&a<=_.endOffset)return{line:b,col:a-_.startOffset}}const u=e(ie).length-1;return{line:u,col:e(ie)[u]?.text.length||0}}function st(o,a){if(o<0||o>=e(ie).length)return{para:e(d).length-1,offset:e(d)[e(d).length-1].length};const u=e(ie)[o];return{para:u.paraIndex,offset:u.startOffset+Math.min(a,u.text.length)}}function Rn(o){if(o<0||o>=e(d).length)return;f(y,o,!0),f(F,0),f(G,null),f(K,null);const a=Le(e(y),e(F)),u=Math.floor(a.line/e(Gt))+1;zr.set(u),nr(),B?.focus(),be()}fs(()=>{B?.focus(),requestAnimationFrame(()=>{te(),be(),ge.push(jt()),Ct()});const o=_=>{!I?.contains(document.activeElement)&&document.activeElement!==B||gs(_)},a=_=>{e(Kt)?Ko(_.clientX,_.clientY):e(nt)&&e(Et)?tl(_.clientX,_.clientY):e(zt)&&il(_.clientX,_.clientY)},u=()=>{e(Kt)&&Jo(),e(Et)&&nl(),e(zt)&&sl()};document.addEventListener("paste",o),document.addEventListener("mousemove",a),document.addEventListener("mouseup",u);const b=()=>{_e()};return x&&x.addEventListener("scroll",b,{passive:!0}),_e(),()=>{document.removeEventListener("paste",o),document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",u),x&&x.removeEventListener("scroll",b),wn!==null&&cancelAnimationFrame(wn)}}),ci(()=>{e(d)&&c()&&h()&&e(_n)>0&&(Gr(),te())}),ci(()=>{e(ie).length>0&&e(y)!==void 0&&be()}),ci(()=>{e(W),e($),e(re),e(xe),e(Ve),Gr()});function Qt(o,a,u,b,_,g){const E=a.width*c()/100,k=a.cropTop||0,S=a.cropRight||0,M=a.cropBottom||0,A=a.cropLeft||0,H=A/100*u.naturalWidth,P=k/100*u.naturalHeight,X=(100-A-S)/100*u.naturalWidth,Q=(100-k-M)/100*u.naturalHeight,T=X/Q,O=E,R=E/T;if(a.wrapStyle==="behind"&&(o.globalAlpha=.5),o.drawImage(u,H,P,X,Q,b,_,O,R),o.globalAlpha=1,e(j)===a.id){o.strokeStyle=e(zt)?"#4caf50":"#1a73e8",o.lineWidth=2,o.setLineDash([]),o.strokeRect(b-2,_-2,O+4,R+4);const z=8;o.fillStyle=e(nt)?"#ff9800":e(zt)?"#4caf50":"#1a73e8",o.fillRect(b-z/2,_-z/2,z,z),o.fillRect(b+O-z/2,_-z/2,z,z),o.fillRect(b-z/2,_+R-z/2,z,z),o.fillRect(b+O-z/2,_+R-z/2,z,z),o.fillRect(b+O/2-z/2,_-z/2,z,z),o.fillRect(b+O/2-z/2,_+R-z/2,z,z),o.fillRect(b-z/2,_+R/2-z/2,z,z),o.fillRect(b+O-z/2,_+R/2-z/2,z,z),e(zt)&&(o.fillStyle="rgba(76, 175, 80, 0.2)",o.fillRect(b,_,O,R)),e(nt)&&(o.strokeStyle="#ff9800",o.lineWidth=2,o.setLineDash([5,5]),o.strokeRect(b,_,O,R),o.setLineDash([]))}else o.strokeStyle="#e0e0e0",o.lineWidth=1,o.setLineDash([]),o.strokeRect(b,_,O,R)}function Cr(o,a,u){const b=o.width*c()/100,_=o.wrapStyle==="inline";if(a.pageIndex!==u)return{x:0,y:0,visible:!1};if(!_&&o.x!==void 0&&o.y!==void 0){const A=e(He).height,H=Math.floor(o.y/A);if(H===u){const P=o.y-H*A,X=e(he)+o.x*c()/100,Q=e(Ge)+P*c()/100;return{x:X,y:Q,visible:!0}}return{x:0,y:0,visible:!1}}const g=e(Ge)+(a.yPosition??0),k=(a.columnIndex??0)*(e(ze)+e(It));let S;if(_&&a.meta){const A=a.meta.align;S=A==="center"?"center":A==="right"?"right":"left"}else S=o.horizontalAlign||"left";let M;return S==="center"?M=e(he)+k+(e(ze)-b)/2:S==="right"?M=e(he)+k+e(ze)-b:M=e(he)+k,{x:M,y:g,visible:!0}}function be(){yt(),er()}function Kr(o){const a=Zt[o];if(!a)return;const u=a.getContext("2d");if(!u)return;const b=window.devicePixelRatio||1;a.width=e(ut)*b,a.height=e(bt)*b,a.style.width=`${e(ut)}px`,a.style.height=`${e(bt)}px`,u.scale(b,b),u.fillStyle="white",u.fillRect(0,0,e(ut),e(bt)),u.font=it(),u.fillStyle="#202124",u.textBaseline="top";const _=e(ie).filter(S=>S.pageIndex===o),g=Le(e(y),e(F));let E=null,k=null;if(e(G)&&e(K)){const S=Le(e(G).para,e(G).offset),M=Le(e(K).para,e(K).offset);S.line<M.line||S.line===M.line&&S.col<=M.col?(E=S,k=M):(E=M,k=S)}for(const S of _){if(!S.isImage||!S.imageId||!S.imageHeight)continue;const M=e(L).find(P=>P.id===S.imageId);if(!M||M.wrapStyle!=="behind")continue;const A=oe.get(M.id);if(!A)continue;const H=Cr(M,S,o);H.visible&&Qt(u,M,A,H.x,H.y)}for(const S of e(Qn)){const M=e(L).find(T=>T.id===S.id);if(!M)continue;const A=oe.get(M.id);if(!A)continue;const H=M.width*c()/100;let P,X,Q=!1;if(M.x!==void 0&&M.y!==void 0){const T=e(He).height,O=Math.floor(M.y/T);if(O===o){const R=M.y-O*T;P=e(he)+M.x*c()/100,X=e(Ge)+R*c()/100,Q=!0}}else{const T=e(ie)[S.startLine];if(T&&T.pageIndex===o){X=e(Ge)+(T.yPosition??0);const R=(T.columnIndex??0)*(e(ze)+e(It));P=S.side==="left"?e(he)+R:e(he)+R+e(ze)-H,Q=!0}}Q&&Qt(u,M,A,P,X)}for(const S of _){if(!S.isImage||!S.imageId||!S.imageHeight)continue;const M=e(L).find(P=>P.id===S.imageId);if(!M||M.wrapStyle!=="inline"&&M.wrapStyle!=="top-bottom")continue;const A=oe.get(M.id);if(!A)continue;const H=Cr(M,S,o);H.visible&&Qt(u,M,A,H.x,H.y)}for(const S of _){if(S.isImage||S.isPageBreak)continue;const M=e(Ge)+(S.yPosition??0),H=(S.columnIndex??0)*(e(ze)+e(It)),P=S.text,X=S.meta,Q=e(ie).indexOf(S),T=X.listType!=="none"?e(Ae)*1.5:0,O=S.floatReduction&&S.floatReduction.side==="left"?S.floatReduction.width+10:0,R=e(he)+H+T+O,z=X.fontSize?X.fontSize*c()/100:e(Ae);let ae=z,ne=e(re)?"bold ":"",ce=e(xe)?"italic ":"";switch(X.blockType){case"h1":ae=z*2,ne="bold ";break;case"h2":ae=z*1.5,ne="bold ";break;case"h3":ae=z*1.17,ne="bold ";break;case"h4":ne="bold ";break;case"blockquote":ce="italic ";break}const J=`${ce}${ne}${ae}px ${e(W)}`;u.font=J;const qe=u.measureText(P).width,Te=S.floatReduction?S.floatReduction.width+10:0,Fe=e(ze)-T-Te;let ke=R,Ke=0;const We=P.split(" "),de=S.endOffset>=e(d)[S.paraIndex].length;switch(X.align){case"center":ke=R+(Fe-qe)/2;break;case"right":ke=R+Fe-qe;break;case"justify":!de&&We.length>1&&P.trim().length>0&&(Ke=(Fe-qe)/(We.length-1));break}if(E&&k&&Q>=E.line&&Q<=k.line){u.fillStyle="#b4d7ff";const se=Q===E.line?E.col:0,ye=Q===k.line?k.col:P.length,dt=ke+u.measureText(P.substring(0,se)).width,De=u.measureText(P.substring(se,ye)).width||5;u.fillRect(dt,M,De,e(Re))}if(S.startOffset===0&&X.listType!=="none")if(u.fillStyle="#202124",X.listType==="bullet"){const se=e(he)+H+e(Ae)*.5,ye=M+e(Re)/2;u.beginPath(),u.arc(se,ye,e(Ae)*.15,0,Math.PI*2),u.fill()}else X.listType==="numbered"&&S.listNumber&&(u.font=`${e(Ae)}px ${e(W)}`,u.textAlign="right",u.fillText(`${S.listNumber}.`,e(he)+H+e(Ae)*1.2,M+(e(Re)-e(Ae))/2),u.textAlign="left",u.font=J);X.blockType==="blockquote"&&S.startOffset===0&&(u.fillStyle="#ccc",u.fillRect(e(he)+H,M,3,e(Re))),u.fillStyle=X.textColor||"#202124",u.font=J;const Se=M+(e(Re)-ae)/2,Je=e(Ve)*c()/100,mn=(se,ye)=>{if(Je===0)return u.fillText(se,ye,Se),u.measureText(se).width;{let dt=ye;for(let De=0;De<se.length;De++)u.fillText(se[De],dt,Se),dt+=u.measureText(se[De]).width+Je;return dt-ye-Je}};if(Ke>0&&X.align==="justify"){let se=ke;for(let ye=0;ye<We.length;ye++)mn(We[ye],se),se+=u.measureText(We[ye]).width+We[ye].length*Je,ye<We.length-1&&(se+=u.measureText(" ").width+Ke)}else mn(P,ke);const Lt=Ke>0?Fe:qe;if(e(Tt)&&P.length>0){const se=M+e(Re)-4;u.strokeStyle="#202124",u.lineWidth=1,u.beginPath(),u.moveTo(ke,se),u.lineTo(ke+Lt,se),u.stroke()}if(e(Ue)&&P.length>0){const se=M+e(Re)/2;u.strokeStyle="#202124",u.lineWidth=1,u.beginPath(),u.moveTo(ke,se),u.lineTo(ke+Lt,se),u.stroke()}if(Q===g.line&&!e(G)){let se=ke;if(Ke>0&&X.align==="justify"){const ye=P.substring(0,g.col),De=ye.split(" ").length-1;se=ke+u.measureText(ye).width+De*Ke}else se=ke+u.measureText(P.substring(0,g.col)).width;u.fillStyle="#000",u.fillRect(se,M+2,2,e(Re)-4)}}for(const S of _){if(!S.isImage||!S.imageId||!S.imageHeight)continue;const M=e(L).find(P=>P.id===S.imageId);if(!M||M.wrapStyle!=="in-front")continue;const A=oe.get(M.id);if(!A)continue;const H=Cr(M,S,o);H.visible&&Qt(u,M,A,H.x,H.y)}u.fillStyle="#999",u.font=`10px ${e(W)}`,u.textAlign="center",u.fillText(`${o+1}`,e(ut)/2,e(bt)-20),u.textAlign="left"}function Jr(){const o=e(An);for(let a=0;a<o;a++)!(a>=e(Sr)&&a<e(N))&&!Ce&&!Xe.has(a)||!Ce&&!Xe.has(a)||Kr(a);Ce=!1,Xe.clear()}function Zr(o){const a=o.key;if(e(j)&&(a==="Delete"||a==="Backspace")){o.preventDefault(),bs();return}if(e(j)&&a!=="Delete"&&a!=="Backspace"&&(f(j,null),be()),o.ctrlKey||o.metaKey){if(a==="Enter"){o.preventDefault(),Ci();return}switch(a.toLowerCase()){case"b":o.preventDefault(),f(re,!e(re)),te();return;case"i":o.preventDefault(),f(xe,!e(xe)),te();return;case"a":o.preventDefault(),f(G,{para:0,offset:0},!0),f(K,{para:e(d).length-1,offset:e(d)[e(d).length-1].length},!0);return;case"c":case"x":if(e(G)&&e(K)){const g=Tr();navigator.clipboard.writeText(g),a.toLowerCase()==="x"&&(Ye(),$t())}o.preventDefault();return;case"v":o.preventDefault(),Ye(),navigator.clipboard.readText().then(g=>{e(G)&&$t(),Qr(g)});return;case"z":o.preventDefault(),o.shiftKey?qt():vn();return;case"y":o.preventDefault(),qt();return;case"s":o.preventDefault(),pn();return}}const u=Le(e(y),e(F));switch(o.shiftKey&&["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Home","End"].includes(a)?e(G)||f(G,{para:e(y),offset:e(F)},!0):!o.shiftKey&&["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Home","End"].includes(a)&&(f(G,null),f(K,null)),a){case"ArrowLeft":o.preventDefault(),e(F)>0?Qe(F,-1):e(y)>0&&(Qe(y,-1),f(F,e(d)[e(y)].length,!0));break;case"ArrowRight":o.preventDefault(),e(F)<e(d)[e(y)].length?Qe(F):e(y)<e(d).length-1&&(Qe(y),f(F,0));break;case"ArrowUp":if(o.preventDefault(),u.line>0){const g=st(u.line-1,u.col);f(y,g.para,!0),f(F,g.offset,!0)}break;case"ArrowDown":if(o.preventDefault(),u.line<e(ie).length-1){const g=st(u.line+1,u.col);f(y,g.para,!0),f(F,g.offset,!0)}break;case"Home":o.preventDefault();{const g=e(ie)[u.line];f(F,g.startOffset,!0)}break;case"End":o.preventDefault();{const g=e(ie)[u.line];f(F,g.endOffset,!0)}break;case"Backspace":if(o.preventDefault(),Ye(),e(G)&&e(K))$t();else if(e(F)>0)e(d)[e(y)]=e(d)[e(y)].substring(0,e(F)-1)+e(d)[e(y)].substring(e(F)),Qe(F,-1),te();else if(e(y)>0)if(e(d)[e(y)-1].startsWith(lr)){const g=e(d)[e(y)-1].substring(1);f(j,g,!0),be()}else{const g=e(d)[e(y)-1].length;e(d)[e(y)-1]+=e(d)[e(y)],f(d,[...e(d).slice(0,e(y)),...e(d).slice(e(y)+1)],!0),f(w,[...e(w).slice(0,e(y)),...e(w).slice(e(y)+1)],!0),Qe(y,-1),f(F,g,!0),te()}break;case"Delete":if(o.preventDefault(),Ye(),e(G)&&e(K))$t();else if(e(F)<e(d)[e(y)].length)e(d)[e(y)]=e(d)[e(y)].substring(0,e(F))+e(d)[e(y)].substring(e(F)+1),te();else if(e(y)<e(d).length-1)if(e(d)[e(y)+1].startsWith(lr)){const g=e(d)[e(y)+1].substring(1);f(j,g,!0),be()}else e(d)[e(y)]+=e(d)[e(y)+1],f(d,[...e(d).slice(0,e(y)+1),...e(d).slice(e(y)+2)],!0),f(w,[...e(w).slice(0,e(y)+1),...e(w).slice(e(y)+2)],!0),te();break;case"Enter":o.preventDefault(),Ye(),e(G)&&e(K)&&$t();{const g=e(d)[e(y)].substring(0,e(F)),E=e(d)[e(y)].substring(e(F));e(d)[e(y)]=g,f(d,[...e(d).slice(0,e(y)+1),E,...e(d).slice(e(y)+1)],!0);const k=e(w)[e(y)]||Pt(),S=k.blockType.startsWith("h")?"p":k.blockType;f(w,[...e(w).slice(0,e(y)+1),{...k,blockType:S},...e(w).slice(e(y)+1)],!0),Qe(y),f(F,0),te()}break;default:a.length===1&&(o.preventDefault(),e(G)&&e(K)&&(Ye(),$t()),Qr(a),br())}o.shiftKey&&["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Home","End"].includes(a)&&f(K,{para:e(y),offset:e(F)},!0);const b=Le(e(y),e(F)),_=Math.floor(b.line/e(Gt))+1;zr.set(_),nr()}function Qr(o){const a=o.split(/\r?\n/);if(a.length===1)e(d)[e(y)]=e(d)[e(y)].substring(0,e(F))+o+e(d)[e(y)].substring(e(F)),f(F,e(F)+o.length);else{const u=e(d)[e(y)].substring(0,e(F)),b=e(d)[e(y)].substring(e(F)),_=e(w)[e(y)]||Pt();e(d)[e(y)]=u+a[0];const g=a.slice(1,-1),E=a[a.length-1]+b;f(d,[...e(d).slice(0,e(y)+1),...g,E,...e(d).slice(e(y)+1)],!0);const k=a.slice(1).map(()=>({..._}));f(w,[...e(w).slice(0,e(y)+1),...k,...e(w).slice(e(y)+1)],!0),f(y,e(y)+(a.length-1)),f(F,a[a.length-1].length,!0)}te()}function Ci(){Ye(),e(G)&&e(K)&&$t();const o=e(d)[e(y)].substring(0,e(F)),a=e(d)[e(y)].substring(e(F));e(d)[e(y)]=o,f(d,[...e(d).slice(0,e(y)+1),Ks,a,...e(d).slice(e(y)+1)],!0);const u=e(w)[e(y)]||Pt();f(w,[...e(w).slice(0,e(y)+1),{...Pt()},{...u},...e(w).slice(e(y)+1)],!0),f(y,e(y)+2),f(F,0),te(),be()}function Tr(){if(!e(G)||!e(K))return"";let o=e(G),a=e(K);if((o.para>a.para||o.para===a.para&&o.offset>a.offset)&&([o,a]=[a,o]),o.para===a.para)return e(d)[o.para].substring(o.offset,a.offset);let u=e(d)[o.para].substring(o.offset);for(let b=o.para+1;b<a.para;b++)u+=`
`+e(d)[b];return u+=`
`+e(d)[a.para].substring(0,a.offset),u}function $t(){if(!e(G)||!e(K))return;let o=e(G),a=e(K);if((o.para>a.para||o.para===a.para&&o.offset>a.offset)&&([o,a]=[a,o]),o.para===a.para)e(d)[o.para]=e(d)[o.para].substring(0,o.offset)+e(d)[o.para].substring(a.offset);else{const u=e(d)[o.para].substring(0,o.offset)+e(d)[a.para].substring(a.offset);f(d,[...e(d).slice(0,o.para),u,...e(d).slice(a.para+1)],!0),f(w,[...e(w).slice(0,o.para+1),...e(w).slice(a.para+1)],!0)}f(y,o.para,!0),f(F,o.offset,!0),f(G,null),f(K,null),te()}function nr(){const o=Le(e(y),e(F)),a=Math.floor(o.line/e(Gt));x?.children[a]?.scrollIntoView({behavior:"smooth",block:"nearest"})}function ei(o,a){const u=Zt[a];if(!u)return;const b=u.getBoundingClientRect(),_=o.clientX-b.left,g=o.clientY-b.top;if(e(j)&&!e(nt)){const T=ri();if(T&&T.pageIndex===a){const O=xs(_,g,T);if(O){o.preventDefault(),Go(O,o.clientX,o.clientY);return}if(_>=T.x&&_<=T.x+T.width&&g>=T.y&&g<=T.y+T.height){o.preventDefault(),rl(o.clientX,o.clientY);return}}}if(e(j)&&e(nt)){const T=ri();if(T&&T.pageIndex===a){const O=xs(_,g,T);if(O){o.preventDefault(),el(O,o.clientX,o.clientY);return}}}let E=0;e(Yt)>1&&_-e(he)>=e(ze)+e(It)&&(E=1);const k=g-e(Ge),S=e(ie).filter(T=>T.pageIndex===a);let M=-1;for(const T of S){if(T.yPosition===void 0)continue;let O=e(Re);T.isImage&&T.imageHeight&&(O=T.imageHeight*e(Re));const R=T.yPosition,z=R+O;if(k>=R&&k<z){M=e(ie).indexOf(T);break}}M===-1&&k>=0&&S.length>0&&(M=e(ie).indexOf(S[S.length-1]));for(const T of e(Qn)){const O=e(L).find(R=>R.id===T.id);if(O){const R=O.width*c()/100,z=O.height*c()/100;let ae,ne,ce=!1;if(O.x!==void 0&&O.y!==void 0){const J=e(He).height,qe=Math.floor(O.y/J);if(qe===a){const Te=O.y-qe*J;ae=e(he)+O.x*c()/100,ne=e(Ge)+Te*c()/100,ce=!0}}else{const J=e(ie)[T.startLine];if(J&&J.pageIndex===a){ne=e(Ge)+(J.yPosition??0);const Te=(J.columnIndex??0)*(e(ze)+e(It));ae=T.side==="left"?e(he)+Te:e(he)+Te+e(ze)-R,ce=!0}}if(ce&&_>=ae&&_<=ae+R&&g>=ne&&g<=ne+z){f(j,O.id,!0),f(G,null),f(K,null),ws(o.clientX,o.clientY),B?.focus(),be();return}}}if(M>=0&&M<e(ie).length){const T=e(ie)[M];if(T.isImage&&T.imageId){const O=e(L).find(z=>z.id===T.imageId);if(O&&(O.wrapStyle==="inline"||O.wrapStyle==="top-bottom"||O.wrapStyle==="behind"||O.wrapStyle==="in-front")){const z=O.width*c()/100,ae=O.height*c()/100;let ne;const ce=E*(e(ze)+e(It));O.horizontalAlign==="center"?ne=e(he)+ce+(e(ze)-z)/2:O.horizontalAlign==="right"?ne=e(he)+ce+e(ze)-z:ne=e(he)+ce;let J=M;for(;J>0&&e(ie)[J-1].imageId===T.imageId;)J--;const qe=e(ie)[J],Te=e(Ge)+(qe.yPosition??0);if(_>=ne&&_<=ne+z&&g>=Te&&g<=Te+ae){f(j,O.id,!0),f(G,null),f(K,null),ws(o.clientX,o.clientY),B?.focus(),be();return}}}}if(e(nt)&&Mi(),f(j,null),f(Ft,!1),M>=0&&M<e(ie).length){const T=e(ie)[M];if(T.isImage)f(y,T.paraIndex+1),f(F,0),e(y)>=e(d).length&&(f(y,e(d).length-1),f(F,e(d)[e(y)].length,!0));else{const O=E*(e(ze)+e(It)),R=T.meta,z=R.listType!=="none"?e(Ae)*1.5:0,ae=T.floatReduction&&T.floatReduction.side==="left"?T.floatReduction.width+10:0,ne=e(he)+O+z+ae,ce=R.fontSize?R.fontSize*c()/100:e(Ae);let J=ce;switch(R.blockType){case"h1":J=ce*2;break;case"h2":J=ce*1.5;break;case"h3":J=ce*1.17;break}const qe=T.floatReduction?T.floatReduction.width+10:0,Te=e(ze)-z-qe,Fe=U?.getContext("2d");if(Fe){const Se=["h1","h2","h3","h4"].includes(R.blockType)||e(re)?"bold ":"",Je=R.blockType==="blockquote"||e(xe)?"italic ":"";Fe.font=`${Je}${Se}${J}px ${e(W)}`}const ke=Fe?Fe.measureText(T.text).width:T.text.length*J*.5;let Ke=ne;R.align==="center"?Ke=ne+(Te-ke)/2:R.align==="right"&&(Ke=ne+Te-ke);let We=0,de=Ke;for(let Se=0;Se<=T.text.length;Se++){const Je=Se<T.text.length&&Fe?Fe.measureText(T.text[Se]).width:0;if(de+Je/2>=_){We=Se;break}de+=Je,We=Se+1}We=Math.min(We,T.text.length),f(y,T.paraIndex,!0),f(F,T.startOffset+We)}}else if(M<0){const T=S[0];T&&(f(y,T.paraIndex,!0),f(F,T.startOffset,!0))}else{const T=e(ie).length-1;if(T>=0){const O=e(ie)[T];f(y,O.paraIndex,!0),f(F,O.endOffset,!0)}}f(G,null),f(K,null);let A=!1;const H=e(y),P=e(F),X=T=>{A=!0,e(G)||f(G,{para:H,offset:P},!0);for(let O=0;O<Zt.length;O++){const R=Zt[O];if(!R)continue;const z=R.getBoundingClientRect();if(T.clientY>=z.top&&T.clientY<=z.bottom){const ae=T.clientX-z.left,ne=T.clientY-z.top;let ce=0;e(Yt)>1&&ae-e(he)>=e(ze)+e(It)&&(ce=1);const J=O*e(Gt),qe=Math.min(J+e(Gt),e(ie).length),Te=e(ct)*c()/100,Fe=ne-e(Ge);let ke=-1,Ke=0;for(let de=J;de<qe;de++){const Se=de-J;if((e(Yt)>1?Math.floor(Se/e(Zn)):0)!==ce){const dt=e(ie)[de];dt&&dt.isLastLineOfParagraph&&(Ke+=Te);continue}const Lt=(e(Yt)>1?Se%e(Zn):Se)*e(Re)+Ke,se=Lt+e(Re);if(Fe>=Lt&&Fe<se){ke=de;break}const ye=e(ie)[de];ye&&ye.isLastLineOfParagraph&&(Ke+=Te)}ke===-1&&Fe>=0&&(ke=qe-1);const We=ce*(e(ze)+e(It));if(ke>=0&&ke<e(ie).length){const de=e(ie)[ke],Se=de.meta,Je=Se.listType!=="none"?e(Ae)*1.5:0,mn=de.floatReduction&&de.floatReduction.side==="left"?de.floatReduction.width+10:0,Lt=e(he)+We+Je+mn,se=Se.fontSize?Se.fontSize*c()/100:e(Ae);let ye=se;switch(Se.blockType){case"h1":ye=se*2;break;case"h2":ye=se*1.5;break;case"h3":ye=se*1.17;break}const dt=de.floatReduction?de.floatReduction.width+10:0,De=e(ze)-Je-dt,en=U?.getContext("2d");if(en){const At=["h1","h2","h3","h4"].includes(Se.blockType)||e(re)?"bold ":"",Fn=Se.blockType==="blockquote"||e(xe)?"italic ":"";en.font=`${Fn}${At}${ye}px ${e(W)}`}const ii=en?en.measureText(de.text).width:de.text.length*ye*.5;let qn=Lt;Se.align==="center"?qn=Lt+(De-ii)/2:Se.align==="right"&&(qn=Lt+De-ii);let xn=0,rr=qn;for(let At=0;At<=de.text.length;At++){const Fn=At<de.text.length&&en?en.measureText(de.text[At]).width:0;if(rr+Fn/2>=ae){xn=At;break}rr+=Fn,xn=At+1}xn=Math.min(xn,de.text.length),f(y,de.paraIndex,!0),f(F,de.startOffset+xn),f(K,{para:e(y),offset:e(F)},!0)}break}}},Q=()=>{window.removeEventListener("mousemove",X),window.removeEventListener("mouseup",Q),(!A||e(G)&&e(K)&&e(G).para===e(K).para&&e(G).offset===e(K).offset)&&(f(G,null),f(K,null)),B?.focus(),be()};window.addEventListener("mousemove",X),window.addEventListener("mouseup",Q),zr.set(a+1),B?.focus(),be()}function ti(o,a){let u=e(y),b=e(y);switch(e(G)&&e(K)&&(u=Math.min(e(G).para,e(K).para),b=Math.max(e(G).para,e(K).para)),["justifyLeft","justifyCenter","justifyRight","justifyFull","insertUnorderedList","insertOrderedList","formatBlock","fontSize","foreColor"].includes(o)&&Ye(),o){case"bold":f(re,!e(re));break;case"italic":f(xe,!e(xe));break;case"underline":f(Tt,!e(Tt));break;case"strikeThrough":f(Ue,!e(Ue));break;case"justifyLeft":for(let g=u;g<=b;g++)e(w)[g]={...e(w)[g],align:"left"};break;case"justifyCenter":for(let g=u;g<=b;g++)e(w)[g]={...e(w)[g],align:"center"};break;case"justifyRight":for(let g=u;g<=b;g++)e(w)[g]={...e(w)[g],align:"right"};break;case"justifyFull":for(let g=u;g<=b;g++)e(w)[g]={...e(w)[g],align:"justify"};break;case"insertUnorderedList":for(let g=u;g<=b;g++){const E=e(w)[g].listType;e(w)[g]={...e(w)[g],listType:E==="bullet"?"none":"bullet"}}break;case"insertOrderedList":for(let g=u;g<=b;g++){const E=e(w)[g].listType;e(w)[g]={...e(w)[g],listType:E==="numbered"?"none":"numbered"}}break;case"formatBlock":if(a){const g=a;for(let E=u;E<=b;E++)e(w)[E]={...e(w)[E],blockType:g}}break;case"fontSize":if(a){const g=parseInt(a);for(let E=u;E<=b;E++)e(w)[E]={...e(w)[E],fontSize:g}}break;case"foreColor":if(a)for(let g=u;g<=b;g++)e(w)[g]={...e(w)[g],textColor:a};break;case"undo":vn();return;case"redo":qt();return;case"insertImage":f(fe,!0);return}f(w,[...e(w)],!0),te(),be(),B?.focus()}function ni(){return"img-"+Date.now()+"-"+Math.random().toString(36).substring(2,11)}function Hn(o){return new Promise((a,u)=>{const b=new Image;b.crossOrigin="anonymous",b.onload=()=>a(b),b.onerror=u,b.src=o})}async function vs(o,a="inline"){try{Ye();const u=await Hn(o),b=ni(),_=e(He).width*.8*c()/100;let g=u.naturalWidth,E=u.naturalHeight;if(g>_){const P=_/g;g=_,E=E*P}const k={id:b,src:o,width:g,height:E,naturalWidth:u.naturalWidth,naturalHeight:u.naturalHeight,wrapStyle:a,positionMode:"move-with-text",horizontalAlign:"left",cropTop:0,cropRight:0,cropBottom:0,cropLeft:0};f(L,[...e(L),k],!0),oe.set(b,u);const S=e(d)[e(y)].substring(0,e(F)),M=e(d)[e(y)].substring(e(F));e(d)[e(y)]=S;const A=lr+b;f(d,[...e(d).slice(0,e(y)+1),A,M,...e(d).slice(e(y)+1)],!0);const H=e(w)[e(y)]||Pt();f(w,[...e(w).slice(0,e(y)+1),{...Pt(),align:"center"},{...H},...e(w).slice(e(y)+1)],!0),f(y,e(y)+2),f(F,0),te(),be()}catch(u){console.error("Failed to load image:",u),alert("Failed to load image. Please check the URL.")}}function ps(){e(pe).trim()&&(vs(e(pe).trim()),f(pe,""),f(fe,!1),B?.focus())}function jo(o){o.preventDefault(),f(Pe,!1);const a=o.dataTransfer?.files;a&&a.length>0&&Ti(a[0])}function Yo(o){const a=o.target;a.files&&a.files.length>0&&Ti(a.files[0])}function Ti(o){if(!o.type.startsWith("image/")){alert("Please select an image file");return}const a=new FileReader;a.onload=u=>{const b=u.target?.result;vs(b),f(fe,!1),B?.focus()},a.readAsDataURL(o)}function gs(o){const a=o.clipboardData?.items;if(a){for(const u of a)if(u.type.startsWith("image/")){o.preventDefault();const b=u.getAsFile();b&&Ti(b);return}}}function _s(){f(fe,!1),f(pe,""),f(Pe,!1),B?.focus()}function bs(){if(!e(j))return;Ye();const o=e(d).findIndex(a=>a===lr+e(j));o!==-1&&(f(L,e(L).filter(a=>a.id!==e(j)),!0),oe.delete(e(j)),f(d,[...e(d).slice(0,o),...e(d).slice(o+1)],!0),f(w,[...e(w).slice(0,o),...e(w).slice(o+1)],!0),e(d).length===0&&(f(d,[""],!0),f(w,[Pt()],!0)),e(y)>=e(d).length?(f(y,e(d).length-1),f(F,e(d)[e(y)].length,!0)):e(y)>o&&Qe(y,-1),f(j,null),f(Ft,!1),te(),be())}function On(o){if(!e(j))return;const a=e(L).findIndex(b=>b.id===e(j));if(a===-1)return;const u={...e(L)[a],wrapStyle:o};(u.positionMode==="move-with-text"||o==="inline")&&(u.x=void 0,u.y=void 0,u.pageIndex=void 0),e(L)[a]=u,f(L,[...e(L)],!0),te(),be()}function ys(o){if(!e(j))return;const a=e(L).findIndex(b=>b.id===e(j));if(a===-1)return;const u={...e(L)[a],positionMode:o};o==="move-with-text"&&(u.x=void 0,u.y=void 0,u.pageIndex=void 0),e(L)[a]=u,f(L,[...e(L)],!0),te(),be()}function Ii(o){if(!e(j))return;const a=e(L).findIndex(u=>u.id===e(j));a!==-1&&(e(L)[a]={...e(L)[a],horizontalAlign:o},f(L,[...e(L)],!0),te(),be())}function ws(o,a){f(zn,{x:o,y:a},!0),f(Ft,!0)}function ms(){f(Ft,!1)}function ri(){if(!e(j))return null;const o=e(L).find(R=>R.id===e(j));if(!o)return null;const a=oe.get(o.id);if(!a)return null;const u=o.width*c()/100,b=o.cropTop||0,_=o.cropRight||0,g=o.cropBottom||0,k=(100-(o.cropLeft||0)-_)/100*a.naturalWidth,S=(100-b-g)/100*a.naturalHeight,M=k/S,A=u,H=u/M;if(o.x!==void 0&&o.y!==void 0){const R=e(He).height,z=Math.floor(o.y/R),ae=o.y-z*R,ne=e(he)+o.x*c()/100,ce=e(Ge)+ae*c()/100;return{x:ne,y:ce,width:A,height:H,pageIndex:z}}const P=e(ie).find(R=>R.imageId===e(j)&&R.isImage);if(!P||P.pageIndex===void 0)return null;const X=P.pageIndex,Q=e(Qn).find(R=>R.id===e(j));let T;Q?T=Q.side==="left"?e(he):e(he)+e(_n)-A:T=e(he)+(e(_n)-A)/2;const O=e(Ge)+(P.yPosition??0);return{x:T,y:O,width:A,height:H,pageIndex:X}}function xs(o,a,u){const{x:_,y:g,width:E,height:k}=u;if(o>=_-10&&o<=_+10&&a>=g-10&&a<=g+10)return"nw";if(o>=_+E-10&&o<=_+E+10&&a>=g-10&&a<=g+10)return"ne";if(o>=_-10&&o<=_+10&&a>=g+k-10&&a<=g+k+10)return"sw";if(o>=_+E-10&&o<=_+E+10&&a>=g+k-10&&a<=g+k+10)return"se";const S=_+E/2,M=g+k/2;return o>=S-10&&o<=S+10&&a>=g-10&&a<=g+10?"n":o>=S-10&&o<=S+10&&a>=g+k-10&&a<=g+k+10?"s":o>=_-10&&o<=_+10&&a>=M-10&&a<=M+10?"w":o>=_+E-10&&o<=_+E+10&&a>=M-10&&a<=M+10?"e":null}function Go(o,a,u){if(!e(j)||!o)return;const b=e(L).find(_=>_.id===e(j));b&&(f(Kt,!0),f(Jt,o,!0),f(Ur,a,!0),f(yr,u,!0),f(Mt,b.width,!0),f(wr,b.height,!0),f(Ft,!1))}function Ko(o,a){if(!e(Kt)||!e(j)||!e(Jt))return;const u=e(L).findIndex(A=>A.id===e(j));if(u===-1)return;const b=e(L)[u],_=b.naturalWidth/b.naturalHeight,g=(o-e(Ur))*(100/c()),E=(a-e(yr))*(100/c());let k=e(Mt),S=e(wr);switch(e(Jt)){case"se":k=Math.max(50,e(Mt)+g),S=k/_;break;case"sw":k=Math.max(50,e(Mt)-g),S=k/_;break;case"ne":k=Math.max(50,e(Mt)+g),S=k/_;break;case"nw":k=Math.max(50,e(Mt)-g),S=k/_;break;case"e":k=Math.max(50,e(Mt)+g),S=k/_;break;case"w":k=Math.max(50,e(Mt)-g),S=k/_;break;case"n":case"s":S=Math.max(50,e(wr)+(e(Jt)==="s"?E:-E)),k=S*_;break}const M=e(He).width*.95;k>M&&(k=M,S=k/_),e(L)[u]={...b,width:k,height:S},f(L,[...e(L)],!0),te(),be()}function Jo(){f(Kt,!1),f(Jt,null)}function Zo(){if(!e(j))return;const o=e(L).find(a=>a.id===e(j));o&&f(bn,{top:o.cropTop||0,right:o.cropRight||0,bottom:o.cropBottom||0,left:o.cropLeft||0},!0),f(nt,!0),f(Ft,!1),be()}function Mi(){f(nt,!1),f(Et,null),be()}function Qo(){if(!e(j))return;const o=e(L).findIndex(a=>a.id===e(j));o!==-1&&(e(L)[o]={...e(L)[o],cropTop:e(bn).top,cropRight:e(bn).right,cropBottom:e(bn).bottom,cropLeft:e(bn).left},f(L,[...e(L)],!0)),Mi()}function el(o,a,u){if(!e(j)||!o)return;const b=e(L).find(_=>_.id===e(j));b&&(f(Et,o,!0),f(mr,a,!0),f(xr,u,!0),f($e,{top:b.cropTop||0,right:b.cropRight||0,bottom:b.cropBottom||0,left:b.cropLeft||0},!0))}function tl(o,a){if(!e(nt)||!e(j)||!e(Et))return;const u=e(L).findIndex(S=>S.id===e(j));if(u===-1)return;const b=e(L)[u],_=ri();if(!_)return;const g=(o-e(mr))/_.width*100,E=(a-e(xr))/_.height*100;let k={...e($e)};switch(e(Et)){case"n":k.top=Math.max(0,Math.min(100-k.bottom-10,e($e).top+E));break;case"s":k.bottom=Math.max(0,Math.min(100-k.top-10,e($e).bottom-E));break;case"w":k.left=Math.max(0,Math.min(100-k.right-10,e($e).left+g));break;case"e":k.right=Math.max(0,Math.min(100-k.left-10,e($e).right-g));break;case"nw":k.top=Math.max(0,Math.min(100-k.bottom-10,e($e).top+E)),k.left=Math.max(0,Math.min(100-k.right-10,e($e).left+g));break;case"ne":k.top=Math.max(0,Math.min(100-k.bottom-10,e($e).top+E)),k.right=Math.max(0,Math.min(100-k.left-10,e($e).right-g));break;case"sw":k.bottom=Math.max(0,Math.min(100-k.top-10,e($e).bottom-E)),k.left=Math.max(0,Math.min(100-k.right-10,e($e).left+g));break;case"se":k.bottom=Math.max(0,Math.min(100-k.top-10,e($e).bottom-E)),k.right=Math.max(0,Math.min(100-k.left-10,e($e).right-g));break}e(L)[u]={...b,cropTop:k.top,cropRight:k.right,cropBottom:k.bottom,cropLeft:k.left},f(L,[...e(L)],!0),be()}function nl(){f(Et,null)}function ks(){if(!e(j))return;const o=e(L).findIndex(a=>a.id===e(j));o!==-1&&(e(L)[o]={...e(L)[o],cropTop:0,cropRight:0,cropBottom:0,cropLeft:0},f(L,[...e(L)],!0),be())}function rl(o,a,u){if(!e(j))return;const b=e(L).find(_=>_.id===e(j));if(b&&b.wrapStyle!=="inline"){if(f(zt,!0),f(Xr,o,!0),f(jr,a,!0),b.x===void 0||b.y===void 0){const _=ri();_?(f(yn,(_.x-e(he))*(100/c())),f(Ln,_.pageIndex*e(He).height+(_.y-e(Ge))*(100/c()))):(f(yn,0),f(Ln,0))}else f(yn,b.x,!0),f(Ln,b.y,!0);f(Ft,!1)}}function il(o,a){if(!e(zt)||!e(j))return;const u=e(L).findIndex(P=>P.id===e(j));if(u===-1)return;const b=e(L)[u],_=(o-e(Xr))*(100/c()),g=(a-e(jr))*(100/c());let E=e(yn)+_,k=e(Ln)+g;const S=e(He).width-b.width;E=Math.max(0,Math.min(S,E));const M=e(He).height,A=Math.max(0,k),H=Math.floor(A/M);e(L)[u]={...b,x:E,y:A,pageIndex:H},f(L,[...e(L)],!0),te(),be()}function sl(){f(zt,!1)}let ol=Ie(()=>Array.from({length:e(An)},(o,a)=>a));var ll={navigateToParagraph:Rn},Ss=oc(),Cs=q(Ss);Ja(Cs,{onFormat:ti,get canUndo(){return e(Mn)},get canRedo(){return e(dn)},onSave:pn});var Ts=m(Cs,2);nn(Ts,o=>U=o,()=>U);var Ir=m(Ts,2);Ir.__keydown=Zr,Do(Ir,"spellcheck",!1),nn(Ir,o=>B=o,()=>B);var Ei=m(Ir,2),Is=q(Ei);Sn(Is,20,()=>e(ol),o=>o,(o,a)=>{var u=tc();let b;u.__mousedown=_=>ei(_,a),nn(u,(_,g)=>Zt[g]=_,_=>Zt?.[_],()=>[a]),Be(()=>{b=Z(u,1,"page-canvas svelte-1h8xysy",null,b,{active:p()===a+1}),Wi(u,`cursor: ${e(kr)??""};`)}),we(o,u)}),nn(Is,o=>x=o,()=>x),nn(Ei,o=>I=o,()=>I);var Ms=m(Ei,2),al=q(Ms),Es=m(Ms,2);{var cl=o=>{var a=nc();a.__click=_s;var u=q(a);u.__click=X=>X.stopPropagation();var b=q(u),_=m(q(b),2);_.__click=_s;var g=m(b,2),E=q(g),k=m(q(E),2),S=q(k);S.__keydown=X=>X.key==="Enter"&&ps();var M=m(S,2);M.__click=ps;var A=m(E,4);let H;A.__click=()=>document.getElementById("file-input")?.click();var P=m(A,2);P.__change=Yo,Be(()=>H=Z(A,1,"drop-zone svelte-1h8xysy",null,H,{"drag-over":e(Pe)})),Pa(S,()=>e(pe),X=>f(pe,X)),oi("dragover",A,X=>{X.preventDefault(),f(Pe,!0)}),oi("dragleave",A,()=>f(Pe,!1)),oi("drop",A,jo),we(o,a)};pt(Es,o=>{e(fe)&&o(cl)})}var zs=m(Es,2);{var ul=o=>{const a=Ie(()=>e(L).find(De=>De.id===e(j)));var u=ic();u.__click=ms;var b=q(u);b.__click=De=>De.stopPropagation();var _=q(b),g=m(q(_),2);g.__click=ms;var E=m(_,2),k=m(q(E),2),S=q(k);let M;S.__click=()=>On("inline");var A=m(E,2),H=m(q(A),2),P=q(H);let X;P.__click=()=>On("square");var Q=m(P,2);let T;Q.__click=()=>On("tight");var O=m(Q,2);let R;O.__click=()=>On("through");var z=m(O,2);let ae;z.__click=()=>On("top-bottom");var ne=m(z,2);let ce;ne.__click=()=>On("behind");var J=m(ne,2);let qe;J.__click=()=>On("in-front");var Te=m(A,2);{var Fe=De=>{var en=rc(),ii=m(q(en),2),qn=q(ii);let xn;qn.__click=()=>Ii("left");var rr=m(qn,2);let At;rr.__click=()=>Ii("center");var Fn=m(rr,2);let Ls;Fn.__click=()=>Ii("right"),Be(()=>{xn=Z(qn,1,"layout-btn small svelte-1h8xysy",null,xn,{active:e(a)?.horizontalAlign==="left"}),At=Z(rr,1,"layout-btn small svelte-1h8xysy",null,At,{active:e(a)?.horizontalAlign==="center"}),Ls=Z(Fn,1,"layout-btn small svelte-1h8xysy",null,Ls,{active:e(a)?.horizontalAlign==="right"})}),we(De,en)};pt(Te,De=>{e(a)?.wrapStyle!=="inline"&&De(Fe)})}var ke=m(Te,2),Ke=m(q(ke),2),We=q(Ke),de=q(We);de.__change=()=>ys("move-with-text");var Se=m(We,2),Je=q(Se);Je.__change=()=>ys("fixed-position");var mn=m(ke,2),Lt=m(q(mn),2),se=q(Lt);se.__click=Zo;var ye=m(se,2);ye.__click=ks;var dt=m(mn,2);dt.__click=bs,Be(()=>{Wi(b,`left: ${e(zn).x??""}px; top: ${e(zn).y??""}px;`),M=Z(S,1,"layout-btn svelte-1h8xysy",null,M,{active:e(a)?.wrapStyle==="inline"}),X=Z(P,1,"layout-btn svelte-1h8xysy",null,X,{active:e(a)?.wrapStyle==="square"}),T=Z(Q,1,"layout-btn svelte-1h8xysy",null,T,{active:e(a)?.wrapStyle==="tight"}),R=Z(O,1,"layout-btn svelte-1h8xysy",null,R,{active:e(a)?.wrapStyle==="through"}),ae=Z(z,1,"layout-btn svelte-1h8xysy",null,ae,{active:e(a)?.wrapStyle==="top-bottom"}),ce=Z(ne,1,"layout-btn svelte-1h8xysy",null,ce,{active:e(a)?.wrapStyle==="behind"}),qe=Z(J,1,"layout-btn svelte-1h8xysy",null,qe,{active:e(a)?.wrapStyle==="in-front"}),Vs(de,e(a)?.positionMode==="move-with-text"),Vs(Je,e(a)?.positionMode==="fixed-position")}),we(o,u)};pt(zs,o=>{e(Ft)&&e(j)&&!e(nt)&&o(ul)})}var fl=m(zs,2);{var dl=o=>{var a=sc(),u=m(q(a),2),b=q(u);b.__click=Mi;var _=m(b,2);_.__click=ks;var g=m(_,2);g.__click=Qo,we(o,a)};pt(fl,o=>{e(nt)&&e(j)&&o(dl)})}Be(()=>Rt(al,`Page ${p()??""} of ${e(An)??""}`)),oi("paste",Ir,gs),we(t,Ss);var hl=Br(ll);return D(),hl}Vr(["keydown","mousedown","click","change"]);let Y;function ac(t){const n=Y.__externref_table_alloc();return Y.__wbindgen_externrefs.set(n,t),n}let Dn=null;function li(){return(Dn===null||Dn.buffer.detached===!0||Dn.buffer.detached===void 0&&Dn.buffer!==Y.memory.buffer)&&(Dn=new DataView(Y.memory.buffer)),Dn}function Wn(t,n){return t=t>>>0,dc(t,n)}let Lr=null;function di(){return(Lr===null||Lr.byteLength===0)&&(Lr=new Uint8Array(Y.memory.buffer)),Lr}function cc(t,n){try{return t.apply(this,n)}catch(r){const i=ac(r);Y.__wbindgen_exn_store(i)}}function Js(t){return t==null}function hi(t,n,r){if(r===void 0){const h=Hr.encode(t),c=n(h.length,1)>>>0;return di().subarray(c,c+h.length).set(h),ur=h.length,c}let i=t.length,l=n(i,1)>>>0;const s=di();let v=0;for(;v<i;v++){const h=t.charCodeAt(v);if(h>127)break;s[l+v]=h}if(v!==i){v!==0&&(t=t.slice(v)),l=r(l,i,i=v+t.length*3,1)>>>0;const h=di().subarray(l+v,l+i),c=Hr.encodeInto(t,h);v+=c.written,l=r(l,i,v,1)>>>0}return ur=v,l}function uc(t){const n=Y.__wbindgen_externrefs.get(t);return Y.__externref_table_dealloc(t),n}let vi=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});vi.decode();const fc=2146435072;let Hi=0;function dc(t,n){return Hi+=n,Hi>=fc&&(vi=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}),vi.decode(),Hi=n),vi.decode(di().subarray(t,t+n))}const Hr=new TextEncoder;"encodeInto"in Hr||(Hr.encodeInto=function(t,n){const r=Hr.encode(t);return n.set(r),{read:t.length,written:r.length}});let ur=0;const Zs=typeof FinalizationRegistry>"u"?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(t=>Y.__wbg_engine_free(t>>>0,1));class Gi{__destroy_into_raw(){const n=this.__wbg_ptr;return this.__wbg_ptr=0,Zs.unregister(this),n}free(){const n=this.__destroy_into_raw();Y.__wbg_engine_free(n,0)}page_count(){return Y.engine_page_count(this.__wbg_ptr)>>>0}get_paragraph(n){const r=Y.engine_get_paragraph(this.__wbg_ptr,n);let i;return r[0]!==0&&(i=Wn(r[0],r[1]).slice(),Y.__wbindgen_free(r[0],r[1]*1,1)),i}load_document(n){const r=hi(n,Y.__wbindgen_malloc,Y.__wbindgen_realloc),i=ur,l=Y.engine_load_document(this.__wbg_ptr,r,i);if(l[1])throw uc(l[0])}save_document(){let n,r;try{const i=Y.engine_save_document(this.__wbg_ptr);return n=i[0],r=i[1],Wn(i[0],i[1])}finally{Y.__wbindgen_free(n,r,1)}}set_paragraph(n,r){const i=hi(r,Y.__wbindgen_malloc,Y.__wbindgen_realloc),l=ur;Y.engine_set_paragraph(this.__wbg_ptr,n,i,l)}display_to_para(n,r){return Y.engine_display_to_para(this.__wbg_ptr,n,r)}paragraph_count(){return Y.engine_paragraph_count(this.__wbg_ptr)>>>0}set_font_config(n,r,i,l){Y.engine_set_font_config(this.__wbg_ptr,n,r,i,l)}set_page_config(n,r,i,l,s,v,h,c){Y.engine_set_page_config(this.__wbg_ptr,n,r,i,l,s,v,h,c)}delete_paragraph(n){Y.engine_delete_paragraph(this.__wbg_ptr,n)}insert_paragraph(n,r){const i=hi(r,Y.__wbindgen_malloc,Y.__wbindgen_realloc),l=ur;Y.engine_insert_paragraph(this.__wbg_ptr,n,i,l)}recompute_layout(n){return Y.engine_recompute_layout(this.__wbg_ptr,n)!==0}display_line_count(){return Y.engine_display_line_count(this.__wbg_ptr)>>>0}get_render_commands(n){let r,i;try{const l=Y.engine_get_render_commands(this.__wbg_ptr,n);return r=l[0],i=l[1],Wn(l[0],l[1])}finally{Y.__wbindgen_free(r,i,1)}}para_to_display_pos(n,r){return Y.engine_para_to_display_pos(this.__wbg_ptr,n,r)}get_page_for_position(n,r){return Y.engine_get_page_for_position(this.__wbg_ptr,n,r)>>>0}get_display_lines_json(){let n,r;try{const i=Y.engine_get_display_lines_json(this.__wbg_ptr);return n=i[0],r=i[1],Wn(i[0],i[1])}finally{Y.__wbindgen_free(n,r,1)}}constructor(){const n=Y.engine_new();return this.__wbg_ptr=n>>>0,Zs.register(this,this.__wbg_ptr,this),this}}Symbol.dispose&&(Gi.prototype[Symbol.dispose]=Gi.prototype.free);const hc=new Set(["basic","cors","default"]);async function vc(t,n){if(typeof Response=="function"&&t instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(t,n)}catch(i){if(t.ok&&hc.has(t.type)&&t.headers.get("Content-Type")!=="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",i);else throw i}const r=await t.arrayBuffer();return await WebAssembly.instantiate(r,n)}else{const r=await WebAssembly.instantiate(t,n);return r instanceof WebAssembly.Instance?{instance:r,module:t}:r}}function pc(){const t={};return t.wbg={},t.wbg.__wbg___wbindgen_number_get_9619185a74197f95=function(n,r){const i=r,l=typeof i=="number"?i:void 0;li().setFloat64(n+8,Js(l)?0:l,!0),li().setInt32(n+0,!Js(l),!0)},t.wbg.__wbg___wbindgen_throw_dd24417ed36fc46e=function(n,r){throw new Error(Wn(n,r))},t.wbg.__wbg_call_c8baa5c5e72d274e=function(){return cc(function(n,r,i,l){return n.call(r,i,l)},arguments)},t.wbg.__wbg_error_7534b8e9a36f1ab4=function(n,r){let i,l;try{i=n,l=r,console.error(Wn(n,r))}finally{Y.__wbindgen_free(i,l,1)}},t.wbg.__wbg_new_8a6f238a6ece86ea=function(){return new Error},t.wbg.__wbg_stack_0ed75d68575b0f3c=function(n,r){const i=r.stack,l=hi(i,Y.__wbindgen_malloc,Y.__wbindgen_realloc),s=ur;li().setInt32(n+4,s,!0),li().setInt32(n+0,l,!0)},t.wbg.__wbindgen_cast_2241b6af4c4b2941=function(n,r){return Wn(n,r)},t.wbg.__wbindgen_cast_d6cd19b81560fd6e=function(n){return n},t.wbg.__wbindgen_init_externref_table=function(){const n=Y.__wbindgen_externrefs,r=n.grow(4);n.set(0,void 0),n.set(r+0,void 0),n.set(r+1,null),n.set(r+2,!0),n.set(r+3,!1)},t}function gc(t,n){return Y=t.exports,Xo.__wbindgen_wasm_module=n,Dn=null,Lr=null,Y.__wbindgen_start(),Y}async function Xo(t){if(Y!==void 0)return Y;typeof t<"u"&&(Object.getPrototypeOf(t)===Object.prototype?{module_or_path:t}=t:console.warn("using deprecated parameters for the initialization function; pass a single object instead")),typeof t>"u"&&(t=new URL("/assets/editor_engine_bg-UJU8Qfxl.wasm",import.meta.url));const n=pc();(typeof t=="string"||typeof Request=="function"&&t instanceof Request||typeof URL=="function"&&t instanceof URL)&&(t=fetch(t));const{instance:r,module:i}=await vc(await t,n);return gc(r,i)}function _c(t,n,r,i){for(const l of n)switch(l.type){case"setFont":{const s=l,v=s.italic?"italic ":"",h=s.bold?"bold ":"";t.font=`${v}${h}${s.size}px ${s.font||i}`;break}case"setFillColor":{const s=l;t.fillStyle=s.color;break}case"setStrokeColor":{const s=l;t.strokeStyle=s.color;break}case"drawText":{const s=l;t.fillText(s.text,s.x,s.y);break}case"drawTextJustified":{const s=l;let v=s.x;for(let h=0;h<s.words.length;h++)t.fillText(s.words[h],v,s.y),v+=t.measureText(s.words[h]).width,h<s.words.length-1&&(v+=t.measureText(" ").width+s.wordSpacing);break}case"fillRect":{const s=l;t.fillRect(s.x,s.y,s.width,s.height);break}case"strokeRect":{const s=l;t.strokeRect(s.x,s.y,s.width,s.height);break}case"drawLine":{const s=l;t.lineWidth=s.width,t.beginPath(),t.moveTo(s.x1,s.y1),t.lineTo(s.x2,s.y2),t.stroke();break}case"fillCircle":{const s=l;t.beginPath(),t.arc(s.x,s.y,s.radius,0,Math.PI*2),t.fill();break}case"drawImage":{const s=l,v=r.get(s.imageId);if(v){const h=s.cropLeft/100*v.naturalWidth,c=s.cropTop/100*v.naturalHeight,p=(100-s.cropLeft-s.cropRight)/100*v.naturalWidth,C=(100-s.cropTop-s.cropBottom)/100*v.naturalHeight;t.drawImage(v,h,c,p,C,s.x,s.y,s.width,s.height)}break}case"drawCursor":{const s=l;t.fillStyle="#000",t.fillRect(s.x,s.y,2,s.height);break}case"drawSelection":{const s=l;t.fillStyle="#b4d7ff",t.fillRect(s.x,s.y,s.width,s.height);break}case"drawPageNumber":{const s=l;t.textAlign="center",t.fillText(`${s.number}`,s.x,s.y),t.textAlign="left";break}}}function bc(t){try{return JSON.parse(t)}catch{return console.error("Failed to parse render commands:",t),[]}}var yc=Ee('<div class="editor-wasm-wrapper svelte-1egarnu"><div class="header svelte-1egarnu"><h2 class="svelte-1egarnu">WASM Editor Demo</h2> <span><!></span></div> <canvas class="measure-canvas svelte-1egarnu"></canvas> <textarea class="hidden-input svelte-1egarnu"></textarea> <div class="canvas-container svelte-1egarnu"><canvas class="page-canvas svelte-1egarnu"></canvas></div></div>');function wc(t,n){Dr(n,!0);let r,i,l,s=null,v=V(!1),h=V(null),c=V(0),p=V(0),C=V(1);const D=816,I=1056,x=96,B=16,U=1.5,d="Arial",w=new Map;fs(async()=>{try{await Xo(),s=new Gi,s.set_page_config(D,I,x,x,x,x,1,48),s.set_font_config(B,U,0,12),s.set_paragraph(0,"Welcome to the WASM-powered editor!"),s.insert_paragraph(1,""),s.insert_paragraph(2,"This editor uses a Rust/WebAssembly engine for layout computation."),s.insert_paragraph(3,""),s.insert_paragraph(4,"Try typing to see it in action..."),f(v,!0),oe(),l?.focus()}catch($){f(h,`Failed to initialize WASM engine: ${$}`),console.error($)}});function L(){const $=i?.getContext("2d");return $?(W,le)=>($.font=`${le}px ${d}`,$.measureText(W).width):(W,le)=>W.length*le*.5}function oe(){if(!s||!r)return;const $=L();s.recompute_layout($),f(C,s.page_count(),!0),fe()}function fe(){if(!s||!r)return;const $=r.getContext("2d");if(!$)return;const W=window.devicePixelRatio||1;r.width=D*W,r.height=I*W,r.style.width=`${D}px`,r.style.height=`${I}px`,$.scale(W,W),$.fillStyle="white",$.fillRect(0,0,D,I);const le=s.get_render_commands(0),Ve=bc(le);$.textBaseline="top",_c($,Ve,w,d),pe($)}function pe($){if(!s)return;const W=s.para_to_display_pos(e(c),e(p));if(W)try{const le=JSON.parse(W);if(le&&le.page===0){const ct=(s.get_paragraph(e(c))||"").substring(0,e(p));$.font=`${B}px ${d}`;const re=$.measureText(ct).width,xe=B*U,Tt=x+re,Ue=x+le.y;$.fillStyle="#000",$.fillRect(Tt,Ue+2,2,xe-4)}}catch(le){console.error("Failed to parse cursor position:",le)}}function Pe($){if(!s)return;const W=$.key;if($.ctrlKey||$.metaKey){if(W==="Home"){$.preventDefault(),f(c,0),f(p,0),fe();return}else if(W==="End"){$.preventDefault();const le=s.paragraph_count()-1;f(c,le),f(p,(s.get_paragraph(le)||"").length,!0),fe();return}return}$.preventDefault(),W==="Backspace"?F():W==="Delete"?G():W==="Enter"?K():W==="ArrowLeft"?ge(-1):W==="ArrowRight"?ge(1):W==="ArrowUp"?fn(-1):W==="ArrowDown"?fn(1):W==="Home"?(f(p,0),fe()):W==="End"?(f(p,(s.get_paragraph(e(c))||"").length,!0),fe()):W.length===1&&y(W)}function y($){if(!s)return;const W=s.get_paragraph(e(c))||"",le=W.slice(0,e(p))+$+W.slice(e(p));s.set_paragraph(e(c),le),Qe(p),oe()}function F(){if(s){if(e(p)>0){const $=s.get_paragraph(e(c))||"",W=$.slice(0,e(p)-1)+$.slice(e(p));s.set_paragraph(e(c),W),Qe(p,-1)}else if(e(c)>0){const $=s.get_paragraph(e(c)-1)||"",W=s.get_paragraph(e(c))||"";s.set_paragraph(e(c)-1,$+W),s.delete_paragraph(e(c)),Qe(c,-1),f(p,$.length,!0)}oe()}}function G(){if(!s)return;const $=s.get_paragraph(e(c))||"";if(e(p)<$.length){const W=$.slice(0,e(p))+$.slice(e(p)+1);s.set_paragraph(e(c),W)}else if(e(c)<s.paragraph_count()-1){const W=s.get_paragraph(e(c)+1)||"";s.set_paragraph(e(c),$+W),s.delete_paragraph(e(c)+1)}oe()}function K(){if(!s)return;const $=s.get_paragraph(e(c))||"",W=$.slice(0,e(p)),le=$.slice(e(p));s.set_paragraph(e(c),W),s.insert_paragraph(e(c)+1,le),Qe(c),f(p,0),oe()}function ge($){if(!s)return;const W=s.get_paragraph(e(c))||"";if($<0){if(e(p)>0)Qe(p,-1);else if(e(c)>0){Qe(c,-1);const le=s.get_paragraph(e(c))||"";f(p,le.length,!0)}}else e(p)<W.length?Qe(p):e(c)<s.paragraph_count()-1&&(Qe(c),f(p,0));fe()}function fn($){if(!s)return;const W=s.para_to_display_pos(e(c),e(p));if(W){try{const le=JSON.parse(W),Ve=le.line+$,ct=s.display_line_count();if(Ve>=0&&Ve<ct){const re=s.display_to_para(Ve,le.col);if(re){const xe=JSON.parse(re);f(c,xe.para,!0),f(p,xe.offset,!0)}}}catch(le){console.error("Failed to move cursor vertically:",le)}fe()}}function Kn($){if(!s||!r)return;const W=r.getBoundingClientRect(),le=$.clientX-W.left,Ve=$.clientY-W.top,ct=B*U,re=Math.floor((Ve-x)/ct),xe=s.display_line_count();if(re>=0&&re<xe){const Tt=s.display_to_para(re,0);if(Tt)try{const Ue=JSON.parse(Tt);f(c,Ue.para,!0);const gn=s.get_paragraph(e(c))||"",He=r.getContext("2d");if(He){He.font=`${B}px ${d}`;let bt=0;for(let ut=0;ut<=gn.length;ut++){const En=He.measureText(gn.slice(0,ut)).width;if(x+En>le){bt=Math.max(0,ut-1);break}bt=ut}f(p,bt,!0)}fe()}catch(Ue){console.error("Failed to parse position:",Ue)}}l?.focus()}var Jn=yc(),Mn=q(Jn),dn=m(q(Mn),2);let jt;var hn=q(dn);{var Ye=$=>{var W=zi();Be(()=>Rt(W,e(h))),we($,W)},br=$=>{var W=wa(),le=ta(W);{var Ve=re=>{var xe=zi();Be(()=>Rt(xe,`Engine Ready - Page 1 of ${e(C)??""}`)),we(re,xe)},ct=re=>{var xe=zi("Loading WASM...");we(re,xe)};pt(le,re=>{e(v)?re(Ve):re(ct,!1)},!0)}we($,W)};pt(hn,$=>{e(h)?$(Ye):$(br,!1)})}var Ct=m(Mn,2);nn(Ct,$=>i=$,()=>i);var vn=m(Ct,2);vn.__keydown=Pe,nn(vn,$=>l=$,()=>l);var qt=m(vn,2),pn=q(qt);pn.__click=Kn,nn(pn,$=>r=$,()=>r),Be(()=>jt=Z(dn,1,"status svelte-1egarnu",null,jt,{ready:e(v),error:!!e(h)})),we(t,Jn),Br()}Vr(["keydown","click"]);var mc=Ee('<ul class="heading-list nested svelte-1nhzsi7"></ul>'),xc=Ee('<li><button class="heading-link svelte-1nhzsi7"> </button> <!></li>'),kc=Ee('<p class="empty-message svelte-1nhzsi7">No headings yet</p>'),Sc=Ee('<ul class="heading-list svelte-1nhzsi7"></ul>'),Cc=Ee('<aside class="sidebar svelte-1nhzsi7"><div class="sidebar-header svelte-1nhzsi7"><h3 class="svelte-1nhzsi7">Document Outline</h3></div> <nav class="sidebar-nav svelte-1nhzsi7"><!></nav></aside>');function Tc(t,n){Dr(n,!0);const r=()=>Ne(No,"$headings",i),[i,l]=us(),s=(x,B=sn)=>{var U=xc(),d=q(U);d.__click=()=>n.onNavigate(B().paraIndex);var w=q(d),L=m(d,2);{var oe=fe=>{var pe=mc();Sn(pe,21,()=>B().children,Bn,(Pe,y)=>{s(Pe,()=>e(y))}),we(fe,pe)};pt(L,fe=>{B().children.length>0&&fe(oe)})}Be(()=>{Z(U,1,`heading-item level-${B().level??""}`,"svelte-1nhzsi7"),Do(d,"title",B().text),Rt(w,B().text||"(Empty heading)")}),we(x,U)};function v(x){const B=[],U=[];for(const d of x){const w={...d,children:[]};for(;U.length>0&&U[U.length-1].level>=d.level;)U.pop();U.length===0?B.push(w):U[U.length-1].children.push(w),U.push(w)}return B}let h=Ie(()=>v(r()));var c=Cc(),p=m(q(c),2),C=q(p);{var D=x=>{var B=kc();we(x,B)},I=x=>{var B=Sc();Sn(B,21,()=>e(h),Bn,(U,d)=>{s(U,()=>e(d))}),we(x,B)};pt(C,x=>{e(h).length===0?x(D):x(I,!1)})}we(t,c),Br(),l()}Vr(["click"]);var Ic=Ee('<div class="app-layout svelte-1n46o8q"><!> <div class="editor-wrapper svelte-1n46o8q"><!></div></div>'),Mc=Ee('<main class="svelte-1n46o8q"><div class="mode-toggle svelte-1n46o8q"><button>JS Engine</button> <button>WASM Engine (Rust)</button></div> <!></main>');function Ec(t){let n,r=V(!1);function i(x){n?.navigateToParagraph(x)}var l=Mc(),s=q(l),v=q(s);v.__click=()=>f(r,!1);let h;var c=m(v,2);c.__click=()=>f(r,!0);let p;var C=m(s,2);{var D=x=>{wc(x,{})},I=x=>{var B=Ic(),U=q(B);Tc(U,{onNavigate:i});var d=m(U,2),w=q(d);nn(lc(w,{}),L=>n=L,()=>n),we(x,B)};pt(C,x=>{e(r)?x(D):x(I,!1)})}Be(()=>{h=Z(v,1,"svelte-1n46o8q",null,h,{active:!e(r)}),p=Z(c,1,"svelte-1n46o8q",null,p,{active:e(r)})}),we(t,l)}Vr(["click"]);ma(Ec,{target:document.getElementById("app")});
